LavaPack.loadBundle([[2557,{},function(){with(this)return function(){"use strict";return function(t,e,r){!function(t){!function(e){var r="URLSearchParams"in t,n="Symbol"in t&&"iterator"in Symbol,i="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),o="FormData"in t,s="ArrayBuffer"in t;if(s)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(t){return t&&a.indexOf(Object.prototype.toString.call(t))>-1};function c(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function h(t){return"string"!=typeof t&&(t=String(t)),t}function f(t){var e={next:function(){var e=t.shift();return{done:e===undefined,value:e}}};return n&&(e[Symbol.iterator]=function(){return e}),e}function l(t){this.map={},t instanceof l?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function d(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function p(t){return new Promise((function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}}))}function m(t){var e=new FileReader,r=p(e);return e.readAsArrayBuffer(t),r}function g(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(t){var e;this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:i&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:o&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:r&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():s&&i&&((e=t)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=g(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(t)||u(t))?this._bodyArrayBuffer=g(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var t=d(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?d(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var t,e,r,n=d(this);if(n)return n;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,r=p(e),e.readAsText(t),r;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),r=new Array(e.length),n=0;n<e.length;n++)r[n]=String.fromCharCode(e[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(b)}),this.json=function(){return this.text().then(JSON.parse)},this}l.prototype.append=function(t,e){t=c(t),e=h(e);var r=this.map[t];this.map[t]=r?r+", "+e:e},l.prototype.delete=function(t){delete this.map[c(t)]},l.prototype.get=function(t){return t=c(t),this.has(t)?this.map[t]:null},l.prototype.has=function(t){return this.map.hasOwnProperty(c(t))},l.prototype.set=function(t,e){this.map[c(t)]=h(e)},l.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},l.prototype.keys=function(){var t=[];return this.forEach((function(e,r){t.push(r)})),f(t)},l.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),f(t)},l.prototype.entries=function(){var t=[];return this.forEach((function(e,r){t.push([r,e])})),f(t)},n&&(l.prototype[Symbol.iterator]=l.prototype.entries);var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function w(t,e){var r,n,i=(e=e||{}).body;if(t instanceof w){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new l(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,i||null==t._bodyInit||(i=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new l(e.headers)),this.method=(r=e.method||this.method||"GET",n=r.toUpperCase(),v.indexOf(n)>-1?n:r),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function b(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var r=t.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(n),decodeURIComponent(i))}})),e}function _(t,e){e||(e={}),this.type="default",this.status=e.status===undefined?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new l(e.headers),this.url=e.url||"",this._initBody(t)}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},y.call(w.prototype),y.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})},_.error=function(){var t=new _(null,{status:0,statusText:""});return t.type="error",t};var E=[301,302,303,307,308];_.redirect=function(t,e){if(-1===E.indexOf(e))throw new RangeError("Invalid status code");return new _(null,{status:e,headers:{location:t}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(t){e.DOMException=function(t,e){this.message=t,this.name=e;var r=Error(t);this.stack=r.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function x(t,r){return new Promise((function(n,o){var s=new w(t,r);if(s.signal&&s.signal.aborted)return o(new e.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function u(){a.abort()}a.onload=function(){var t,e,r={status:a.status,statusText:a.statusText,headers:(t=a.getAllResponseHeaders()||"",e=new l,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var r=t.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();e.append(n,i)}})),e)};r.url="responseURL"in a?a.responseURL:r.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;n(new _(i,r))},a.onerror=function(){o(new TypeError("Network request failed"))},a.ontimeout=function(){o(new TypeError("Network request failed"))},a.onabort=function(){o(new e.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&i&&(a.responseType="blob"),s.headers.forEach((function(t,e){a.setRequestHeader(e,t)})),s.signal&&(s.signal.addEventListener("abort",u),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",u)}),a.send(void 0===s._bodyInit?null:s._bodyInit)}))}x.polyfill=!0,t.fetch||(t.fetch=x,t.Headers=l,t.Request=w,t.Response=_),e.Headers=l,e.Request=w,e.Response=_,e.fetch=x,Object.defineProperty(e,"__esModule",{value:!0})}({})}("undefined"!=typeof self?self:this)}}},{package:"3box>graphql-request>cross-fetch"}],[2558,{},function(){with(this)return function(){"use strict";return function(t,e,r){var n="undefined"!=typeof self?self:this,i=function(){function t(){this.fetch=!1,this.DOMException=n.DOMException}return t.prototype=n,new t}();!function(t){!function(e){var r="URLSearchParams"in t,n="Symbol"in t&&"iterator"in Symbol,i="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),o="FormData"in t,s="ArrayBuffer"in t;if(s)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(t){return t&&a.indexOf(Object.prototype.toString.call(t))>-1};function c(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function h(t){return"string"!=typeof t&&(t=String(t)),t}function f(t){var e={next:function(){var e=t.shift();return{done:e===undefined,value:e}}};return n&&(e[Symbol.iterator]=function(){return e}),e}function l(t){this.map={},t instanceof l?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function d(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function p(t){return new Promise((function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}}))}function m(t){var e=new FileReader,r=p(e);return e.readAsArrayBuffer(t),r}function g(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(t){var e;this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:i&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:o&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:r&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():s&&i&&((e=t)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=g(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(t)||u(t))?this._bodyArrayBuffer=g(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var t=d(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?d(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var t,e,r,n=d(this);if(n)return n;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,r=p(e),e.readAsText(t),r;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),r=new Array(e.length),n=0;n<e.length;n++)r[n]=String.fromCharCode(e[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(b)}),this.json=function(){return this.text().then(JSON.parse)},this}l.prototype.append=function(t,e){t=c(t),e=h(e);var r=this.map[t];this.map[t]=r?r+", "+e:e},l.prototype.delete=function(t){delete this.map[c(t)]},l.prototype.get=function(t){return t=c(t),this.has(t)?this.map[t]:null},l.prototype.has=function(t){return this.map.hasOwnProperty(c(t))},l.prototype.set=function(t,e){this.map[c(t)]=h(e)},l.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},l.prototype.keys=function(){var t=[];return this.forEach((function(e,r){t.push(r)})),f(t)},l.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),f(t)},l.prototype.entries=function(){var t=[];return this.forEach((function(e,r){t.push([r,e])})),f(t)},n&&(l.prototype[Symbol.iterator]=l.prototype.entries);var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function w(t,e){var r,n,i=(e=e||{}).body;if(t instanceof w){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new l(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,i||null==t._bodyInit||(i=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new l(e.headers)),this.method=(r=e.method||this.method||"GET",n=r.toUpperCase(),v.indexOf(n)>-1?n:r),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function b(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var r=t.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(n),decodeURIComponent(i))}})),e}function _(t,e){e||(e={}),this.type="default",this.status=e.status===undefined?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new l(e.headers),this.url=e.url||"",this._initBody(t)}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},y.call(w.prototype),y.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})},_.error=function(){var t=new _(null,{status:0,statusText:""});return t.type="error",t};var E=[301,302,303,307,308];_.redirect=function(t,e){if(-1===E.indexOf(e))throw new RangeError("Invalid status code");return new _(null,{status:e,headers:{location:t}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(t){e.DOMException=function(t,e){this.message=t,this.name=e;var r=Error(t);this.stack=r.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function x(t,r){return new Promise((function(n,o){var s=new w(t,r);if(s.signal&&s.signal.aborted)return o(new e.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function u(){a.abort()}a.onload=function(){var t,e,r={status:a.status,statusText:a.statusText,headers:(t=a.getAllResponseHeaders()||"",e=new l,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var r=t.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();e.append(n,i)}})),e)};r.url="responseURL"in a?a.responseURL:r.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;n(new _(i,r))},a.onerror=function(){o(new TypeError("Network request failed"))},a.ontimeout=function(){o(new TypeError("Network request failed"))},a.onabort=function(){o(new e.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&i&&(a.responseType="blob"),s.headers.forEach((function(t,e){a.setRequestHeader(e,t)})),s.signal&&(s.signal.addEventListener("abort",u),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",u)}),a.send(void 0===s._bodyInit?null:s._bodyInit)}))}x.polyfill=!0,t.fetch||(t.fetch=x,t.Headers=l,t.Request=w,t.Response=_),e.Headers=l,e.Request=w,e.Response=_,e.fetch=x,Object.defineProperty(e,"__esModule",{value:!0})}({})}(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var o=i;(r=o.fetch).default=o.fetch,r.fetch=o.fetch,r.Headers=o.Headers,r.Request=o.Request,r.Response=o.Response,e.exports=r}}},{package:"3box>graphql-request>cross-fetch"}],[2559,{},function(){with(this)return function(){"use strict";return function(t,e,r){var n,i;n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&i.rotl(t,8)|4278255360&i.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=i.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],r=0,n=0;r<t.length;r++,n+=8)e[n>>>5]|=t[r]<<24-n%32;return e},wordsToBytes:function(t){for(var e=[],r=0;r<32*t.length;r+=8)e.push(t[r>>>5]>>>24-r%32&255);return e},bytesToHex:function(t){for(var e=[],r=0;r<t.length;r++)e.push((t[r]>>>4).toString(16)),e.push((15&t[r]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(parseInt(t.substr(r,2),16));return e},bytesToBase64:function(t){for(var e=[],r=0;r<t.length;r+=3)for(var i=t[r]<<16|t[r+1]<<8|t[r+2],o=0;o<4;o++)8*r+6*o<=8*t.length?e.push(n.charAt(i>>>6*(3-o)&63)):e.push("=");return e.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var e=[],r=0,i=0;r<t.length;i=++r%4)0!=i&&e.push((n.indexOf(t.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<2*i|n.indexOf(t.charAt(r))>>>6-2*i);return e}},e.exports=i}}},{package:"analytics-node>md5>crypt"}],[26,{"../../../../shared/constants/permissions":7061,"@metamask/controllers":1294},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.CaveatMutatorFactories=void 0;var n=t("@metamask/controllers");const i={[t("../../../../shared/constants/permissions").CaveatTypes.restrictReturnedAccounts]:{removeAccount:function(t,e){const r=e.filter((e=>e!==t));if(r.length===e.length)return{operation:n.CaveatMutatorOperation.noop};if(r.length>0)return{operation:n.CaveatMutatorOperation.updateValue,value:r};return{operation:n.CaveatMutatorOperation.revokePermission}}}};r.CaveatMutatorFactories=i}}},{package:"$root$"}],[2600,{events:2439},function(){with(this)return function(){"use strict";return function(t,e,r){const n=t("events").EventEmitter;e.exports=function(){const t=new n;let e,r=[];function i(){t.removeAllListeners("err"),t.removeAllListeners("data")}return{append:n=>{if(e)return e;r.push(n),t.emit("data")},prepend:t=>{if(e)return e;r.unshift(t)},error:r=>{e=r,t.emit("err",r)},get:n=>(i(),e?n(e):r.length?n(null,r.shift()):(t.once("err",(t=>{i(),n(t)})),void t.once("data",(()=>(i(),n(null,r.shift())))))),height:()=>r.length}}}}},{package:"3box>ipfs>libp2p-websocket-star-multi>libp2p-websocket-star>socket.io-pull-stream>data-queue"}],[2601,{"./keytransform":2602,"./mount":2603,"./namespace":2604,"./shard":2606,"./sharding":2607,"./tiered":2608},function(){with(this)return function(){"use strict";return function(t,e,r){const n=t("./keytransform"),i=t("./sharding"),o=t("./mount"),s=t("./tiered"),a=t("./namespace"),u=t("./shard");r.KeytransformDatastore=n,r.ShardingDatastore=i,r.MountDatastore=o,r.TieredDatastore=s,r.NamespaceDatastore=a,r.shard=u}}},{package:"3box>ipfs>datastore-core"}],[2602,{"pull-stream":6353},function(){with(this)return function(){"use strict";return function(t,e,r){const n=t("pull-stream");e.exports=class{constructor(t,e){this.child=t,this.transform=e}open(t){this.child.open(t)}put(t,e,r){this.child.put(this.transform.convert(t),e,r)}get(t,e){this.child.get(this.transform.convert(t),e)}has(t,e){this.child.has(this.transform.convert(t),e)}delete(t,e){this.child.delete(this.transform.convert(t),e)}batch(){const t=this.child.batch();return{put:(e,r)=>{t.put(this.transform.convert(e),r)},delete:e=>{t.delete(this.transform.convert(e))},commit:e=>{t.commit(e)}}}query(t){return n(this.child.query(t),n.map((t=>(t.key=this.transform.invert(t.key),t))))}close(t){this.child.close(t)}}}}},{package:"3box>ipfs>datastore-core"}],[2603,{"./keytransform":2602,"async/each":2099,"interface-datastore":5306,"pull-many":6336,"pull-stream":6353},function(){with(this)return function(){"use strict";return function(t,e,r){const n=t("async/each"),i=t("pull-many"),o=t("pull-stream"),s=t("interface-datastore").Key,a=t("interface-datastore").Errors,u=t("interface-datastore").utils,c=u.asyncFilter,h=u.asyncSort,f=u.replaceStartWith,l=t("./keytransform");e.exports=class{constructor(t){this.mounts=t.slice()}open(t){n(this.mounts,((t,e)=>{t.datastore.open(e)}),t)}_lookup(t){for(let e of this.mounts)if(e.prefix.toString()===t.toString()||e.prefix.isAncestorOf(t)){const r=f(t.toString(),e.prefix.toString());return{datastore:e.datastore,mountpoint:e.prefix,rest:new s(r)}}}put(t,e,r){const n=this._lookup(t);if(null==n)return r(a.dbWriteFailedError(new Error("No datastore mounted for this key")));n.datastore.put(n.rest,e,r)}get(t,e){const r=this._lookup(t);if(null==r)return e(a.notFoundError(new Error("No datastore mounted for this key")));r.datastore.get(r.rest,e)}has(t,e){const r=this._lookup(t);null!=r?r.datastore.has(r.rest,e):e(null,!1)}delete(t,e){const r=this._lookup(t);if(null==r)return e(a.dbDeleteFailedError(new Error("No datastore mounted for this key")));r.datastore.delete(r.rest,e)}close(t){n(this.mounts,((t,e)=>{t.datastore.close(e)}),t)}batch(){const t={},e=e=>{const r=this._lookup(e);if(null==r)throw new Error("No datastore mounted for this key");const n=r.mountpoint.toString();return null==t[n]&&(t[n]=r.datastore.batch()),{batch:t[n],rest:r.rest}};return{put:(t,r)=>{const n=e(t);n.batch.put(n.rest,r)},delete:t=>{const r=e(t);r.batch.delete(r.rest)},commit:e=>{n(Object.keys(t),((e,r)=>{t[e].commit(r)}),e)}}}query(t){const e=this.mounts.map((e=>{const r=new l(e.datastore,{convert:t=>{throw new Error("should never be called")},invert:t=>e.prefix.child(t)});let n;return null!=t.prefix&&(n=f(t.prefix,e.prefix.toString())),r.query({prefix:n,filters:t.filters,keysOnly:t.keysOnly})}));let r=[i(e)];if(null!=t.filters&&(r=r.concat(t.filters.map((t=>c(t))))),null!=t.orders&&(r=r.concat(t.orders.map((t=>h(t))))),null!=t.offset){let e=0;r.push(o.filter((()=>e++>=t.offset)))}return null!=t.limit&&r.push(o.take(t.limit)),o.apply(null,r)}}}}},{package:"3box>ipfs>datastore-core"}],[2604,{"./keytransform":2602,"interface-datastore":5306},function(){with(this)return function(){"use strict";return function(t,e,r){const n=t("interface-datastore").Key,i=t("./keytransform");e.exports=class extends i{constructor(t,e){super(t,{convert:t=>e.child(t),invert(t){if("/"===e.toString())return t;if(!e.isAncestorOf(t))throw new Error(`Expected prefix: (${e.toString()}) in key: ${t.toString()}`);return new n(t.toString().slice(e.toString().length),!1)}}),this.prefix=e}query(t){return t.prefix&&"/"!==this.prefix.toString()?super.query(Object.assign({},t,{prefix:this.prefix.child(new n(t.prefix)).toString()})):super.query(t)}}}}},{package:"3box>ipfs>datastore-core"}],[2605,{},function(){with(this)return function(){"use strict";return function(t,e,r){e.exports="This is a repository of IPLD objects. Each IPLD object is in a single file,\nnamed <base32 encoding of cid>.data. Where <base32 encoding of cid> is the\n\"base32\" encoding of the CID (as specified in\nhttps://github.com/multiformats/multibase) without the 'B' prefix.\nAll the object files are placed in a tree of directories, based on a\nfunction of the CID. This is a form of sharding similar to\nthe objects directory in git repositories. Previously, we used\nprefixes, we now use the next-to-last two charters.\n    func NextToLast(base32cid string) {\n      nextToLastLen := 2\n      offset := len(base32cid) - nextToLastLen - 1\n      return str[offset : offset+nextToLastLen]\n    }\nFor example, an object with a base58 CIDv1 of\n    zb2rhYSxw4ZjuzgCnWSt19Q94ERaeFhu9uSqRgjSdx9bsgM6f\nhas a base32 CIDv1 of\n    BAFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA\nand will be placed at\n    SC/AFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA.data\nwith 'SC' being the last-to-next two characters and the 'B' at the\nbeginning of the CIDv1 string is the multibase prefix that is not\nstored in the filename.\n"}}},{package:"3box>ipfs>datastore-core"}],[2606,{"./shard-readme":2605,"interface-datastore":5306},function(){with(this)return function(){"use strict";return function(t,e,r){const n=t("interface-datastore").Key,i=t("./shard-readme"),o=r.PREFIX="/repo/flatfs/shard/",s=r.SHARDING_FN="SHARDING";r.README_FN="_README";class a{constructor(t){this.param=t}fun(t){throw new Error("implement me")}toString(){return`${o}v1/${this.name}/${this.param}`}}class u extends a{constructor(t){super(t),this._padding="".padStart(t,"_"),this.name="prefix"}fun(t){return(t+this._padding).slice(0,this.param)}}class c extends a{constructor(t){super(t),this._padding="".padStart(t,"_"),this.name="suffix"}fun(t){const e=this._padding+t;return e.slice(e.length-this.param)}}class h extends a{constructor(t){super(t),this._padding="".padStart(t+1,"_"),this.name="next-to-last"}fun(t){const e=this._padding+t,r=e.length-this.param-1;return e.slice(r,r+this.param)}}function f(t){if(0===(t=t.trim()).length)throw new Error("empty shard string");if(!t.startsWith(o))throw new Error(`invalid or no path prefix: ${t}`);const e=t.slice(o.length).split("/"),r=e[0];if("v1"!==r)throw new Error(`expect 'v1' version, got '${r}'`);const n=e[1];if(!e[2])throw new Error("missing param");const i=parseInt(e[2],10);switch(n){case"prefix":return new u(i);case"suffix":return new c(i);case"next-to-last":return new h(i);default:throw new Error(`unkown sharding function: ${n}`)}}r.readShardFun=(t,e,r)=>{const i=new n(t).child(new n(s));("function"==typeof e.getRaw?e.getRaw.bind(e):e.get.bind(e))(i,((t,e)=>{if(t)return r(t);let n;try{n=f((e||"").toString().trim())}catch(t){return r(t)}r(null,n)}))},r.readme=i,r.parseShardFun=f,r.Prefix=u,r.Suffix=c,r.NextToLast=h}}},{package:"3box>ipfs>datastore-core"}],[2607,{"./keytransform":2602,"./shard":2606,"async/parallel":2134,"async/waterfall":2145,buffer:2438,"interface-datastore":5306},function(){with(this)return function(){"use strict";return function(t,e,r){(function(r){(function(){const n=t("async/waterfall"),i=t("async/parallel"),o=t("interface-datastore").Key,s=t("./shard"),a=t("./keytransform"),u=new o(s.SHARDING_FN),c=new o(s.README_FN);class h{constructor(t,e){this.child=new a(t,{convert:this._convertKey.bind(this),invert:this._invertKey.bind(this)}),this.shard=e}open(t){this.child.open(t)}_convertKey(t){const e=t.toString();if(e===u.toString()||e===c.toString())return t;return new o(this.shard.fun(e)).child(t)}_invertKey(t){const e=t.toString();return e===u.toString()||e===c.toString()?t:o.withNamespaces(t.list().slice(1))}static createOrOpen(t,e,r){h.create(t,e,(e=>{if(e&&"datastore exists"!==e.message)return r(e);h.open(t,r)}))}static open(t,e){n([e=>s.readShardFun("/",t,e),(e,r)=>{r(null,new h(t,e))}],e)}static create(t,e,n){t.has(u,((o,a)=>{if(o)return n(o);if(!a){const o="function"==typeof t.putRaw?t.putRaw.bind(t):t.put.bind(t);return i([t=>o(u,r.from(e.toString()+"\n"),t),t=>o(c,r.from(s.readme),t)],(t=>n(t)))}s.readShardFun("/",t,((t,r)=>{if(t)return n(t);const i=(r||"").toString(),o=e.toString();if(i!==o)return n(new Error(`specified fun ${o} does not match repo shard fun ${i}`));n(new Error("datastore exists"))}))}))}put(t,e,r){this.child.put(t,e,r)}get(t,e){this.child.get(t,e)}has(t,e){this.child.has(t,e)}delete(t,e){this.child.delete(t,e)}batch(){return this.child.batch()}query(t){const e={keysOnly:t.keysOnly,offset:t.offset,limit:t.limit,filters:[(t,e)=>e(null,t.key.toString()!==u.toString()),(t,e)=>e(null,t.key.toString()!==c.toString())]};if(null!=t.prefix&&e.filters.push(((e,r)=>{r(null,this._invertKey(e.key).toString().startsWith(t.prefix))})),null!=t.filters){const r=t.filters.map((t=>(e,r)=>{t(Object.assign({},e,{key:this._invertKey(e.key)}),r)}));e.filters=e.filters.concat(r)}return null!=t.orders&&(e.orders=t.orders.map((t=>(e,r)=>{e.forEach((t=>{t.key=this._invertKey(t.key)})),t(e,((t,e)=>{if(t)return r(t);e.forEach((t=>{t.key=this._convertKey(t.key)})),r(null,e)}))}))),this.child.query(e)}close(t){this.child.close(t)}}e.exports=h}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"3box>ipfs>datastore-core"}],[2608,{"async/each":2099,"async/whilst":2146,"interface-datastore":5306},function(){with(this)return function(){"use strict";return function(t,e,r){const n=t("async/each"),i=t("async/whilst"),o=t("interface-datastore").Errors;e.exports=class{constructor(t){this.stores=t.slice()}open(t){n(this.stores,((t,e)=>{t.open(e)}),(e=>{if(e)return t(o.dbOpenFailedError());t()}))}put(t,e,r){n(this.stores,((r,n)=>{r.put(t,e,n)}),(t=>{if(t)return r(o.dbWriteFailedError());r()}))}get(t,e){const r=this.stores.length;let n=!1,s=0;i((()=>!n&&s<r),(e=>{this.stores[s++].get(t,((t,r)=>{if(null==t)return n=!0,e(null,r);e()}))}),((t,r)=>{if(t||!r)return e(o.notFoundError());e(null,r)}))}has(t,e){const r=this.stores.length;let n=!1,o=0;i((()=>!n&&o<r),(e=>{this.stores[o++].has(t,((t,r)=>{if(null==t)return n=!0,e(null,r);e()}))}),e)}delete(t,e){n(this.stores,((e,r)=>{e.delete(t,r)}),(t=>{if(t)return e(o.dbDeleteFailedError());e()}))}close(t){n(this.stores,((t,e)=>{t.close(e)}),t)}batch(){const t=this.stores.map((t=>t.batch()));return{put:(e,r)=>{t.forEach((t=>t.put(e,r)))},delete:e=>{t.forEach((t=>t.delete(e)))},commit:e=>{n(t,((t,e)=>{t.commit(e)}),e)}}}query(t){return this.stores[this.stores.length-1].query(t)}}}}},{package:"3box>ipfs>datastore-core"}],[2609,{_process:6295},function(){with(this)return function(){"use strict";return function(t,e,r){(function(t){(function(){function r(t){this._db=t,this._operations=[],this._written=!1}r.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")},r.prototype.put=function(t,e){this._checkWritten();var r=this._db._checkKey(t,"key",this._db._isBuffer);if(r)throw r;return this._db._isBuffer(t)||(t=String(t)),this._db._isBuffer(e)||(e=String(e)),"function"==typeof this._put?this._put(t,e):this._operations.push({type:"put",key:t,value:e}),this},r.prototype.del=function(t){this._checkWritten();var e=this._db._checkKey(t,"key",this._db._isBuffer);if(e)throw e;return this._db._isBuffer(t)||(t=String(t)),"function"==typeof this._del?this._del(t):this._operations.push({type:"del",key:t}),this},r.prototype.clear=function(){return this._checkWritten(),this._operations=[],"function"==typeof this._clear&&this._clear(),this},r.prototype.write=function(e,r){if(this._checkWritten(),"function"==typeof e&&(r=e),"function"!=typeof r)throw new Error("write() requires a callback argument");return"object"!=typeof e&&(e={}),this._written=!0,"function"==typeof this._write?this._write(r):"function"==typeof this._db._batch?this._db._batch(this._operations,e,r):void t.nextTick(r)},e.exports=r}).call(this)}).call(this,t("_process"))}}},{package:"3box>ipfs>ipfs-repo>datastore-level>level-js>abstract-leveldown"}],[2610,{_process:6295},function(){with(this)return function(){"use strict";return function(t,e,r){(function(t){(function(){function r(t){this.db=t,this._ended=!1,this._nexting=!1}r.prototype.next=function(e){var r=this;if("function"!=typeof e)throw new Error("next() requires a callback argument");return r._ended?e(new Error("cannot call next() after end()")):r._nexting?e(new Error("cannot call next() before previous next() has completed")):(r._nexting=!0,"function"==typeof r._next?r._next((function(){r._nexting=!1,e.apply(null,arguments)})):void t.nextTick((function(){r._nexting=!1,e()})))},r.prototype.end=function(e){if("function"!=typeof e)throw new Error("end() requires a callback argument");return this._ended?e(new Error("end() already called on iterator")):(this._ended=!0,"function"==typeof this._end?this._end(e):void t.nextTick(e))},e.exports=r}).call(this)}).call(this,t("_process"))}}},{package:"3box>ipfs>ipfs-repo>datastore-level>level-js>abstract-leveldown"}],[2611,{"../../../is-buffer/index.js":5584,"./abstract-chained-batch":2609,"./abstract-iterator":2610,_process:6295,xtend:7041},function(){with(this)return function(){"use strict";return function(t,e,r){(function(r,n){(function(){var i=t("xtend"),o=t("./abstract-iterator"),s=t("./abstract-chained-batch");function a(t){if(!arguments.length||t===undefined)throw new Error("constructor requires at least a location argument");if("string"!=typeof t)throw new Error("constructor requires a location string argument");this.location=t,this.status="new"}a.prototype.open=function(t,e){var r=this,i=this.status;if("function"==typeof t&&(e=t),"function"!=typeof e)throw new Error("open() requires a callback argument");"object"!=typeof t&&(t={}),t.createIfMissing=0!=t.createIfMissing,t.errorIfExists=!!t.errorIfExists,"function"==typeof this._open?(this.status="opening",this._open(t,(function(t){if(t)return r.status=i,e(t);r.status="open",e()}))):(this.status="open",n.nextTick(e))},a.prototype.close=function(t){var e=this,r=this.status;if("function"!=typeof t)throw new Error("close() requires a callback argument");"function"==typeof this._close?(this.status="closing",this._close((function(n){if(n)return e.status=r,t(n);e.status="closed",t()}))):(this.status="closed",n.nextTick(t))},a.prototype.get=function(t,e,r){var i;if("function"==typeof e&&(r=e),"function"!=typeof r)throw new Error("get() requires a callback argument");return(i=this._checkKey(t,"key",this._isBuffer))?r(i):(this._isBuffer(t)||(t=String(t)),"object"!=typeof e&&(e={}),e.asBuffer=0!=e.asBuffer,"function"==typeof this._get?this._get(t,e,r):void n.nextTick((function(){r(new Error("NotFound"))})))},a.prototype.put=function(t,e,r,i){var o;if("function"==typeof r&&(i=r),"function"!=typeof i)throw new Error("put() requires a callback argument");return(o=this._checkKey(t,"key",this._isBuffer))?i(o):(this._isBuffer(t)||(t=String(t)),null==e||this._isBuffer(e)||n.browser||(e=String(e)),"object"!=typeof r&&(r={}),"function"==typeof this._put?this._put(t,e,r,i):void n.nextTick(i))},a.prototype.del=function(t,e,r){var i;if("function"==typeof e&&(r=e),"function"!=typeof r)throw new Error("del() requires a callback argument");return(i=this._checkKey(t,"key",this._isBuffer))?r(i):(this._isBuffer(t)||(t=String(t)),"object"!=typeof e&&(e={}),"function"==typeof this._del?this._del(t,e,r):void n.nextTick(r))},a.prototype.batch=function(t,e,r){if(!arguments.length)return this._chainedBatch();if("function"==typeof e&&(r=e),"function"==typeof t&&(r=t),"function"!=typeof r)throw new Error("batch(array) requires a callback argument");if(!Array.isArray(t))return r(new Error("batch(array) requires an array argument"));e&&"object"==typeof e||(e={});for(var i,o,s=0,a=t.length;s<a;s++)if("object"==typeof(i=t[s])){if(o=this._checkKey(i.type,"type",this._isBuffer))return r(o);if(o=this._checkKey(i.key,"key",this._isBuffer))return r(o)}if("function"==typeof this._batch)return this._batch(t,e,r);n.nextTick(r)},a.prototype.approximateSize=function(t,e,r){if(null==t||null==e||"function"==typeof t||"function"==typeof e)throw new Error("approximateSize() requires valid `start`, `end` and `callback` arguments");if("function"!=typeof r)throw new Error("approximateSize() requires a callback argument");if(this._isBuffer(t)||(t=String(t)),this._isBuffer(e)||(e=String(e)),"function"==typeof this._approximateSize)return this._approximateSize(t,e,r);n.nextTick((function(){r(null,0)}))},a.prototype._setupIteratorOptions=function(t){var e=this;return t=i(t),["start","end","gt","gte","lt","lte"].forEach((function(r){t[r]&&e._isBuffer(t[r])&&0===t[r].length&&delete t[r]})),t.reverse=!!t.reverse,t.keys=0!=t.keys,t.values=0!=t.values,t.limit="limit"in t?t.limit:-1,t.keyAsBuffer=0!=t.keyAsBuffer,t.valueAsBuffer=0!=t.valueAsBuffer,t},a.prototype.iterator=function(t){return"object"!=typeof t&&(t={}),t=this._setupIteratorOptions(t),"function"==typeof this._iterator?this._iterator(t):new o(this)},a.prototype._chainedBatch=function(){return new s(this)},a.prototype._isBuffer=function(t){return r.isBuffer(t)},a.prototype._checkKey=function(t,e){if(null===t||t===undefined)return new Error(e+" cannot be `null` or `undefined`");if(this._isBuffer(t)){if(0===t.length)return new Error(e+" cannot be an empty Buffer")}else if(""===String(t))return new Error(e+" cannot be an empty String")},e.exports=a}).call(this)}).call(this,{isBuffer:t("../../../is-buffer/index.js")},t("_process"))}}},{package:"3box>ipfs>ipfs-repo>datastore-level>level-js>abstract-leveldown"}],[2612,{"./abstract-chained-batch":2609,"./abstract-iterator":2610,"./abstract-leveldown":2611,"./is-leveldown":2613},function(){with(this)return function(){"use strict";return function(t,e,r){r.AbstractLevelDOWN=t("./abstract-leveldown"),r.AbstractIterator=t("./abstract-iterator"),r.AbstractChainedBatch=t("./abstract-chained-batch"),r.isLevelDOWN=t("./is-leveldown")}}},{package:"3box>ipfs>ipfs-repo>datastore-level>level-js>abstract-leveldown"}],[2613,{"./abstract-leveldown":2611},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("./abstract-leveldown");e.exports=function(t){return!(!t||"object"!=typeof t)&&Object.keys(n.prototype).filter((function(t){return"_"!=t[0]&&"approximateSize"!=t})).every((function(e){return"function"==typeof t[e]}))}}}},{package:"3box>ipfs>ipfs-repo>datastore-level>level-js>abstract-leveldown"}],[2614,{"./iterator":2615,_process:6295,"abstract-leveldown":2612,buffer:2438,util:2444,xtend:7041},function(){with(this)return function(){"use strict";return function(t,e,r){(function(r,n){(function(){e.exports=u;var i=t("abstract-leveldown").AbstractLevelDOWN,o=t("util"),s=t("./iterator"),a=t("xtend");function u(t){if(!(this instanceof u))return new u(t);i.call(this,t)}o.inherits(u,i),u.prototype._open=function(t,e){var r=this;if(this._idbOpts=a({storeName:this.location,keyEncoding:"none",valueEncoding:"none"},t),this._idbOpts.idb)i(this._idbOpts.idb);else{var n=indexedDB.open(this.location);n.onerror=function(t){e(t.target.error)},n.onsuccess=function(){i(n.result)}}function i(n){r._db=n;var i=r._db.objectStoreNames.contains(r._idbOpts.storeName);if(t.errorIfExists&&i)return r._db.close(),void e(new Error("store already exists"));if(!t.createIfMissing&&!i)return r._db.close(),void e(new Error("store does not exist"));if(t.createIfMissing&&!i){r._db.close();var o=indexedDB.open(r.location,r._db.version+1);return o.onerror=function(t){e(t.target.error)},o.onupgradeneeded=function(){o.result.createObjectStore(r._idbOpts.storeName,r._idbOpts)},void(o.onsuccess=function(){r._db=o.result,e(null,r)})}e(null,r)}},u.prototype._get=function(t,e,r){e=a(this._idbOpts,e);var i=t;"binary"!==e.keyEncoding||Array.isArray(t)||(t=Array.prototype.slice.call(t));var o=this._db.transaction(this._idbOpts.storeName),s=o.objectStore(this._idbOpts.storeName).openCursor(IDBKeyRange.only(t));o.onabort=function(){r(o.error)},s.onsuccess=function(){var t=s.result;if(t){var o=t.value;if(o instanceof Uint8Array&&(o=new n(o)),"binary"!==e.valueEncoding||n.isBuffer(o)||(o=new n(o)),e.asBuffer&&!n.isBuffer(o))if(null==o)o=new n(0);else if("string"==typeof o)o=new n(o);else if("boolean"==typeof o)o=new n(String(o));else if("number"==typeof o)o=new n(String(o));else if(Array.isArray(o))o=new n(String(o));else{if(!(o instanceof Uint8Array))return void r(new TypeError("can't coerce `"+o.constructor.name+"` into a Buffer"));o=new n(o)}r(null,o,i)}else r(new Error("NotFound"))}},u.prototype._del=function(t,e,r){"binary"!==(e=a(this._idbOpts,e)).keyEncoding||Array.isArray(t)||(t=Array.prototype.slice.call(t));var n="readwrite";!0===e.sync&&(n="readwriteflush");var i=this._db.transaction(this._idbOpts.storeName,n);i.objectStore(this._idbOpts.storeName).delete(t);i.onabort=function(){r(i.error)},i.oncomplete=function(){r()}},u.prototype._put=function(t,e,r,n){"binary"!==(r=a(this._idbOpts,r)).keyEncoding||Array.isArray(t)||(t=Array.prototype.slice.call(t));var i="readwrite";!0===r.sync&&(i="readwriteflush");var o=this._db.transaction(this._idbOpts.storeName,i);o.objectStore(this._idbOpts.storeName).put(e,t);o.onabort=function(){n(o.error)},o.oncomplete=function(){n()}},u.prototype._iterator=function(t){return new s(this,t)},u.prototype._batch=function(t,e,n){if(0===t.length)return r.nextTick(n);var i="readwrite";!0===e.sync&&(i="readwriteflush");var o=this._db.transaction(this._idbOpts.storeName,i),s=o.objectStore(this._idbOpts.storeName);o.onabort=function(){n(o.error)},o.oncomplete=function(){n()},t.forEach((function(t){"binary"!==a(e,t).keyEncoding||Array.isArray(t.key)||(t.key=Array.prototype.slice.call(t.key)),"del"===t.type?s.delete(t.key):s.put(t.value,t.key)}))},u.prototype._close=function(t){this._db.close(),r.nextTick(t)},u.prototype._approximateSize=function(t,e,n){var i=new Error("Not implemented");if(!n)throw i;r.nextTick((function(){n(i)}))},u.destroy=function(t,e){var r;if(null!=t&&"object"==typeof t)r=a({location:t.location,storeName:t.location},t._idbOpts);else{if("string"!=typeof t)throw new TypeError("location must be a string or an object");r={location:t,storeName:t}}if("string"!=typeof r.location)throw new TypeError("location must be a string");if("string"!=typeof r.storeName)throw new TypeError("db.storeName must be a string");var n=indexedDB.open(r.location);n.onerror=function(t){e(t.target.error)},n.onsuccess=function(){var t=n.result;function i(t){var r=indexedDB.deleteDatabase(t);r.onerror=function(t){e(t.target.error)},r.onsuccess=function(){e()}}if(t.close(),0!==t.objectStoreNames.length)if(t.objectStoreNames.contains(r.storeName)){var o=indexedDB.open(r.location,t.version+1);o.onerror=function(t){e(t.target.error)},o.onupgradeneeded=function(){(t=o.result).deleteObjectStore(r.storeName)},o.onsuccess=function(){(t=o.result).close(),0===t.objectStoreNames.length?i(r.location):e()}}else e();else i(r.location)}}}).call(this)}).call(this,t("_process"),t("buffer").Buffer)}}},{package:"3box>ipfs>ipfs-repo>datastore-level>level-js"}],[2615,{_process:6295,"abstract-leveldown":2612,buffer:2438,"idb-readable-stream":5285,ltgt:6065,stream:2441,util:2444,xtend:7041},function(){with(this)return function(){"use strict";return function(t,e,r){(function(r,n){(function(){var i=t("util"),o=t("abstract-leveldown").AbstractIterator,s=t("ltgt"),a=t("idb-readable-stream"),u=t("stream"),c=t("xtend"),h=u.Writable;function f(t,e){if(this._db=t._db,this._idbOpts=t._idbOpts,o.call(this,t),this._options=c({snapshot:!0},this._idbOpts,e),this._limit=this._options.limit,null!=this._limit&&-1!==this._limit||(this._limit=Infinity),"number"!=typeof this._limit)throw new TypeError("options.limit must be a number");0!==this._limit&&(this._count=0,this._startCursor(this._options))}e.exports=f,i.inherits(f,o),f.prototype._startCursor=function(t){t=c(this._options,t);var e=this,r=null,n=s.lowerBound(t),i=s.upperBound(t),o=s.lowerBoundExclusive(t),u=s.upperBoundExclusive(t),f=t.reverse?"prev":"next";if(n&&("binary"!==t.keyEncoding||Array.isArray(n)||(n=Array.prototype.slice.call(n))),i&&("binary"!==t.keyEncoding||Array.isArray(i)||(i=Array.prototype.slice.call(i))),n&&i)try{r=IDBKeyRange.bound(n,i,o,u)}catch(t){return void(this._keyRangeError=!0)}else n?r=IDBKeyRange.lowerBound(n,o):i&&(r=IDBKeyRange.upperBound(i,u));this._reader=a(this._db,this._idbOpts.storeName,c(t,{range:r,direction:f})),this._reader.on("error",(function(t){var r=e._callback;e._callback=!1,r?r(t):e._readNext=function(e){e(t)}})),this._reader.pipe(new h({objectMode:!0,write:function(t,r,n){if(e._count++>=e._limit)return e._reader.pause(),e._reader.unpipe(this),n(),void this.end();var i=e._callback;e._callback=!1,i?e._processItem(t,(function(t,e,r){n(t),i(t,e,r)})):e._readNext=function(r){e._processItem(t,(function(t,e,i){n(t),r(t,e,i)}))}}})).on("finish",(function(){var t=e._callback;e._callback=!1,t?t():e._readNext=function(t){t()}}))},f.prototype._processItem=function(t,e){if("function"!=typeof e)throw new TypeError("cb must be a function");var r=t.key,i=t.value;if(i instanceof Uint8Array&&(i=new n(i)),"binary"===this._options.keyEncoding&&Array.isArray(r)&&(r=new n(r)),"binary"!==this._options.valueEncoding||n.isBuffer(i)||(i=new n(i)),this._options.keyAsBuffer&&!n.isBuffer(r))if(null==r)r=new n(0);else if("string"==typeof r)r=new n(r);else if("boolean"==typeof r)r=new n(String(r));else if("number"==typeof r)r=new n(String(r));else if(Array.isArray(r))r=new n(String(r));else{if(!(r instanceof Uint8Array))throw new TypeError("can't coerce `"+r.constructor.name+"` into a Buffer");r=new n(r)}if(this._options.valueAsBuffer&&!n.isBuffer(i))if(null==i)i=new n(0);else if("string"==typeof i)i=new n(i);else if("boolean"==typeof i)i=new n(String(i));else if("number"==typeof i)i=new n(String(i));else if(Array.isArray(i))i=new n(String(i));else{if(!(i instanceof Uint8Array))throw new TypeError("can't coerce `"+i.constructor.name+"` into a Buffer");i=new n(i)}e(null,r,i)},f.prototype._next=function(t){if(this._callback)throw new Error("callback already exists");if(this._keyRangeError||0===this._limit)t();else{var e=this._readNext;this._readNext=!1,e?r.nextTick((function(){e(t)})):this._callback=t}}}).call(this)}).call(this,t("_process"),t("buffer").Buffer)}}},{package:"3box>ipfs>ipfs-repo>datastore-level>level-js"}],[2616,{buffer:2438,"encoding-down":2701,"interface-datastore":5306,leveldown:2614,levelup:5687,"pull-stream":6353},function(){with(this)return function(){"use strict";return function(t,e,r){(function(r){(function(){const n=t("pull-stream"),i=t("levelup"),o=t("interface-datastore").utils.asyncFilter,s=t("interface-datastore").utils.asyncSort,a=t("interface-datastore").Key,u=t("interface-datastore").Errors,c=t("encoding-down");e.exports=class{constructor(e,r){let n;r&&r.db?(n=r.db,delete r.db):n=t("leveldown"),this.db=i(c(n(e),{valueEncoding:"binary"}),Object.assign({},r,{compression:!1}),(t=>{if(t)throw t}))}open(t){this.db.open((e=>{if(e)return t(u.dbOpenFailedError(e));t()}))}put(t,e,r){this.db.put(t.toString(),e,(t=>{if(t)return r(u.dbWriteFailedError(t));r()}))}get(t,e){this.db.get(t.toString(),((t,r)=>{if(t)return e(u.notFoundError(t));e(null,r)}))}has(t,e){this.db.get(t.toString(),((t,r)=>{if(t)return t.notFound?void e(null,!1):void e(t);e(null,!0)}))}delete(t,e){this.db.del(t.toString(),(t=>{if(t)return e(u.dbDeleteFailedError(t));e()}))}close(t){this.db.close(t)}batch(){const t=[];return{put:(e,r)=>{t.push({type:"put",key:e.toString(),value:r})},delete:e=>{t.push({type:"del",key:e.toString()})},commit:e=>{this.db.batch(t,e)}}}query(t){let e=!0;null!=t.keysOnly&&(e=!t.keysOnly);const i=this.db.db.iterator({keys:!0,values:e,keyAsBuffer:!0});let u=[(t,n)=>{if(t)return i.end((e=>{n(e||t)}));i.next(((t,o,s)=>{if(t)return n(t);if(null==t&&null==o&&null==s)return i.end((t=>{n(t||!0)}));const u={key:new a(o,!1)};e&&(u.value=r.from(s)),n(null,u)}))}],c=[];if(null!=t.prefix){const e=t.prefix;c.push(((t,r)=>r(null,t.key.toString().startsWith(e))))}if(null!=t.filters&&(c=c.concat(t.filters)),u=u.concat(c.map((t=>o(t)))),null!=t.orders&&(u=u.concat(t.orders.map((t=>s(t))))),null!=t.offset){let e=0;u.push(n.filter((()=>e++>=t.offset)))}return null!=t.limit&&u.push(n.take(t.limit)),n.apply(null,u)}}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"3box>ipfs>ipfs-repo>datastore-level"}],[2617,{"./utils":2618,assert:2066,buffer:2438,debug:2622,"err-code":2725,"interface-datastore":5306},function(){with(this)return function(){"use strict";return function(t,e,r){(function(r){(function(){const{Key:n}=t("interface-datastore"),{encodeBase32:i,keyToTopic:o,topicToKey:s}=t("./utils"),a=t("err-code"),u=t("assert"),c=t("debug"),h=c("datastore-pubsub:publisher");h.error=c("datastore-pubsub:publisher:error");e.exports=class{constructor(t,e,r,n,i){u.strictEqual(typeof n,"object","missing validator"),u.strictEqual(typeof n.validate,"function","missing validate function"),u.strictEqual(typeof n.select,"function","missing select function"),i&&u.strictEqual(typeof i,"function","invalid subscriptionKeyFn received"),this._pubsub=t,this._datastore=e,this._peerId=r,this._validator=n,this._handleSubscriptionKeyFn=i,this._onMessage=this._onMessage.bind(this)}put(t,e,n){if(!r.isBuffer(t)){const t="datastore key does not have a valid format";return h.error(t),n(a(new Error(t),"ERR_INVALID_DATASTORE_KEY"))}if(!r.isBuffer(e)){const t="received value is not a buffer";return h.error(t),n(a(new Error(t),"ERR_INVALID_VALUE_RECEIVED"))}const i=o(t);h(`publish value for topic ${i}`),this._pubsub.publish(i,e,n)}get(t,e){if(!r.isBuffer(t)){const t="datastore key does not have a valid format";return h.error(t),e(a(new Error(t),"ERR_INVALID_DATASTORE_KEY"))}const n=o(t);this._pubsub.ls(((r,i)=>r?e(r):i&&Array.isArray(i)&&i.indexOf(n)>-1?this._getLocal(t,e):void this._pubsub.subscribe(n,this._onMessage,(r=>{if(r){const t=`cannot subscribe topic ${n}`;return h.error(t),e(a(new Error(t),"ERR_SUBSCRIBING_TOPIC"))}h(`subscribed values for key ${n}`),this._getLocal(t,e)}))))}unsubscribe(t){const e=o(t);this._pubsub.unsubscribe(e,this._onMessage)}_getLocal(t,e){const o=new n("/"+i(t),!1);this._datastore.get(o,((t,n)=>{if(t){if("ERR_NOT_FOUND"!==t.code){const t=`unexpected error getting the ipns record for ${o.toString()}`;return h.error(t),e(a(new Error(t),"ERR_UNEXPECTED_ERROR_GETTING_RECORD"))}const r=`local record requested was not found for ${o.toString()}`;return h.error(r),e(a(new Error(r),"ERR_NOT_FOUND"))}if(!r.isBuffer(n)){const t="found record that we couldn't convert to a value";return h.error(t),e(a(new Error(t),"ERR_INVALID_RECORD_RECEIVED"))}e(null,n)}))}_onMessage(t){const{data:e,from:r,topicIDs:n}=t;let i;try{i=s(n[0])}catch(t){return void h.error(t)}h(`message received for ${i} topic`),r!==this._peerId.toB58String()?this._handleSubscriptionKeyFn?this._handleSubscriptionKeyFn(i,((t,r)=>{t?h.error("message discarded by the subscriptionKeyFn"):this._storeIfSubscriptionIsBetter(r,e)})):this._storeIfSubscriptionIsBetter(i,e):h("message discarded as it is from the same peer")}_storeIfSubscriptionIsBetter(t,e){this._isBetter(t,e,((n,i)=>{!n&&i&&this._storeRecord(r.from(t),e)}))}_validateRecord(t,e,r){this._validator.validate(t,e,r)}_selectRecord(t,e,r){this._validator.select(t,e,((t,e)=>{if(t)return h.error(t),r(t);r(null,0===e)}))}_isBetter(t,e,r){this._validateRecord(e,t,((i,o)=>{if(i||!o){const t="record received through pubsub is not valid";return h.error(t),r(a(new Error(t),"ERR_NOT_VALID_RECORD"))}const s=new n(t);this._getLocal(s.toBuffer(),((t,n)=>t?r(null,!0):n.equals(e)?r(null,!1):void this._selectRecord(e,n,r)))}))}_storeRecord(t,e){const r=new n("/"+i(t),!1);this._datastore.put(r,e,(e=>{e?h.error(`record for ${t.toString()} could not be stored in the routing`):h(`record for ${t.toString()} was stored in the datastore`)}))}open(t){const e="open function was not implemented yet";return h.error(e),t(a(new Error(e),"ERR_NOT_IMPLEMENTED_YET"))}has(t,e){const r="has function was not implemented yet";return h.error(r),e(a(new Error(r),"ERR_NOT_IMPLEMENTED_YET"))}delete(t,e){const r="delete function was not implemented yet";return h.error(r),e(a(new Error(r),"ERR_NOT_IMPLEMENTED_YET"))}close(t){const e="close function was not implemented yet";return h.error(e),t(a(new Error(e),"ERR_NOT_IMPLEMENTED_YET"))}batch(){const t="batch function was not implemented yet";throw h.error(t),a(new Error(t),"ERR_NOT_IMPLEMENTED_YET")}query(){const t="query function was not implemented yet";throw h.error(t),a(new Error(t),"ERR_NOT_IMPLEMENTED_YET")}}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"3box>ipfs>datastore-pubsub"}],[2618,{"err-code":2725,multibase:6093},function(){with(this)return function(){"use strict";return function(t,e,r){const n=t("multibase"),i=t("err-code"),o="/record/";e.exports.encodeBase32=t=>n.encode("base32",t).slice(1),e.exports.keyToTopic=t=>`/record/${n.encode("base64url",t).slice(1).toString()}`,e.exports.topicToKey=t=>{if(t.substring(0,o.length)!==o)throw i(new Error("topic received is not from a record"),"ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");const e=`u${t.substring(o.length)}`;return n.decode(e).toString()}}}},{package:"3box>ipfs>datastore-pubsub"}],[2619,{debounce:2620,duplexer:2683,through:6812},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("through"),i=t("duplexer"),o=t("debounce");e.exports=function(t,e){var r=n(o((function(t){s.queue(t)}),t||100,e)),s=n();return i(r,s)}}}},{package:"debounce-stream"}],[2620,{},function(){with(this)return function(){"use strict";return function(t,e,r){e.exports=function(t,e,r){var n,i,o,s,a;function u(){var c=Date.now()-s;c<e&&c>=0?n=setTimeout(u,e-c):(n=null,r||(a=t.apply(o,i),o=i=null))}null==e&&(e=100);var c=function(){o=this,i=arguments,s=Date.now();var c=r&&!n;return n||(n=setTimeout(u,e)),c&&(a=t.apply(o,i),o=i=null),a};return c.clear=function(){n&&(clearTimeout(n),n=null)},c.flush=function(){n&&(a=t.apply(o,i),o=i=null,clearTimeout(n),n=null)},c}}}},{package:"debounce-stream>debounce"}],[2625,{buffer:2438},function(){with(this)return function(){"use strict";return function(t,e,r){(function(t){(function(){function r(e){return e instanceof t||e instanceof Date||e instanceof RegExp}function n(e){if(e instanceof t){var r=t.alloc?t.alloc(e.length):new t(e.length);return e.copy(r),r}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e);throw new Error("Unexpected situation")}function i(t){var e=[];return t.forEach((function(t,o){"object"==typeof t&&null!==t?Array.isArray(t)?e[o]=i(t):r(t)?e[o]=n(t):e[o]=s({},t):e[o]=t})),e}function o(t,e){return"__proto__"===e?undefined:t[e]}var s=e.exports=function(){if(arguments.length<1||"object"!=typeof arguments[0])return!1;if(arguments.length<2)return arguments[0];var t,e,a=arguments[0],u=Array.prototype.slice.call(arguments,1);return u.forEach((function(u){"object"!=typeof u||null===u||Array.isArray(u)||Object.keys(u).forEach((function(c){return e=o(a,c),(t=o(u,c))===a?void 0:"object"!=typeof t||null===t?void(a[c]=t):Array.isArray(t)?void(a[c]=i(t)):r(t)?void(a[c]=n(t)):"object"!=typeof e||null===e||Array.isArray(e)?void(a[c]=s({},t)):void(a[c]=s(e,t))}))})),a}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"madge>rc>deep-extend"}],[2627,{"abstract-leveldown":2015,inherits:5299},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("abstract-leveldown").AbstractIterator;function i(t){n.call(this,t),this._options=t,this._iterator=null,this._operations=[]}t("inherits")(i,n),i.prototype.setDb=function(t){var e=this._iterator=t.iterator(this._options);this._operations.forEach((function(t){e[t.method].apply(e,t.args)}))},i.prototype._operation=function(t,e){if(this._iterator)return this._iterator[t].apply(this._iterator,e);this._operations.push({method:t,args:e})},"next end".split(" ").forEach((function(t){i.prototype["_"+t]=function(){this._operation(t,arguments)}})),i.prototype.seek=function(){this._operation("seek",arguments)},e.exports=i}}},{package:"3box>orbit-db>orbit-db-keystore>levelup>deferred-leveldown"}],[2628,{"./deferred-iterator":2627,"abstract-leveldown":2015,inherits:5299},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("abstract-leveldown").AbstractLevelDOWN,i=t("inherits"),o=t("./deferred-iterator"),s="put get del batch".split(" ");function a(t){n.call(this,""),this._db=t,this._operations=[],this._iterators=[],u(this)}function u(t){s.forEach((function(e){t["_"+e]=function(){this._operations.push({method:e,args:arguments})}})),"function"==typeof t._db.approximateSize&&(t.approximateSize=function(){this._operations.push({method:"approximateSize",args:arguments})}),t._iterator=function(t){var e=new o(t);return this._iterators.push(e),e}}i(a,n),a.prototype._open=function(t,e){var r=this;this._db.open(t,(function(t){if(t)return e(t);r._operations.forEach((function(t){r._db[t.method].apply(r._db,t.args)})),r._operations=[],r._iterators.forEach((function(t){t.setDb(r._db)})),r._iterators=[],function(t){s.concat("iterator").forEach((function(e){t["_"+e]=function(){return this._db[e].apply(this._db,arguments)}})),t._db.approximateSize&&(t.approximateSize=function(){return this._db.approximateSize.apply(this._db,arguments)})}(r),e()}))},a.prototype._close=function(t){var e=this;this._db.close((function(r){if(r)return t(r);u(e),t()}))},a.prototype._serializeKey=function(t){return t},a.prototype._serializeValue=function(t){return t},e.exports=a,e.exports.DeferredIterator=o}}},{package:"3box>orbit-db>orbit-db-keystore>levelup>deferred-leveldown"}],[2636,{buffer:2438,"js-sha256":5615,"js-sha3":5616},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.sha256=function(t){return o.Buffer.from(n.sha256.arrayBuffer(t))},r.keccak=s,r.toEthereumAddress=function(t){return"0x".concat(s(o.Buffer.from(t.slice(2),"hex")).slice(-20).toString("hex"))};var n=t("js-sha256"),i=t("js-sha3"),o=t("buffer");function s(t){return o.Buffer.from(i.keccak_256.buffer(t))}}}},{package:"3box>3id-resolver>did-jwt"}],[2637,{"./SignerAlgorithm":2639,"./VerifierAlgorithm":2641,"@babel/runtime/helpers/asyncToGenerator":303,"@babel/runtime/helpers/interopRequireDefault":313,"@babel/runtime/helpers/objectSpread":320,"@babel/runtime/regenerator":334,base64url:2323,"did-resolver":2643},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.normalizeDID=v,r.decodeJWT=w,r.createJWT=b,r.verifyJWT=E,r.resolveAuthenticator=T,r.default=r.IAT_SKEW=void 0;var i=n(t("@babel/runtime/regenerator")),o=n(t("@babel/runtime/helpers/objectSpread")),s=n(t("@babel/runtime/helpers/asyncToGenerator")),a=n(t("./VerifierAlgorithm")),u=n(t("./SignerAlgorithm")),c=n(t("base64url")),h=n(t("did-resolver")),f={ES256K:["Secp256k1VerificationKey2018","Secp256k1SignatureVerificationKey2018","EcdsaPublicKeySecp256k1"],"ES256K-R":["Secp256k1VerificationKey2018","Secp256k1SignatureVerificationKey2018","EcdsaPublicKeySecp256k1"],Ed25519:["ED25519SignatureVerification"]},l={typ:"JWT"},d="ES256K";function p(t){return c.default.encode(JSON.stringify(t))}var m=300;function g(t){return t.match(/^[123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz]+$/)}function y(t){return t&&(t.match(/^did:/)||g(t))}function v(t){if(t.match(/^did:/))return t;if(g(t))return"did:uport:".concat(t);throw new Error("Not a valid DID '".concat(t,"'"))}function w(t){if(!t)throw new Error("no JWT passed into decodeJWT");var e=t.match(/^([a-zA-Z0-9_-]+)\.([a-zA-Z0-9_-]+)\.([a-zA-Z0-9_-]+)$/);if(e)return{header:JSON.parse(c.default.decode(e[1])),payload:JSON.parse(c.default.decode(e[2])),signature:e[3],data:"".concat(e[1],".").concat(e[2])};throw new Error("Incorrect format JWT")}function b(t,e){return _.apply(this,arguments)}function _(){return(_=(0,s.default)(i.default.mark((function t(e,r){var n,s,a,c,h,f,m,g,y;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.issuer,s=r.signer,a=r.alg,c=r.expiresIn,s){t.next=3;break}throw new Error("No Signer functionality has been configured");case 3:if(n){t.next=5;break}throw new Error("No issuing DID has been configured");case 5:if(h=(0,o.default)({},l,{alg:a||d}),f={iat:Math.floor(Date.now()/1e3)},!c){t.next=13;break}if("number"!=typeof c){t.next=12;break}f.exp=f.iat+Math.floor(c),t.next=13;break;case 12:throw new Error("JWT expiresIn is not a number");case 13:return m=[p(h),p((0,o.default)({},f,e,{iss:n}))].join("."),g=(0,u.default)(h.alg),t.next=17,g(m,s);case 17:return y=t.sent,t.abrupt("return",[m,y].join("."));case 19:case"end":return t.stop()}}),t,this)})))).apply(this,arguments)}function E(t){return x.apply(this,arguments)}function x(){return x=(0,s.default)(i.default.mark((function t(e){var r,n,o,s,u,c,h,f,l,d,p,g,b,_=arguments;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=_.length>1&&_[1]!==undefined?_[1]:{},n=r.audience?v(r.audience):undefined,o=w(e),s=o.payload,u=o.header,c=o.signature,h=o.data,t.next=5,T(u.alg,s.iss,r.auth);case 5:if(f=t.sent,l=f.doc,d=f.authenticators,p=f.issuer,g=(0,a.default)(u.alg)(h,c,d),b=Math.floor(Date.now()/1e3),!g){t.next=31;break}if(!(s.iat&&s.iat>b+m)){t.next=14;break}throw new Error("JWT not valid yet (issued in the future): iat: ".concat(s.iat," > now: ").concat(b));case 14:if(!(s.exp&&s.exp<=b-m)){t.next=16;break}throw new Error("JWT has expired: exp: ".concat(s.exp," < now: ").concat(b));case 16:if(!s.aud){t.next=28;break}if(!y(s.aud)){t.next=24;break}if(n){t.next=20;break}throw new Error("JWT audience is required but your app address has not been configured");case 20:if(n===v(s.aud)){t.next=22;break}throw new Error("JWT audience does not match your DID: aud: ".concat(s.aud," !== yours: ").concat(n));case 22:t.next=28;break;case 24:if(r.callbackUrl){t.next=26;break}throw new Error("JWT audience matching your callback url is required but one wasn't passed in");case 26:if(s.aud===r.callbackUrl){t.next=28;break}throw new Error("JWT audience does not match the callback url: aud: ".concat(s.aud," !== url: ").concat(r.callbackUrl));case 28:return t.abrupt("return",{payload:s,doc:l,issuer:p,signer:g,jwt:e});case 31:case"end":return t.stop()}}),t,this)}))),x.apply(this,arguments)}function T(t,e,r){return k.apply(this,arguments)}function k(){return(k=(0,s.default)(i.default.mark((function t(e,r,n){var o,s,a,u,c;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((o=f[e])&&0!==o.length){t.next=3;break}throw new Error("No supported signature types for algorithm ".concat(e));case 3:return s=v(r),t.next=6,(0,h.default)(s);case 6:if(a=t.sent){t.next=9;break}throw new Error("Unable to resolve DID document for ".concat(s));case 9:if(u=!n||(a.authentication||[]).map((function(t){return t.publicKey})),c=(a.publicKey||[]).filter((function(t){var e=t.type,r=t.id;return o.find((function(t){return t===e&&(!n||u.indexOf(r)>=0)}))})),!n||c&&0!==c.length){t.next=13;break}throw new Error("DID document for ".concat(s," does not have public keys suitable for authenticationg user"));case 13:if(c&&0!==c.length){t.next=15;break}throw new Error("DID document for ".concat(s," does not have public keys for ").concat(e));case 15:return t.abrupt("return",{authenticators:c,issuer:s,doc:a});case 16:case"end":return t.stop()}}),t,this)})))).apply(this,arguments)}r.IAT_SKEW=m;var S={decodeJWT:w,createJWT:b,verifyJWT:E,resolveAuthenticator:T};r.default=S}}},{package:"3box>3id-resolver>did-jwt"}],[2638,{"@babel/runtime/helpers/asyncToGenerator":303,"@babel/runtime/helpers/interopRequireDefault":313,"@babel/runtime/regenerator":334,tweetnacl:6872,"tweetnacl-util":6871},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("@babel/runtime/helpers/interopRequireDefault"),i=n(t("@babel/runtime/regenerator")),o=n(t("@babel/runtime/helpers/asyncToGenerator")),s=n(t("tweetnacl")),a=n(t("tweetnacl-util"));function u(t){return a.default.encodeBase64(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}e.exports=function(t){var e=a.default.decodeBase64(t);return function(){var t=(0,o.default)(i.default.mark((function t(r){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",u(s.default.sign.detached(a.default.decodeUTF8(r),e)));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}}}},{package:"3box>3id-resolver>did-jwt"}],[2639,{"@babel/runtime/helpers/asyncToGenerator":303,"@babel/runtime/helpers/interopRequireDefault":313,"@babel/runtime/regenerator":334,base64url:2323,buffer:2438},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.ES256KSigner=u,r.Ed25519Signer=c;var i=n(t("@babel/runtime/regenerator")),o=n(t("@babel/runtime/helpers/asyncToGenerator")),s=n(t("base64url")),a=t("buffer");function u(){var t=arguments.length>0&&arguments[0]!==undefined&&arguments[0];function e(e){var r=e.r,n=e.s,i=e.recoveryParam,o=a.Buffer.alloc(t?65:64);if(a.Buffer.from(r,"hex").copy(o,0),a.Buffer.from(n,"hex").copy(o,32),t){if(i===undefined)throw new Error("Signer did not return a recoveryParam");o[64]=i}return s.default.encode(o)}return function(){var t=(0,o.default)(i.default.mark((function t(r,n){var o;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n(r);case 2:return o=t.sent,t.abrupt("return",e(o));case 4:case"end":return t.stop()}}),t,this)})));return function(e,r){return t.apply(this,arguments)}}()}function c(){return function(){var t=(0,o.default)(i.default.mark((function t(e,r){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r(e));case 1:case"end":return t.stop()}}),t,this)})));return function(e,r){return t.apply(this,arguments)}}()}var h={ES256K:u(),"ES256K-R":u(!0),Ed25519:c()};e.exports=function(t){var e=h[t];if(!e)throw new Error("Unsupported algorithm ".concat(t));return e}}}},{package:"3box>3id-resolver>did-jwt"}],[2640,{"./Digest":2636,"@babel/runtime/helpers/asyncToGenerator":303,"@babel/runtime/helpers/interopRequireDefault":313,"@babel/runtime/regenerator":334,elliptic:2685},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("@babel/runtime/helpers/interopRequireDefault"),i=n(t("@babel/runtime/regenerator")),o=n(t("@babel/runtime/helpers/asyncToGenerator")),s=t("elliptic"),a=t("./Digest"),u=new s.ec("secp256k1");function c(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:64;return t.length===e?t:"0".repeat(e-t.length)+t}e.exports=function(t){var e=u.keyFromPrivate(t);return function(){var t=(0,o.default)(i.default.mark((function t(r){var n,o,s,u;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.sign((0,a.sha256)(r)),o=n.r,s=n.s,u=n.recoveryParam,t.abrupt("return",{r:c(o.toString("hex")),s:c(s.toString("hex")),recoveryParam:u});case 2:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}}}},{package:"3box>3id-resolver>did-jwt"}],[2641,{"./Digest":2636,"@babel/runtime/helpers/interopRequireDefault":313,base64url:2323,elliptic:2685,tweetnacl:6872,"tweetnacl-util":6871},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.toSignatureObject=h,r.verifyES256K=f,r.verifyRecoverableES256K=l,r.verifyEd25519=d;var i=t("elliptic"),o=t("./Digest"),s=n(t("base64url")),a=n(t("tweetnacl")),u=n(t("tweetnacl-util")),c=new i.ec("secp256k1");function h(t){var e=arguments.length>1&&arguments[1]!==undefined&&arguments[1],r=s.default.toBuffer(t);if(r.length!==(e?65:64))throw new Error("wrong signature length");var n=r.slice(0,32).toString("hex"),i=r.slice(32,64).toString("hex"),o={r:n,s:i};return e&&(o.recoveryParam=r[64]),o}function f(t,e,r){var n=(0,o.sha256)(t),i=h(e),s=r.find((function(t){var e=t.publicKeyHex;return c.keyFromPublic(e,"hex").verify(n,i)}));if(!s)throw new Error("Signature invalid for JWT");return s}function l(t,e,r){var n=h(e,!0),i=(0,o.sha256)(t),s=c.recoverPubKey(i,n,n.recoveryParam),a=s.encode("hex"),u=s.encode("hex",!0),f=(0,o.toEthereumAddress)(a),l=r.find((function(t){var e=t.publicKeyHex,r=t.ethereumAddress;return e===a||e===u||r===f}));if(!l)throw new Error("Signature invalid for JWT");return l}function d(t,e,r){var n=u.default.decodeUTF8(t),i=u.default.decodeBase64(s.default.toBase64(e)),o=r.find((function(t){var e=t.publicKeyBase64;return a.default.sign.detached.verify(n,i,u.default.decodeBase64(e))}));if(!o)throw new Error("Signature invalid for JWT");return o}var p={ES256K:f,"ES256K-R":l,Ed25519:d};function m(t){var e=p[t];if(!e)throw new Error("Unsupported algorithm ".concat(t));return e}m.toSignatureObject=h,e.exports=m}}},{package:"3box>3id-resolver>did-jwt"}],[2642,{"./JWT":2637,"./NaclSigner":2638,"./SimpleSigner":2640,"@babel/runtime/helpers/interopRequireDefault":313},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("@babel/runtime/helpers/interopRequireDefault"),i=n(t("./SimpleSigner")),o=n(t("./NaclSigner")),s=t("./JWT");e.exports={SimpleSigner:i.default,NaclSigner:o.default,verifyJWT:s.verifyJWT,createJWT:s.createJWT,decodeJWT:s.decodeJWT}}}},{package:"3box>3id-resolver>did-jwt"}],[2643,{},function(){with(this)return function(){"use strict";return function(t,e,r){var n,i,o=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function s(t){try{u(n.next(t))}catch(t){o(t)}}function a(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new r((function(e){e(t.value)})).then(s,a)}u((n=n.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};function a(t){if(""===t)throw new Error("Missing DID");var e=t.match(/^did:([a-zA-Z0-9_]+):([[a-zA-Z0-9_.-]+)(\/[^#]*)?(#.*)?$/);if(e){var r={did:e[0],method:e[1],id:e[2]};return e[3]&&(r.path=e[3]),e[4]&&(r.fragment=e[4].slice(1)),r}throw new Error("Invalid DID "+t)}Object.defineProperty(r,"__esModule",{value:!0}),n="object"==typeof window?window:"object"==typeof global?global:{DID_REGISTRY:{}},i=n.DID_REGISTRY?n.DID_REGISTRY:n.DID_REGISTRY={},r.registerMethod=function(t,e){i[t]=e},r.parse=a,r.default=function(t){return o(this,void 0,void 0,(function(){var e,r;return s(this,(function(n){switch(n.label){case 0:return e=a(t),(r=i[e.method])?[4,r(t,e)]:[3,2];case 1:return[2,n.sent()];case 2:throw new Error("Unsupported DID method: '"+e.method+"'")}}))}))}}}},{package:"3box>did-jwt>did-resolver"}],[2653,{},function(){with(this)return function(){"use strict";return function(t,e,r){var n;n=this,"object"==typeof r&&void 0!==e?e.exports=function(t,e,r,n,i){for(e=e.split?e.split("."):e,n=0;n<e.length;n++)t=t?t[e[n]]:i;return t===i?r:t}:"function"==typeof define&&define.amd?define((function(){return function(t,e,r,n,i){for(e=e.split?e.split("."):e,n=0;n<e.length;n++)t=t?t[e[n]]:i;return t===i?r:t}})):n.dlv=function(t,e,r,n,i){for(e=e.split?e.split("."):e,n=0;n<e.length;n++)t=t?t[e[n]]:i;return t===i?r:t}}}},{package:"3box>ipfs>dlv"}],[2681,{"./lib/hash-info.json":2682,buffer:2438,"create-hmac":2555},function(){with(this)return function(){"use strict";return function(t,e,r){(function(r){(function(){var n=t("create-hmac"),i=t("./lib/hash-info.json"),o=new r(0),s=new r([0]),a=new r([1]);function u(t,e,r,n){var o=i[t];if(o===undefined)throw new Error("hash "+t+" is not supported");this._algo=t,this._securityStrength=o.securityStrength/8,this._outlen=o.outlen/8,this._reseedInterval=281474976710656,this._init(e,r,n)}u.prototype._update=function(t){var e=n(this._algo,this._K).update(this._V).update(s);t&&e.update(t),this._K=e.digest(),this._V=n(this._algo,this._K).update(this._V).digest(),t&&(this._K=n(this._algo,this._K).update(this._V).update(a).update(t).digest(),this._V=n(this._algo,this._K).update(this._V).digest())},u.prototype._init=function(t,e,n){if(t.length<this._securityStrength)throw new Error("Not enough entropy");this._K=new r(this._outlen),this._V=new r(this._outlen);for(var i=0;i<this._K.length;++i)this._K[i]=0,this._V[i]=1;this._update(r.concat([t,e,n||o])),this._reseed=1},u.prototype.reseed=function(t,e){if(t.length<this._securityStrength)throw new Error("Not enough entropy");this._update(r.concat([t,e||o])),this._reseed=1},u.prototype.generate=function(t,e){if(this._reseed>this._reseedInterval)throw new Error("Reseed is required");e&&0===e.length&&(e=undefined),e&&this._update(e);for(var i=new r(0);i.length<t;)this._V=n(this._algo,this._K).update(this._V).digest(),i=r.concat([i,this._V]);return this._update(e),this._reseed+=1,i.slice(0,t)},e.exports=u}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-trezor-keyring>hdkey>secp256k1>drbg.js"}],[2682,{},function(){with(this)return function(){"use strict";return function(t,e,r){e.exports={sha1:{securityStrength:128,outlen:160,seedlen:440},sha224:{securityStrength:192,outlen:224,seedlen:440},sha256:{securityStrength:256,outlen:256,seedlen:440},sha384:{securityStrength:256,outlen:384,seedlen:888},sha512:{securityStrength:256,outlen:512,seedlen:888}}}}},{package:"eth-trezor-keyring>hdkey>secp256k1>drbg.js"}],[2683,{stream:2441},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("stream"),i=["write","end","destroy"],o=["resume","pause"],s=["data","close"],a=Array.prototype.slice;function u(t,e){if(t.forEach)return t.forEach(e);for(var r=0;r<t.length;r++)e(t[r],r)}e.exports=function(t,e){var r=new n,c=!1;return u(i,(function(e){function n(){return t[e].apply(t,arguments)}r[e]=n})),u(o,(function(t){function n(){r.emit(t);var n=e[t];if(n)return n.apply(e,arguments);e.emit(t)}r[t]=n})),u(s,(function(t){function n(){var e=a.call(arguments);e.unshift(t),r.emit.apply(r,e)}e.on(t,n)})),e.on("end",(function(){if(c)return;c=!0;var t=a.call(arguments);t.unshift("end"),r.emit.apply(r,t)})),t.on("drain",(function(){r.emit("drain")})),t.on("error",h),e.on("error",h),r.writable=t.writable,r.readable=e.readable,r;function h(t){r.emit("error",t)}}}}},{package:"debounce-stream>duplexer"}],[27,{},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.WALLET_PREFIX=r.NOTIFICATION_NAMES=r.LOG_METHOD_TYPES=r.LOG_LIMIT=r.LOG_IGNORE_METHODS=void 0;r.WALLET_PREFIX="wallet_";r.NOTIFICATION_NAMES={accountsChanged:"metamask_accountsChanged",unlockStateChanged:"metamask_unlockStateChanged",chainChanged:"metamask_chainChanged"};r.LOG_IGNORE_METHODS=["wallet_registerOnboarding","wallet_watchAsset"];r.LOG_METHOD_TYPES={restricted:"restricted",internal:"internal"};r.LOG_LIMIT=100}}},{package:"$root$"}],[2701,{"abstract-leveldown":2705,inherits:5299,"level-codec":5661,"level-errors":5663},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("abstract-leveldown").AbstractLevelDOWN,i=t("abstract-leveldown").AbstractChainedBatch,o=t("abstract-leveldown").AbstractIterator,s=t("inherits"),a=t("level-codec"),u=t("level-errors").EncodingError;function c(t,e){if(!(this instanceof c))return new c(t,e);n.call(this,""),void 0===(e=e||{}).keyEncoding&&(e.keyEncoding="utf8"),void 0===e.valueEncoding&&(e.valueEncoding="utf8"),this.db=t,this.codec=new a(e)}function h(t,e){o.call(this,t),this.codec=t.codec,this.keys=e.keys,this.values=e.values,this.opts=this.codec.encodeLtgt(e),this.it=t.db.iterator(this.opts)}function f(t,e){i.call(this,t),this.codec=t.codec,this.batch=t.db.batch()}e.exports=c.default=c,s(c,n),c.prototype._serializeKey=c.prototype._serializeValue=function(t){return t},c.prototype._open=function(t,e){this.db.open(t,e)},c.prototype._close=function(t){this.db.close(t)},c.prototype._put=function(t,e,r,n){t=this.codec.encodeKey(t,r),e=this.codec.encodeValue(e,r),this.db.put(t,e,r,n)},c.prototype._get=function(t,e,r){var n=this;t=this.codec.encodeKey(t,e),e.asBuffer=this.codec.valueAsBuffer(e),this.db.get(t,e,(function(t,i){if(t)return r(t);try{i=n.codec.decodeValue(i,e)}catch(t){return r(new u(t))}r(null,i)}))},c.prototype._del=function(t,e,r){t=this.codec.encodeKey(t,e),this.db.del(t,e,r)},c.prototype._chainedBatch=function(){return new f(this)},c.prototype._batch=function(t,e,r){t=this.codec.encodeBatch(t,e),this.db.batch(t,e,r)},c.prototype._iterator=function(t){return t.keyAsBuffer=this.codec.keyAsBuffer(t),t.valueAsBuffer=this.codec.valueAsBuffer(t),new h(this,t)},c.prototype.approximateSize=function(t,e,r,n){return t=this.codec.encodeKey(t,r),e=this.codec.encodeKey(e,r),this.db.approximateSize(t,e,r,n)},s(h,o),h.prototype._next=function(t){var e=this;this.it.next((function(r,n,i){if(r)return t(r);try{n=e.keys&&void 0!==n?e.codec.decodeKey(n,e.opts):undefined,i=e.values&&void 0!==i?e.codec.decodeValue(i,e.opts):undefined}catch(r){return t(new u(r))}t(null,n,i)}))},h.prototype._seek=function(t){t=this.codec.encodeKey(t,this.opts),this.it.seek(t)},h.prototype._end=function(t){this.it.end(t)},s(f,i),f.prototype._put=function(t,e){t=this.codec.encodeKey(t),e=this.codec.encodeValue(e),this.batch.put(t,e)},f.prototype._del=function(t){t=this.codec.encodeKey(t),this.batch.del(t)},f.prototype._clear=function(){this.batch.clear()},f.prototype._write=function(t,e){this.batch.write(t,e)}}}},{package:"3box>ipfs>ipfs-repo>datastore-level>encoding-down"}],[2702,{"./next-tick":2706},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("./next-tick");function i(t){if("object"!=typeof t||null===t)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=t,this._operations=[],this._written=!1}i.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")},i.prototype.put=function(t,e){this._checkWritten();var r=this.db._checkKey(t)||this.db._checkValue(e);if(r)throw r;return t=this.db._serializeKey(t),e=this.db._serializeValue(e),this._put(t,e),this},i.prototype._put=function(t,e){this._operations.push({type:"put",key:t,value:e})},i.prototype.del=function(t){this._checkWritten();var e=this.db._checkKey(t);if(e)throw e;return t=this.db._serializeKey(t),this._del(t),this},i.prototype._del=function(t){this._operations.push({type:"del",key:t})},i.prototype.clear=function(){return this._checkWritten(),this._clear(),this},i.prototype._clear=function(){this._operations=[]},i.prototype.write=function(t,e){if(this._checkWritten(),"function"==typeof t&&(e=t),"function"!=typeof e)throw new Error("write() requires a callback argument");"object"==typeof t&&null!==t||(t={}),this._written=!0,this._write(t,e)},i.prototype._write=function(t,e){this.db._batch(this._operations,t,e)},i.prototype._nextTick=n,e.exports=i}}},{package:"3box>ipfs>ipfs-repo>datastore-level>encoding-down>abstract-leveldown"}],[2703,{"./next-tick":2706},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("./next-tick");function i(t){if("object"!=typeof t||null===t)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=t,this._ended=!1,this._nexting=!1}i.prototype.next=function(t){var e=this;if("function"!=typeof t)throw new Error("next() requires a callback argument");return e._ended?(n(t,new Error("cannot call next() after end()")),e):e._nexting?(n(t,new Error("cannot call next() before previous next() has completed")),e):(e._nexting=!0,e._next((function(){e._nexting=!1,t.apply(null,arguments)})),e)},i.prototype._next=function(t){n(t)},i.prototype.seek=function(t){if(this._ended)throw new Error("cannot call seek() after end()");if(this._nexting)throw new Error("cannot call seek() before next() has completed");t=this.db._serializeKey(t),this._seek(t)},i.prototype._seek=function(t){},i.prototype.end=function(t){if("function"!=typeof t)throw new Error("end() requires a callback argument");if(this._ended)return n(t,new Error("end() already called on iterator"));this._ended=!0,this._end(t)},i.prototype._end=function(t){n(t)},i.prototype._nextTick=n,e.exports=i}}},{package:"3box>ipfs>ipfs-repo>datastore-level>encoding-down>abstract-leveldown"}],[2704,{"./abstract-chained-batch":2702,"./abstract-iterator":2703,"./next-tick":2706,buffer:2438,"level-supports":2707,xtend:7041},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("xtend"),i=t("level-supports"),o=t("buffer").Buffer,s=t("./abstract-iterator"),a=t("./abstract-chained-batch"),u=t("./next-tick"),c=Object.prototype.hasOwnProperty,h="start end gt gte lt lte".split(" ");function f(t){this.status="new",this.supports=i(t,{status:!0})}function l(t,e){var r={};for(var n in e)if(c.call(e,n)){var i=e[n];d(n)&&(i=t._serializeKey(i)),r[n]=i}return r}function d(t){return-1!==h.indexOf(t)}f.prototype.open=function(t,e){var r=this,n=this.status;if("function"==typeof t&&(e=t),"function"!=typeof e)throw new Error("open() requires a callback argument");"object"==typeof t&&null!==t||(t={}),t.createIfMissing=!1!==t.createIfMissing,t.errorIfExists=!!t.errorIfExists,this.status="opening",this._open(t,(function(t){if(t)return r.status=n,e(t);r.status="open",e()}))},f.prototype._open=function(t,e){u(e)},f.prototype.close=function(t){var e=this,r=this.status;if("function"!=typeof t)throw new Error("close() requires a callback argument");this.status="closing",this._close((function(n){if(n)return e.status=r,t(n);e.status="closed",t()}))},f.prototype._close=function(t){u(t)},f.prototype.get=function(t,e,r){if("function"==typeof e&&(r=e),"function"!=typeof r)throw new Error("get() requires a callback argument");var n=this._checkKey(t);if(n)return u(r,n);t=this._serializeKey(t),"object"==typeof e&&null!==e||(e={}),e.asBuffer=!1!==e.asBuffer,this._get(t,e,r)},f.prototype._get=function(t,e,r){u((function(){r(new Error("NotFound"))}))},f.prototype.put=function(t,e,r,n){if("function"==typeof r&&(n=r),"function"!=typeof n)throw new Error("put() requires a callback argument");var i=this._checkKey(t)||this._checkValue(e);if(i)return u(n,i);t=this._serializeKey(t),e=this._serializeValue(e),"object"==typeof r&&null!==r||(r={}),this._put(t,e,r,n)},f.prototype._put=function(t,e,r,n){u(n)},f.prototype.del=function(t,e,r){if("function"==typeof e&&(r=e),"function"!=typeof r)throw new Error("del() requires a callback argument");var n=this._checkKey(t);if(n)return u(r,n);t=this._serializeKey(t),"object"==typeof e&&null!==e||(e={}),this._del(t,e,r)},f.prototype._del=function(t,e,r){u(r)},f.prototype.batch=function(t,e,r){if(!arguments.length)return this._chainedBatch();if("function"==typeof e&&(r=e),"function"==typeof t&&(r=t),"function"!=typeof r)throw new Error("batch(array) requires a callback argument");if(!Array.isArray(t))return u(r,new Error("batch(array) requires an array argument"));if(0===t.length)return u(r);"object"==typeof e&&null!==e||(e={});for(var i=new Array(t.length),o=0;o<t.length;o++){if("object"!=typeof t[o]||null===t[o])return u(r,new Error("batch(array) element must be an object and not `null`"));var s=n(t[o]);if("put"!==s.type&&"del"!==s.type)return u(r,new Error("`type` must be 'put' or 'del'"));var a=this._checkKey(s.key);if(a)return u(r,a);if(s.key=this._serializeKey(s.key),"put"===s.type){var c=this._checkValue(s.value);if(c)return u(r,c);s.value=this._serializeValue(s.value)}i[o]=s}this._batch(i,e,r)},f.prototype._batch=function(t,e,r){u(r)},f.prototype.clear=function(t,e){if("function"==typeof t)e=t;else if("function"!=typeof e)throw new Error("clear() requires a callback argument");(t=l(this,t)).reverse=!!t.reverse,t.limit="limit"in t?t.limit:-1,this._clear(t,e)},f.prototype._clear=function(t,e){t.keys=!0,t.values=!1,t.keyAsBuffer=!0,t.valueAsBuffer=!0;var r=this._iterator(t),n={},i=this,o=function(t){if(t)return r.end((function(){e(t)}));r.next((function(t,s){return t?o(t):s===undefined?r.end(e):void i._del(s,n,o)}))};o()},f.prototype._setupIteratorOptions=function(t){return(t=l(this,t)).reverse=!!t.reverse,t.keys=!1!==t.keys,t.values=!1!==t.values,t.limit="limit"in t?t.limit:-1,t.keyAsBuffer=!1!==t.keyAsBuffer,t.valueAsBuffer=!1!==t.valueAsBuffer,t},f.prototype.iterator=function(t){return"object"==typeof t&&null!==t||(t={}),t=this._setupIteratorOptions(t),this._iterator(t)},f.prototype._iterator=function(t){return new s(this)},f.prototype._chainedBatch=function(){return new a(this)},f.prototype._serializeKey=function(t){return t},f.prototype._serializeValue=function(t){return t},f.prototype._checkKey=function(t){return null===t||t===undefined?new Error("key cannot be `null` or `undefined`"):o.isBuffer(t)&&0===t.length?new Error("key cannot be an empty Buffer"):""===t?new Error("key cannot be an empty String"):Array.isArray(t)&&0===t.length?new Error("key cannot be an empty Array"):void 0},f.prototype._checkValue=function(t){if(null===t||t===undefined)return new Error("value cannot be `null` or `undefined`")},f.prototype._nextTick=u,e.exports=f}}},{package:"3box>ipfs>ipfs-repo>datastore-level>encoding-down>abstract-leveldown"}],[2705,{"./abstract-chained-batch":2702,"./abstract-iterator":2703,"./abstract-leveldown":2704},function(){with(this)return function(){"use strict";return function(t,e,r){r.AbstractLevelDOWN=t("./abstract-leveldown"),r.AbstractIterator=t("./abstract-iterator"),r.AbstractChainedBatch=t("./abstract-chained-batch")}}},{package:"3box>ipfs>ipfs-repo>datastore-level>encoding-down>abstract-leveldown"}],[2706,{immediate:5289},function(){with(this)return function(){"use strict";return function(t,e,r){e.exports=t("immediate")}}},{package:"3box>ipfs>ipfs-repo>datastore-level>encoding-down>abstract-leveldown"}],[2707,{xtend:7041,"xtend/mutable":7042},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("xtend"),i=t("xtend/mutable");e.exports=function(){var t=n.apply(null,arguments);return i(t,{bufferKeys:t.bufferKeys||!1,snapshots:t.snapshots||!1,permanence:t.permanence||!1,seek:t.seek||!1,clear:t.clear||!1,status:t.status||!1,createIfMissing:t.createIfMissing||!1,errorIfExists:t.errorIfExists||!1,deferredOpen:t.deferredOpen||!1,openCallback:t.openCallback||!1,promises:t.promises||!1,streams:t.streams||!1,encodings:t.encodings||!1,additionalMethods:n(t.additionalMethods)})}}}},{package:"3box>ipfs>ipfs-repo>datastore-level>encoding-down>abstract-leveldown>level-supports"}],[2709,{},function(){with(this)return function(){"use strict";return function(t,e,r){e.exports="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client"}],[2710,{"./socket":2711,"engine.io-parser":2722},function(){with(this)return function(){"use strict";return function(t,e,r){e.exports=t("./socket"),e.exports.parser=t("engine.io-parser")}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client"}],[2711,{"./transport":2712,"./transports/index":2713,"component-emitter":2514,debug:2719,"engine.io-parser":2722,indexof:5298,parseqs:6268,parseuri:6269},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("./transports/index"),i=t("component-emitter"),o=t("debug")("engine.io-client:socket"),s=t("indexof"),a=t("engine.io-parser"),u=t("parseuri"),c=t("parseqs");function h(t,e){if(!(this instanceof h))return new h(t,e);e=e||{},t&&"object"==typeof t&&(e=t,t=null),t?(t=u(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=u(e.host).host),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.agent=e.agent||!1,this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=e.query||{},"string"==typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==e.upgrade,this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!e.forceJSONP,this.jsonp=!1!==e.jsonp,this.forceBase64=!!e.forceBase64,this.enablesXDR=!!e.enablesXDR,this.withCredentials=!1!==e.withCredentials,this.timestampParam=e.timestampParam||"t",this.timestampRequests=e.timestampRequests,this.transports=e.transports||["polling","websocket"],this.transportOptions=e.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=e.policyPort||843,this.rememberUpgrade=e.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=e.onlyBinaryUpgrades,this.perMessageDeflate=!1!==e.perMessageDeflate&&(e.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=e.pfx||null,this.key=e.key||null,this.passphrase=e.passphrase||null,this.cert=e.cert||null,this.ca=e.ca||null,this.ciphers=e.ciphers||null,this.rejectUnauthorized=e.rejectUnauthorized===undefined||e.rejectUnauthorized,this.forceNode=!!e.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(e.extraHeaders&&Object.keys(e.extraHeaders).length>0&&(this.extraHeaders=e.extraHeaders),e.localAddress&&(this.localAddress=e.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}e.exports=h,h.priorWebsocketSuccess=!1,i(h.prototype),h.protocol=a.protocol,h.Socket=h,h.Transport=t("./transport"),h.transports=t("./transports/index"),h.parser=t("engine.io-parser"),h.prototype.createTransport=function(t){o('creating transport "%s"',t);var e=function(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}(this.query);e.EIO=a.protocol,e.transport=t;var r=this.transportOptions[t]||{};return this.id&&(e.sid=this.id),new n[t]({query:e,socket:this,agent:r.agent||this.agent,hostname:r.hostname||this.hostname,port:r.port||this.port,secure:r.secure||this.secure,path:r.path||this.path,forceJSONP:r.forceJSONP||this.forceJSONP,jsonp:r.jsonp||this.jsonp,forceBase64:r.forceBase64||this.forceBase64,enablesXDR:r.enablesXDR||this.enablesXDR,withCredentials:r.withCredentials||this.withCredentials,timestampRequests:r.timestampRequests||this.timestampRequests,timestampParam:r.timestampParam||this.timestampParam,policyPort:r.policyPort||this.policyPort,pfx:r.pfx||this.pfx,key:r.key||this.key,passphrase:r.passphrase||this.passphrase,cert:r.cert||this.cert,ca:r.ca||this.ca,ciphers:r.ciphers||this.ciphers,rejectUnauthorized:r.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:r.perMessageDeflate||this.perMessageDeflate,extraHeaders:r.extraHeaders||this.extraHeaders,forceNode:r.forceNode||this.forceNode,localAddress:r.localAddress||this.localAddress,requestTimeout:r.requestTimeout||this.requestTimeout,protocols:r.protocols||void 0,isReactNative:this.isReactNative})},h.prototype.open=function(){var t;if(this.rememberUpgrade&&h.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout((function(){e.emit("error","No transports available")}),0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},h.prototype.setTransport=function(t){o("setting transport %s",t.name);var e=this;this.transport&&(o("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",(function(){e.onDrain()})).on("packet",(function(t){e.onPacket(t)})).on("error",(function(t){e.onError(t)})).on("close",(function(){e.onClose("transport close")}))},h.prototype.probe=function(t){o('probing transport "%s"',t);var e=this.createTransport(t,{probe:1}),r=!1,n=this;function i(){if(n.onlyBinaryUpgrades){var i=!this.supportsBinary&&n.transport.supportsBinary;r=r||i}r||(o('probe transport "%s" opened',t),e.send([{type:"ping",data:"probe"}]),e.once("packet",(function(i){if(!r)if("pong"===i.type&&"probe"===i.data){if(o('probe transport "%s" pong',t),n.upgrading=!0,n.emit("upgrading",e),!e)return;h.priorWebsocketSuccess="websocket"===e.name,o('pausing current transport "%s"',n.transport.name),n.transport.pause((function(){r||"closed"!==n.readyState&&(o("changing transport and sending upgrade packet"),l(),n.setTransport(e),e.send([{type:"upgrade"}]),n.emit("upgrade",e),e=null,n.upgrading=!1,n.flush())}))}else{o('probe transport "%s" failed',t);var s=new Error("probe error");s.transport=e.name,n.emit("upgradeError",s)}})))}function s(){r||(r=!0,l(),e.close(),e=null)}function a(r){var i=new Error("probe error: "+r);i.transport=e.name,s(),o('probe transport "%s" failed because of error: %s',t,r),n.emit("upgradeError",i)}function u(){a("transport closed")}function c(){a("socket closed")}function f(t){e&&t.name!==e.name&&(o('"%s" works - aborting "%s"',t.name,e.name),s())}function l(){e.removeListener("open",i),e.removeListener("error",a),e.removeListener("close",u),n.removeListener("close",c),n.removeListener("upgrading",f)}h.priorWebsocketSuccess=!1,e.once("open",i),e.once("error",a),e.once("close",u),this.once("close",c),this.once("upgrading",f),e.open()},h.prototype.onOpen=function(){if(o("socket open"),this.readyState="open",h.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){o("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},h.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(o('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else o('packet received with socket readyState "%s"',this.readyState)},h.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},h.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout((function(){"closed"!==e.readyState&&e.onClose("ping timeout")}),t||e.pingInterval+e.pingTimeout)},h.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout((function(){o("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)}),t.pingInterval)},h.prototype.ping=function(){var t=this;this.sendPacket("ping",(function(){t.emit("ping")}))},h.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},h.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(o("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},h.prototype.write=h.prototype.send=function(t,e,r){return this.sendPacket("message",t,e,r),this},h.prototype.sendPacket=function(t,e,r,n){if("function"==typeof e&&(n=e,e=undefined),"function"==typeof r&&(n=r,r=null),"closing"!==this.readyState&&"closed"!==this.readyState){(r=r||{}).compress=!1!==r.compress;var i={type:t,data:e,options:r};this.emit("packetCreate",i),this.writeBuffer.push(i),n&&this.once("flush",n),this.flush()}},h.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var t=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?n():e()})):this.upgrading?n():e()}function e(){t.onClose("forced close"),o("socket closing - telling transport to close"),t.transport.close()}function r(){t.removeListener("upgrade",r),t.removeListener("upgradeError",r),e()}function n(){t.once("upgrade",r),t.once("upgradeError",r)}return this},h.prototype.onError=function(t){o("socket error %j",t),h.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},h.prototype.onClose=function(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){o('socket close with reason: "%s"',t);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),this.writeBuffer=[],this.prevBufferLen=0}},h.prototype.filterUpgrades=function(t){for(var e=[],r=0,n=t.length;r<n;r++)~s(this.transports,t[r])&&e.push(t[r]);return e}}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client"}],[2712,{"component-emitter":2514,"engine.io-parser":2722},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("engine.io-parser"),i=t("component-emitter");function o(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.withCredentials=t.withCredentials,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.isReactNative=t.isReactNative,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}e.exports=o,i(o.prototype),o.prototype.onError=function(t,e){var r=new Error(t);return r.type="TransportError",r.description=e,this.emit("error",r),this},o.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},o.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},o.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},o.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},o.prototype.onData=function(t){var e=n.decodePacket(t,this.socket.binaryType);this.onPacket(e)},o.prototype.onPacket=function(t){this.emit("packet",t)},o.prototype.onClose=function(){this.readyState="closed",this.emit("close")}}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client"}],[2713,{"./polling-jsonp":2714,"./polling-xhr":2715,"./websocket":2717,"xmlhttprequest-ssl":2718},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("xmlhttprequest-ssl"),i=t("./polling-xhr"),o=t("./polling-jsonp"),s=t("./websocket");r.polling=function(t){var e=!1,r=!1,s=!1!==t.jsonp;if("undefined"!=typeof location){var a="https:"===location.protocol,u=location.port;u||(u=a?443:80),e=t.hostname!==location.hostname||u!==t.port,r=t.secure!==a}if(t.xdomain=e,t.xscheme=r,"open"in new n(t)&&!t.forceJSONP)return new i(t);if(!s)throw new Error("JSONP disabled");return new o(t)},r.websocket=s}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client"}],[2714,{"../globalThis":2709,"./polling":2716,"component-inherit":2515},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("./polling"),i=t("component-inherit"),o=t("../globalThis");e.exports=h;var s,a=/\n/g,u=/\\n/g;function c(){}function h(t){n.call(this,t),this.query=this.query||{},s||(s=o.___eio=o.___eio||[]),this.index=s.length;var e=this;s.push((function(t){e.onData(t)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){e.script&&(e.script.onerror=c)}),!1)}i(h,n),h.prototype.supportsBinary=!1,h.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),n.prototype.doClose.call(this)},h.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(e,r):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)}),100)},h.prototype.doWrite=function(t,e){var r=this;if(!this.form){var n,i=document.createElement("form"),o=document.createElement("textarea"),s=this.iframeId="eio_iframe_"+this.index;i.className="socketio",i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.target=s,i.method="POST",i.setAttribute("accept-charset","utf-8"),o.name="d",i.appendChild(o),document.body.appendChild(i),this.form=i,this.area=o}function c(){h(),e()}function h(){if(r.iframe)try{r.form.removeChild(r.iframe)}catch(t){r.onError("jsonp polling iframe removal error",t)}try{var t='<iframe src="javascript:0" name="'+r.iframeId+'">';n=document.createElement(t)}catch(t){(n=document.createElement("iframe")).name=r.iframeId,n.src="javascript:0"}n.id=r.iframeId,r.form.appendChild(n),r.iframe=n}this.form.action=this.uri(),h(),t=t.replace(u,"\\\n"),this.area.value=t.replace(a,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===r.iframe.readyState&&c()}:this.iframe.onload=c}}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client"}],[2715,{"../globalThis":2709,"./polling":2716,"component-emitter":2514,"component-inherit":2515,debug:2719,"xmlhttprequest-ssl":2718},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("xmlhttprequest-ssl"),i=t("./polling"),o=t("component-emitter"),s=t("component-inherit"),a=t("debug")("engine.io-client:polling-xhr"),u=t("../globalThis");function c(){}function h(t){if(i.call(this,t),this.requestTimeout=t.requestTimeout,this.extraHeaders=t.extraHeaders,"undefined"!=typeof location){var e="https:"===location.protocol,r=location.port;r||(r=e?443:80),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||r!==t.port,this.xs=t.secure!==e}}function f(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=undefined!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.withCredentials=t.withCredentials,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}if(e.exports=h,e.exports.Request=f,s(h,i),h.prototype.supportsBinary=!0,h.prototype.request=function(t){return(t=t||{}).uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.withCredentials=this.withCredentials,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new f(t)},h.prototype.doWrite=function(t,e){var r="string"!=typeof t&&t!==undefined,n=this.request({method:"POST",data:t,isBinary:r}),i=this;n.on("success",e),n.on("error",(function(t){i.onError("xhr post error",t)})),this.sendXhr=n},h.prototype.doPoll=function(){a("xhr poll");var t=this.request(),e=this;t.on("data",(function(t){e.onData(t)})),t.on("error",(function(t){e.onError("xhr poll error",t)})),this.pollXhr=t},o(f.prototype),f.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var e=this.xhr=new n(t),r=this;try{a("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var i in e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&e.setRequestHeader(i,this.extraHeaders[i])}catch(t){}if("POST"===this.method)try{this.isBinary?e.setRequestHeader("Content-type","application/octet-stream"):e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{e.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in e&&(e.withCredentials=this.withCredentials),this.requestTimeout&&(e.timeout=this.requestTimeout),this.hasXDR()?(e.onload=function(){r.onLoad()},e.onerror=function(){r.onError(e.responseText)}):e.onreadystatechange=function(){if(2===e.readyState)try{var t=e.getResponseHeader("Content-Type");(r.supportsBinary&&"application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&(e.responseType="arraybuffer")}catch(t){}4===e.readyState&&(200===e.status||1223===e.status?r.onLoad():setTimeout((function(){r.onError("number"==typeof e.status?e.status:0)}),0))},a("xhr data %s",this.data),e.send(this.data)}catch(t){return void setTimeout((function(){r.onError(t)}),0)}"undefined"!=typeof document&&(this.index=f.requestsCount++,f.requests[this.index]=this)},f.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},f.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},f.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},f.prototype.cleanup=function(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=c:this.xhr.onreadystatechange=c,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete f.requests[this.index],this.xhr=null}},f.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type")}catch(t){}t=("application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&this.xhr.response||this.xhr.responseText}catch(t){this.onError(t)}null!=t&&this.onData(t)},f.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},f.prototype.abort=function(){this.cleanup()},f.requestsCount=0,f.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",l);else if("function"==typeof addEventListener){addEventListener("onpagehide"in u?"pagehide":"unload",l,!1)}function l(){for(var t in f.requests)f.requests.hasOwnProperty(t)&&f.requests[t].abort()}}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client"}],[2716,{"../transport":2712,"component-inherit":2515,debug:2719,"engine.io-parser":2722,parseqs:6268,"xmlhttprequest-ssl":2718,yeast:7045},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("../transport"),i=t("parseqs"),o=t("engine.io-parser"),s=t("component-inherit"),a=t("yeast"),u=t("debug")("engine.io-client:polling");e.exports=h;var c=null!=new(t("xmlhttprequest-ssl"))({xdomain:!1}).responseType;function h(t){var e=t&&t.forceBase64;c&&!e||(this.supportsBinary=!1),n.call(this,t)}s(h,n),h.prototype.name="polling",h.prototype.doOpen=function(){this.poll()},h.prototype.pause=function(t){var e=this;function r(){u("paused"),e.readyState="paused",t()}if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&(u("we are currently polling - waiting to pause"),n++,this.once("pollComplete",(function(){u("pre-pause polling complete"),--n||r()}))),this.writable||(u("we are currently writing - waiting to pause"),n++,this.once("drain",(function(){u("pre-pause writing complete"),--n||r()})))}else r()},h.prototype.poll=function(){u("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},h.prototype.onData=function(t){var e=this;u("polling got data %s",t);o.decodePayload(t,this.socket.binaryType,(function(t,r,n){if("opening"===e.readyState&&"open"===t.type&&e.onOpen(),"close"===t.type)return e.onClose(),!1;e.onPacket(t)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState))},h.prototype.doClose=function(){var t=this;function e(){u("writing close packet"),t.write([{type:"close"}])}"open"===this.readyState?(u("transport open - closing"),e()):(u("transport not open - deferring close"),this.once("open",e))},h.prototype.write=function(t){var e=this;this.writable=!1;var r=function(){e.writable=!0,e.emit("drain")};o.encodePayload(t,this.supportsBinary,(function(t){e.doWrite(t,r)}))},h.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",r="";return!1!==this.timestampRequests&&(t[this.timestampParam]=a()),this.supportsBinary||t.sid||(t.b64=1),t=i.encode(t),this.port&&("https"===e&&443!==Number(this.port)||"http"===e&&80!==Number(this.port))&&(r=":"+this.port),t.length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+t}}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client"}],[2717,{"../transport":2712,buffer:2438,"component-inherit":2515,debug:2719,"engine.io-parser":2722,parseqs:6268,ws:2437,yeast:7045},function(){with(this)return function(){"use strict";return function(t,e,r){(function(r){(function(){var n,i,o=t("../transport"),s=t("engine.io-parser"),a=t("parseqs"),u=t("component-inherit"),c=t("yeast"),h=t("debug")("engine.io-client:websocket");if("undefined"!=typeof WebSocket?n=WebSocket:"undefined"!=typeof self&&(n=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{i=t("ws")}catch(t){}var f=n||i;function l(t){t&&t.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=n&&!t.forceNode,this.protocols=t.protocols,this.usingBrowserWebSocket||(f=i),o.call(this,t)}e.exports=l,u(l,o),l.prototype.name="websocket",l.prototype.supportsBinary=!0,l.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=this.protocols,r={};this.isReactNative||(r.agent=this.agent,r.perMessageDeflate=this.perMessageDeflate,r.pfx=this.pfx,r.key=this.key,r.passphrase=this.passphrase,r.cert=this.cert,r.ca=this.ca,r.ciphers=this.ciphers,r.rejectUnauthorized=this.rejectUnauthorized),this.extraHeaders&&(r.headers=this.extraHeaders),this.localAddress&&(r.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?e?new f(t,e):new f(t):new f(t,e,r)}catch(t){return this.emit("error",t)}this.ws.binaryType===undefined&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},l.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},l.prototype.write=function(t){var e=this;this.writable=!1;for(var n=t.length,i=0,o=n;i<o;i++)!function(t){s.encodePacket(t,e.supportsBinary,(function(i){if(!e.usingBrowserWebSocket){var o={};if(t.options&&(o.compress=t.options.compress),e.perMessageDeflate)("string"==typeof i?r.byteLength(i):i.length)<e.perMessageDeflate.threshold&&(o.compress=!1)}try{e.usingBrowserWebSocket?e.ws.send(i):e.ws.send(i,o)}catch(t){h("websocket closed before onclose event")}--n||a()}))}(t[i]);function a(){e.emit("flush"),setTimeout((function(){e.writable=!0,e.emit("drain")}),0)}},l.prototype.onClose=function(){o.prototype.onClose.call(this)},l.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},l.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",r="";return this.port&&("wss"===e&&443!==Number(this.port)||"ws"===e&&80!==Number(this.port))&&(r=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=c()),this.supportsBinary||(t.b64=1),(t=a.encode(t)).length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+t},l.prototype.check=function(){return!(!f||"__initialize"in f&&this.name===l.prototype.name)}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client"}],[2718,{"./globalThis":2709,"has-cors":5235},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("has-cors"),i=t("./globalThis");e.exports=function(t){var e=t.xdomain,r=t.xscheme,o=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!e||n))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!r&&o)return new XDomainRequest}catch(t){}if(!e)try{return new(i[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client"}],[2719,{"./debug":2720,_process:6295},function(){with(this)return function(){"use strict";return function(t,e,r){(function(n){(function(){function i(){var t;try{t=r.storage.debug}catch(t){}return!t&&void 0!==n&&"env"in n&&(t=n.env.DEBUG),t}(r=e.exports=t("./debug")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},r.formatArgs=function(t){var e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+r.humanize(this.diff),!e)return;var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"!==t&&(i++,"%c"===t&&(o=i))})),t.splice(o,0,n)},r.save=function(t){try{null==t?r.storage.removeItem("debug"):r.storage.debug=t}catch(t){}},r.load=i,r.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},r.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],r.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},r.enable(i())}).call(this)}).call(this,t("_process"))}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client>debug"}],[2720,{ms:2721},function(){with(this)return function(){"use strict";return function(t,e,r){function n(t){var e;function n(){if(n.enabled){var t=n,i=+new Date,o=i-(e||i);t.diff=o,t.prev=e,t.curr=i,e=i;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=r.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var u=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,(function(e,n){if("%%"===e)return e;u++;var i=r.formatters[n];if("function"==typeof i){var o=s[u];e=i.call(t,o),s.splice(u,1),u--}return e})),r.formatArgs.call(t,s);var c=n.log||r.log||console.log.bind(console);c.apply(t,s)}}return n.namespace=t,n.enabled=r.enabled(t),n.useColors=r.useColors(),n.color=function(t){var e,n=0;for(e in t)n=(n<<5)-n+t.charCodeAt(e),n|=0;return r.colors[Math.abs(n)%r.colors.length]}(t),n.destroy=i,"function"==typeof r.init&&r.init(n),r.instances.push(n),n}function i(){var t=r.instances.indexOf(this);return-1!==t&&(r.instances.splice(t,1),!0)}(r=e.exports=n.debug=n.default=n).coerce=function(t){return t instanceof Error?t.stack||t.message:t},r.disable=function(){r.enable("")},r.enable=function(t){var e;r.save(t),r.names=[],r.skips=[];var n=("string"==typeof t?t:"").split(/[\s,]+/),i=n.length;for(e=0;e<i;e++)n[e]&&("-"===(t=n[e].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+t.substr(1)+"$")):r.names.push(new RegExp("^"+t+"$")));for(e=0;e<r.instances.length;e++){var o=r.instances[e];o.enabled=r.enabled(o.namespace)}},r.enabled=function(t){if("*"===t[t.length-1])return!0;var e,n;for(e=0,n=r.skips.length;e<n;e++)if(r.skips[e].test(t))return!1;for(e=0,n=r.names.length;e<n;e++)if(r.names[e].test(t))return!0;return!1},r.humanize=t("ms"),r.instances=[],r.names=[],r.skips=[],r.formatters={}}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client>debug"}],[2721,{},function(){with(this)return function(){"use strict";return function(t,e,r){var n=1e3,i=60*n,o=60*i,s=24*o,a=365.25*s;function u(t,e,r){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+r:Math.ceil(t/e)+" "+r+"s"}e.exports=function(t,e){e=e||{};var r,c=typeof t;if("string"===c&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!e)return;var r=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*a;case"days":case"day":case"d":return r*s;case"hours":case"hour":case"hrs":case"hr":case"h":return r*o;case"minutes":case"minute":case"mins":case"min":case"m":return r*i;case"seconds":case"second":case"secs":case"sec":case"s":return r*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return undefined}}(t);if("number"===c&&!1===isNaN(t))return e.long?u(r=t,s,"day")||u(r,o,"hour")||u(r,i,"minute")||u(r,n,"second")||r+" ms":function(t){if(t>=s)return Math.round(t/s)+"d";if(t>=o)return Math.round(t/o)+"h";if(t>=i)return Math.round(t/i)+"m";if(t>=n)return Math.round(t/n)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client>debug>ms"}],[2722,{"./keys":2723,"./utf8":2724,after:2018,"arraybuffer.slice":2048,"base64-arraybuffer":2319,blob:2393,"has-binary2":5233},function(){with(this)return function(){"use strict";return function(t,e,r){var n,i=t("./keys"),o=t("has-binary2"),s=t("arraybuffer.slice"),a=t("after"),u=t("./utf8");"undefined"!=typeof ArrayBuffer&&(n=t("base64-arraybuffer"));var c="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),h="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),f=c||h;r.protocol=3;var l=r.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},d=i(l),p={type:"error",data:"parser error"},m=t("blob");function g(t,e,r){for(var n=new Array(t.length),i=a(t.length,r),o=function(t,r,i){e(r,(function(e,r){n[t]=r,i(e,n)}))},s=0;s<t.length;s++)o(s,t[s],i)}r.encodePacket=function(t,e,n,i){"function"==typeof e&&(i=e,e=!1),"function"==typeof n&&(i=n,n=null);var o=t.data===undefined?undefined:t.data.buffer||t.data;if("undefined"!=typeof ArrayBuffer&&o instanceof ArrayBuffer)return function(t,e,n){if(!e)return r.encodeBase64Packet(t,n);var i=t.data,o=new Uint8Array(i),s=new Uint8Array(1+i.byteLength);s[0]=l[t.type];for(var a=0;a<o.length;a++)s[a+1]=o[a];return n(s.buffer)}(t,e,i);if(void 0!==m&&o instanceof m)return function(t,e,n){if(!e)return r.encodeBase64Packet(t,n);if(f)return function(t,e,n){if(!e)return r.encodeBase64Packet(t,n);var i=new FileReader;return i.onload=function(){r.encodePacket({type:t.type,data:i.result},e,!0,n)},i.readAsArrayBuffer(t.data)}(t,e,n);var i=new Uint8Array(1);i[0]=l[t.type];var o=new m([i.buffer,t.data]);return n(o)}(t,e,i);if(o&&o.base64)return function(t,e){var n="b"+r.packets[t.type]+t.data.data;return e(n)}(t,i);var s=l[t.type];return undefined!==t.data&&(s+=n?u.encode(String(t.data),{strict:!1}):String(t.data)),i(""+s)},r.encodeBase64Packet=function(t,e){var n,i="b"+r.packets[t.type];if(void 0!==m&&t.data instanceof m){var o=new FileReader;return o.onload=function(){var t=o.result.split(",")[1];e(i+t)},o.readAsDataURL(t.data)}try{n=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){for(var s=new Uint8Array(t.data),a=new Array(s.length),u=0;u<s.length;u++)a[u]=s[u];n=String.fromCharCode.apply(null,a)}return i+=btoa(n),e(i)},r.decodePacket=function(t,e,n){if(t===undefined)return p;if("string"==typeof t){if("b"===t.charAt(0))return r.decodeBase64Packet(t.substr(1),e);if(n&&!1===(t=function(t){try{t=u.decode(t,{strict:!1})}catch(t){return!1}return t}(t)))return p;var i=t.charAt(0);return Number(i)==i&&d[i]?t.length>1?{type:d[i],data:t.substring(1)}:{type:d[i]}:p}i=new Uint8Array(t)[0];var o=s(t,1);return m&&"blob"===e&&(o=new m([o])),{type:d[i],data:o}},r.decodeBase64Packet=function(t,e){var r=d[t.charAt(0)];if(!n)return{type:r,data:{base64:!0,data:t.substr(1)}};var i=n.decode(t.substr(1));return"blob"===e&&m&&(i=new m([i])),{type:r,data:i}},r.encodePayload=function(t,e,n){"function"==typeof e&&(n=e,e=null);var i=o(t);if(e&&i)return m&&!f?r.encodePayloadAsBlob(t,n):r.encodePayloadAsArrayBuffer(t,n);if(!t.length)return n("0:");g(t,(function(t,n){r.encodePacket(t,!!i&&e,!1,(function(t){n(null,function(t){return t.length+":"+t}(t))}))}),(function(t,e){return n(e.join(""))}))},r.decodePayload=function(t,e,n){if("string"!=typeof t)return r.decodePayloadAsBinary(t,e,n);var i;if("function"==typeof e&&(n=e,e=null),""===t)return n(p,0,1);for(var o,s,a="",u=0,c=t.length;u<c;u++){var h=t.charAt(u);if(":"===h){if(""===a||a!=(o=Number(a)))return n(p,0,1);if(a!=(s=t.substr(u+1,o)).length)return n(p,0,1);if(s.length){if(i=r.decodePacket(s,e,!1),p.type===i.type&&p.data===i.data)return n(p,0,1);if(!1===n(i,u+o,c))return}u+=o,a=""}else a+=h}return""!==a?n(p,0,1):void 0},r.encodePayloadAsArrayBuffer=function(t,e){if(!t.length)return e(new ArrayBuffer(0));g(t,(function(t,e){r.encodePacket(t,!0,!0,(function(t){return e(null,t)}))}),(function(t,r){var n=r.reduce((function(t,e){var r;return t+(r="string"==typeof e?e.length:e.byteLength).toString().length+r+2}),0),i=new Uint8Array(n),o=0;return r.forEach((function(t){var e="string"==typeof t,r=t;if(e){for(var n=new Uint8Array(t.length),s=0;s<t.length;s++)n[s]=t.charCodeAt(s);r=n.buffer}i[o++]=e?0:1;var a=r.byteLength.toString();for(s=0;s<a.length;s++)i[o++]=parseInt(a[s]);i[o++]=255;for(n=new Uint8Array(r),s=0;s<n.length;s++)i[o++]=n[s]})),e(i.buffer)}))},r.encodePayloadAsBlob=function(t,e){g(t,(function(t,e){r.encodePacket(t,!0,!0,(function(t){var r=new Uint8Array(1);if(r[0]=1,"string"==typeof t){for(var n=new Uint8Array(t.length),i=0;i<t.length;i++)n[i]=t.charCodeAt(i);t=n.buffer,r[0]=0}var o=(t instanceof ArrayBuffer?t.byteLength:t.size).toString(),s=new Uint8Array(o.length+1);for(i=0;i<o.length;i++)s[i]=parseInt(o[i]);if(s[o.length]=255,m){var a=new m([r.buffer,s.buffer,t]);e(null,a)}}))}),(function(t,r){return e(new m(r))}))},r.decodePayloadAsBinary=function(t,e,n){"function"==typeof e&&(n=e,e=null);for(var i=t,o=[];i.byteLength>0;){for(var a=new Uint8Array(i),u=0===a[0],c="",h=1;255!==a[h];h++){if(c.length>310)return n(p,0,1);c+=a[h]}i=s(i,2+c.length),c=parseInt(c);var f=s(i,0,c);if(u)try{f=String.fromCharCode.apply(null,new Uint8Array(f))}catch(t){var l=new Uint8Array(f);f="";for(h=0;h<l.length;h++)f+=String.fromCharCode(l[h])}o.push(f),i=s(i,c)}var d=o.length;o.forEach((function(t,i){n(r.decodePacket(t,e,!0),i,d)}))}}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client>engine.io-parser"}],[2723,{},function(){with(this)return function(){"use strict";return function(t,e,r){e.exports=Object.keys||function(t){var e=[],r=Object.prototype.hasOwnProperty;for(var n in t)r.call(t,n)&&e.push(n);return e}}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client>engine.io-parser"}],[2724,{},function(){with(this)return function(){"use strict";return function(t,e,r){
/*! https://mths.be/utf8js v2.1.2 by @mathias */
var n,i,o,s=String.fromCharCode;function a(t){for(var e,r,n=[],i=0,o=t.length;i<o;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<o?56320==(64512&(r=t.charCodeAt(i++)))?n.push(((1023&e)<<10)+(1023&r)+65536):(n.push(e),i--):n.push(e);return n}function u(t,e){if(t>=55296&&t<=57343){if(e)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function c(t,e){return s(t>>e&63|128)}function h(t,e){if(0==(4294967168&t))return s(t);var r="";return 0==(4294965248&t)?r=s(t>>6&31|192):0==(4294901760&t)?(u(t,e)||(t=65533),r=s(t>>12&15|224),r+=c(t,6)):0==(4292870144&t)&&(r=s(t>>18&7|240),r+=c(t,12),r+=c(t,6)),r+=s(63&t|128)}function f(){if(o>=i)throw Error("Invalid byte index");var t=255&n[o];if(o++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function l(t){var e,r;if(o>i)throw Error("Invalid byte index");if(o==i)return!1;if(e=255&n[o],o++,0==(128&e))return e;if(192==(224&e)){if((r=(31&e)<<6|f())>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&e)){if((r=(15&e)<<12|f()<<6|f())>=2048)return u(r,t)?r:65533;throw Error("Invalid continuation byte")}if(240==(248&e)&&(r=(7&e)<<18|f()<<12|f()<<6|f())>=65536&&r<=1114111)return r;throw Error("Invalid UTF-8 detected")}e.exports={version:"2.1.2",encode:function(t,e){for(var r=!1!==(e=e||{}).strict,n=a(t),i=n.length,o=-1,s="";++o<i;)s+=h(n[o],r);return s},decode:function(t,e){var r=!1!==(e=e||{}).strict;n=a(t),i=n.length,o=0;for(var u,c=[];!1!==(u=l(r));)c.push(u);return function(t){for(var e,r=t.length,n=-1,i="";++n<r;)(e=t[n])>65535&&(i+=s((e-=65536)>>>10&1023|55296),e=56320|1023&e),i+=s(e);return i}(c)}}}}},{package:"3box>ipfs>libp2p-webrtc-star>socket.io-client>engine.io-client>engine.io-parser"}],[2725,{},function(){with(this)return function(){"use strict";return function(t,e,r){e.exports=function(t,e,r){var n,i=t instanceof Error?t:new Error(t);if("object"==typeof e?r=e:null!=e&&(i.code=e),r)for(n in r)i[n]=r[n];return i}}}},{package:"3box>ipfs>err-code"}],[2726,{prr:6317},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("prr");function i(t,e,r){e&&"string"!=typeof e&&(e=e.message||e.name),n(this,{type:t,name:t,cause:"string"!=typeof e?e:r,message:e},"ewr")}function o(t,e){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),i.call(this,"CustomError",t,e)}o.prototype=new Error,e.exports=function(t){var e=function(e,r){return function(t,e,r){var n=function(r,o){i.call(this,e,r,o),"FilesystemError"==e&&(this.code=this.cause.code,this.path=this.cause.path,this.errno=this.cause.errno,this.message=(t.errno[this.cause.errno]?t.errno[this.cause.errno].description:this.cause.message)+(this.cause.path?" ["+this.cause.path+"]":"")),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,n)};return n.prototype=r?new r:new o,n}(t,e,r)};return{CustomError:o,FilesystemError:e("FilesystemError"),createError:e}}}}},{package:"webpack>memory-fs>errno"}],[2727,{"./custom":2726},function(){with(this)return function(){"use strict";return function(t,e,r){var n=e.exports.all=[{errno:-2,code:"ENOENT",description:"no such file or directory"},{errno:-1,code:"UNKNOWN",description:"unknown error"},{errno:0,code:"OK",description:"success"},{errno:1,code:"EOF",description:"end of file"},{errno:2,code:"EADDRINFO",description:"getaddrinfo error"},{errno:3,code:"EACCES",description:"permission denied"},{errno:4,code:"EAGAIN",description:"resource temporarily unavailable"},{errno:5,code:"EADDRINUSE",description:"address already in use"},{errno:6,code:"EADDRNOTAVAIL",description:"address not available"},{errno:7,code:"EAFNOSUPPORT",description:"address family not supported"},{errno:8,code:"EALREADY",description:"connection already in progress"},{errno:9,code:"EBADF",description:"bad file descriptor"},{errno:10,code:"EBUSY",description:"resource busy or locked"},{errno:11,code:"ECONNABORTED",description:"software caused connection abort"},{errno:12,code:"ECONNREFUSED",description:"connection refused"},{errno:13,code:"ECONNRESET",description:"connection reset by peer"},{errno:14,code:"EDESTADDRREQ",description:"destination address required"},{errno:15,code:"EFAULT",description:"bad address in system call argument"},{errno:16,code:"EHOSTUNREACH",description:"host is unreachable"},{errno:17,code:"EINTR",description:"interrupted system call"},{errno:18,code:"EINVAL",description:"invalid argument"},{errno:19,code:"EISCONN",description:"socket is already connected"},{errno:20,code:"EMFILE",description:"too many open files"},{errno:21,code:"EMSGSIZE",description:"message too long"},{errno:22,code:"ENETDOWN",description:"network is down"},{errno:23,code:"ENETUNREACH",description:"network is unreachable"},{errno:24,code:"ENFILE",description:"file table overflow"},{errno:25,code:"ENOBUFS",description:"no buffer space available"},{errno:26,code:"ENOMEM",description:"not enough memory"},{errno:27,code:"ENOTDIR",description:"not a directory"},{errno:28,code:"EISDIR",description:"illegal operation on a directory"},{errno:29,code:"ENONET",description:"machine is not on the network"},{errno:31,code:"ENOTCONN",description:"socket is not connected"},{errno:32,code:"ENOTSOCK",description:"socket operation on non-socket"},{errno:33,code:"ENOTSUP",description:"operation not supported on socket"},{errno:34,code:"ENOENT",description:"no such file or directory"},{errno:35,code:"ENOSYS",description:"function not implemented"},{errno:36,code:"EPIPE",description:"broken pipe"},{errno:37,code:"EPROTO",description:"protocol error"},{errno:38,code:"EPROTONOSUPPORT",description:"protocol not supported"},{errno:39,code:"EPROTOTYPE",description:"protocol wrong type for socket"},{errno:40,code:"ETIMEDOUT",description:"connection timed out"},{errno:41,code:"ECHARSET",description:"invalid Unicode character"},{errno:42,code:"EAIFAMNOSUPPORT",description:"address family for hostname not supported"},{errno:44,code:"EAISERVICE",description:"servname not supported for ai_socktype"},{errno:45,code:"EAISOCKTYPE",description:"ai_socktype not supported"},{errno:46,code:"ESHUTDOWN",description:"cannot send after transport endpoint shutdown"},{errno:47,code:"EEXIST",description:"file already exists"},{errno:48,code:"ESRCH",description:"no such process"},{errno:49,code:"ENAMETOOLONG",description:"name too long"},{errno:50,code:"EPERM",description:"operation not permitted"},{errno:51,code:"ELOOP",description:"too many symbolic links encountered"},{errno:52,code:"EXDEV",description:"cross-device link not permitted"},{errno:53,code:"ENOTEMPTY",description:"directory not empty"},{errno:54,code:"ENOSPC",description:"no space left on device"},{errno:55,code:"EIO",description:"i/o error"},{errno:56,code:"EROFS",description:"read-only file system"},{errno:57,code:"ENODEV",description:"no such device"},{errno:58,code:"ESPIPE",description:"invalid seek"},{errno:59,code:"ECANCELED",description:"operation canceled"}];e.exports.errno={},e.exports.code={},n.forEach((function(t){e.exports.errno[t.errno]=t,e.exports.code[t.code]=t})),e.exports.custom=t("./custom")(e.exports),e.exports.create=e.exports.custom.createError}}},{package:"webpack>memory-fs>errno"}],[2729,{"@metamask/safe-event-emitter":1574},function(){with(this)return function(){"use strict";return function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0}),r.BaseBlockTracker=void 0;const i=n(t("@metamask/safe-event-emitter")),o=(t,e)=>t+e,s=["sync","latest"];class a extends i.default{constructor(t){super(),this._blockResetDuration=t.blockResetDuration||2e4,this._currentBlock=null,this._isRunning=!1,this._onNewListener=this._onNewListener.bind(this),this._onRemoveListener=this._onRemoveListener.bind(this),this._resetCurrentBlock=this._resetCurrentBlock.bind(this),this._setupInternalEvents()}async destroy(){this._cancelBlockResetTimeout(),await this._maybeEnd(),super.removeAllListeners()}isRunning(){return this._isRunning}getCurrentBlock(){return this._currentBlock}async getLatestBlock(){if(this._currentBlock)return this._currentBlock;return await new Promise((t=>this.once("latest",t)))}removeAllListeners(t){return t?super.removeAllListeners(t):super.removeAllListeners(),this._setupInternalEvents(),this._onRemoveListener(),this}_setupInternalEvents(){this.removeListener("newListener",this._onNewListener),this.removeListener("removeListener",this._onRemoveListener),this.on("newListener",this._onNewListener),this.on("removeListener",this._onRemoveListener)}_onNewListener(t){s.includes(t)&&this._maybeStart()}_onRemoveListener(){this._getBlockTrackerEventCount()>0||this._maybeEnd()}async _maybeStart(){this._isRunning||(this._isRunning=!0,this._cancelBlockResetTimeout(),await this._start(),this.emit("_started"))}async _maybeEnd(){this._isRunning&&(this._isRunning=!1,this._setupBlockResetTimeout(),await this._end(),this.emit("_ended"))}_getBlockTrackerEventCount(){return s.map((t=>this.listenerCount(t))).reduce(o)}_newPotentialLatest(t){const e=this._currentBlock;e&&u(t)<=u(e)||this._setCurrentBlock(t)}_setCurrentBlock(t){const e=this._currentBlock;this._currentBlock=t,this.emit("latest",t),this.emit("sync",{oldBlock:e,newBlock:t})}_setupBlockResetTimeout(){this._cancelBlockResetTimeout(),this._blockResetTimeout=setTimeout(this._resetCurrentBlock,this._blockResetDuration),this._blockResetTimeout.unref&&this._blockResetTimeout.unref()}_cancelBlockResetTimeout(){this._blockResetTimeout&&clearTimeout(this._blockResetTimeout)}_resetCurrentBlock(){this._currentBlock=null}}function u(t){return Number.parseInt(t,16)}r.BaseBlockTracker=a}}},{package:"eth-block-tracker"}],[2730,{"./BaseBlockTracker":2729,"./logging-utils":2733,"json-rpc-random-id":5629,pify:2734},function(){with(this)return function(){"use strict";return function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0}),r.PollingBlockTracker=void 0;const i=n(t("json-rpc-random-id")),o=n(t("pify")),s=t("./BaseBlockTracker"),a=t("./logging-utils"),u=(0,a.createModuleLogger)(a.projectLogger,"polling-block-tracker"),c=(0,i.default)();class h extends s.BaseBlockTracker{constructor(t={}){var e;if(!t.provider)throw new Error("PollingBlockTracker - no provider specified.");super({blockResetDuration:null!==(e=t.blockResetDuration)&&void 0!==e?e:t.pollingInterval}),this._provider=t.provider,this._pollingInterval=t.pollingInterval||2e4,this._retryTimeout=t.retryTimeout||this._pollingInterval/10,this._keepEventLoopActive=t.keepEventLoopActive===undefined||t.keepEventLoopActive,this._setSkipCacheFlag=t.setSkipCacheFlag||!1}async checkForLatestBlock(){return await this._updateLatestBlock(),await this.getLatestBlock()}async _start(){this._synchronize()}async _end(){}async _synchronize(){for(var t;this._isRunning;)try{await this._updateLatestBlock();const t=f(this._pollingInterval,!this._keepEventLoopActive);this.emit("_waitingForNextIteration"),await t}catch(e){const r=new Error(`PollingBlockTracker - encountered an error while attempting to update latest block:\n${null!==(t=e.stack)&&void 0!==t?t:e}`);try{this.emit("error",r)}catch(t){console.error(r)}const n=f(this._retryTimeout,!this._keepEventLoopActive);this.emit("_waitingForNextIteration"),await n}}async _updateLatestBlock(){const t=await this._fetchLatestBlock();this._newPotentialLatest(t)}async _fetchLatestBlock(){const t={jsonrpc:"2.0",id:c(),method:"eth_blockNumber",params:[]};this._setSkipCacheFlag&&(t.skipCache=!0),u("Making request",t);const e=await(0,o.default)((e=>this._provider.sendAsync(t,e)))();if(u("Got response",e),e.error)throw new Error(`PollingBlockTracker - encountered error fetching block:\n${e.error.message}`);return e.result}}function f(t,e){return new Promise((r=>{const n=setTimeout(r,t);n.unref&&e&&n.unref()}))}r.PollingBlockTracker=h}}},{package:"eth-block-tracker"}],[2731,{"./BaseBlockTracker":2729,"json-rpc-random-id":5629},function(){with(this)return function(){"use strict";return function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0}),r.SubscribeBlockTracker=void 0;const i=n(t("json-rpc-random-id")),o=t("./BaseBlockTracker"),s=(0,i.default)();class a extends o.BaseBlockTracker{constructor(t={}){if(!t.provider)throw new Error("SubscribeBlockTracker - no provider specified.");super(t),this._provider=t.provider,this._subscriptionId=null}async checkForLatestBlock(){return await this.getLatestBlock()}async _start(){if(this._subscriptionId===undefined||null===this._subscriptionId)try{const t=await this._call("eth_blockNumber");this._subscriptionId=await this._call("eth_subscribe","newHeads"),this._provider.on("data",this._handleSubData.bind(this)),this._newPotentialLatest(t)}catch(t){this.emit("error",t)}}async _end(){if(null!==this._subscriptionId&&this._subscriptionId!==undefined)try{await this._call("eth_unsubscribe",this._subscriptionId),this._subscriptionId=null}catch(t){this.emit("error",t)}}_call(t,...e){return new Promise(((r,n)=>{this._provider.sendAsync({id:s(),method:t,params:e,jsonrpc:"2.0"},((t,e)=>{t?n(t):r(e.result)}))}))}_handleSubData(t,e){var r;"eth_subscription"===e.method&&(null===(r=e.params)||void 0===r?void 0:r.subscription)===this._subscriptionId&&this._newPotentialLatest(e.params.result.number)}}r.SubscribeBlockTracker=a}}},{package:"eth-block-tracker"}],[2732,{"./PollingBlockTracker":2730,"./SubscribeBlockTracker":2731},function(){with(this)return function(){"use strict";return function(t,e,r){var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){n===undefined&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===undefined&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(t("./PollingBlockTracker"),r),i(t("./SubscribeBlockTracker"),r)}}},{package:"eth-block-tracker"}],[2733,{"@metamask/utils":1773},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createModuleLogger=r.projectLogger=void 0;const n=t("@metamask/utils");Object.defineProperty(r,"createModuleLogger",{enumerable:!0,get:function(){return n.createModuleLogger}}),r.projectLogger=(0,n.createProjectLogger)("eth-block-tracker")}}},{package:"eth-block-tracker"}],[2734,{},function(){with(this)return function(){"use strict";return function(t,e,r){const n=(t,e)=>function(){const r=e.promiseModule,n=new Array(arguments.length);for(let t=0;t<arguments.length;t++)n[t]=arguments[t];return new r(((r,i)=>{e.errorFirst?n.push((function(t,n){if(e.multiArgs){const e=new Array(arguments.length-1);for(let t=1;t<arguments.length;t++)e[t-1]=arguments[t];t?(e.unshift(t),i(e)):r(e)}else t?i(t):r(n)})):n.push((function(t){if(e.multiArgs){const t=new Array(arguments.length-1);for(let e=0;e<arguments.length;e++)t[e]=arguments[e];r(t)}else r(t)})),t.apply(this,n)}))};e.exports=(t,e)=>{e=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},e);const r=t=>{const r=e=>"string"==typeof e?t===e:e.test(t);return e.include?e.include.some(r):!e.exclude.some(r)};let i;i="function"==typeof t?function(){return e.excludeMain?t.apply(this,arguments):n(t,e).apply(this,arguments)}:Object.create(Object.getPrototypeOf(t));for(const o in t){const s=t[o];i[o]="function"==typeof s&&r(o)?n(s,e):s}return i}}}},{package:"eth-block-tracker>pify"}],[2735,{"./util":2739,"bn.js":2737,"buffer/":2738},function(){with(this)return function(){"use strict";return function(t,e,r){const n=t("./util"),i=t("bn.js"),o=t("buffer/").Buffer;function s(t){return t.startsWith("int[")?"int256"+t.slice(3):"int"===t?"int256":t.startsWith("uint[")?"uint256"+t.slice(4):"uint"===t?"uint256":t.startsWith("fixed[")?"fixed128x128"+t.slice(5):"fixed"===t?"fixed128x128":t.startsWith("ufixed[")?"ufixed128x128"+t.slice(6):"ufixed"===t?"ufixed128x128":t}function a(t){return parseInt(/^\D+(\d+)$/.exec(t)[1],10)}function u(t){var e=/^\D+(\d+)x(\d+)$/.exec(t);return[parseInt(e[1],10),parseInt(e[2],10)]}function c(t){var e=t.match(/(.*)\[(.*?)\]$/);return e?""===e[2]?"dynamic":parseInt(e[2],10):null}function h(t){var e=typeof t;if("string"===e)return n.isHexString(t)?new i(n.stripHexPrefix(t),16):new i(t,10);if("number"===e)return new i(t);if(t.toArray)return t;throw new Error("Argument is not a number")}function f(t,e){var r,s,l,d;if("address"===t)return f("uint160",h(e));if("bool"===t)return f("uint8",e?1:0);if("string"===t)return f("bytes",new o(e,"utf8"));if(function(t){return t.lastIndexOf("]")===t.length-1}(t)){if(void 0===e.length)throw new Error("Not an array?");if("dynamic"!==(r=c(t))&&0!==r&&e.length>r)throw new Error("Elements exceed array size: "+r);for(d in l=[],t=t.slice(0,t.lastIndexOf("[")),"string"==typeof e&&(e=JSON.parse(e)),e)l.push(f(t,e[d]));if("dynamic"===r){var p=f("uint256",e.length);l.unshift(p)}return o.concat(l)}if("bytes"===t)return e=new o(e),l=o.concat([f("uint256",e.length),e]),e.length%32!=0&&(l=o.concat([l,n.zeros(32-e.length%32)])),l;if(t.startsWith("bytes")){if((r=a(t))<1||r>32)throw new Error("Invalid bytes<N> width: "+r);return n.setLengthRight(e,32)}if(t.startsWith("uint")){if((r=a(t))%8||r<8||r>256)throw new Error("Invalid uint<N> width: "+r);if((s=h(e)).bitLength()>r)throw new Error("Supplied uint exceeds width: "+r+" vs "+s.bitLength());if(s<0)throw new Error("Supplied uint is negative");return s.toArrayLike(o,"be",32)}if(t.startsWith("int")){if((r=a(t))%8||r<8||r>256)throw new Error("Invalid int<N> width: "+r);if((s=h(e)).bitLength()>r)throw new Error("Supplied int exceeds width: "+r+" vs "+s.bitLength());return s.toTwos(256).toArrayLike(o,"be",32)}if(t.startsWith("ufixed")){if(r=u(t),(s=h(e))<0)throw new Error("Supplied ufixed is negative");return f("uint256",s.mul(new i(2).pow(new i(r[1]))))}if(t.startsWith("fixed"))return r=u(t),f("int256",h(e).mul(new i(2).pow(new i(r[1]))));throw new Error("Unsupported or invalid type: "+t)}function l(t){return"string"===t||"bytes"===t||"dynamic"===c(t)}function d(t,e){if(t.length!==e.length)throw new Error("Number of types are not matching the values");for(var r,i,u=[],c=0;c<t.length;c++){var f=s(t[c]),l=e[c];if("bytes"===f)u.push(l);else if("string"===f)u.push(new o(l,"utf8"));else if("bool"===f)u.push(new o(l?"01":"00","hex"));else if("address"===f)u.push(n.setLength(l,20));else if(f.startsWith("bytes")){if((r=a(f))<1||r>32)throw new Error("Invalid bytes<N> width: "+r);u.push(n.setLengthRight(l,r))}else if(f.startsWith("uint")){if((r=a(f))%8||r<8||r>256)throw new Error("Invalid uint<N> width: "+r);if((i=h(l)).bitLength()>r)throw new Error("Supplied uint exceeds width: "+r+" vs "+i.bitLength());u.push(i.toArrayLike(o,"be",r/8))}else{if(!f.startsWith("int"))throw new Error("Unsupported or invalid type: "+f);if((r=a(f))%8||r<8||r>256)throw new Error("Invalid int<N> width: "+r);if((i=h(l)).bitLength()>r)throw new Error("Supplied int exceeds width: "+r+" vs "+i.bitLength());u.push(i.toTwos(r).toArrayLike(o,"be",r/8))}}return o.concat(u)}e.exports={rawEncode:function(t,e){var r=[],n=[],i=32*t.length;for(var a in t){var u=s(t[a]),c=f(u,e[a]);l(u)?(r.push(f("uint256",i)),n.push(c),i+=c.length):r.push(c)}return o.concat(r.concat(n))},solidityPack:d,soliditySHA3:function(t,e){return n.keccak(d(t,e))}}}}},{package:"eth-lattice-keyring>gridplus-sdk>eth-eip712-util-browser"}],[2736,{"./abi":2735,"./util":2739,"buffer/":2738},function(){with(this)return function(){"use strict";return function(t,e,r){const n=t("./util"),i=t("./abi"),o=t("buffer/").Buffer,s={type:"object",properties:{types:{type:"object",additionalProperties:{type:"array",items:{type:"object",properties:{name:{type:"string"},type:{type:"string"}},required:["name","type"]}}},primaryType:{type:"string"},domain:{type:"object"},message:{type:"object"}},required:["types","primaryType","domain","message"]},a={encodeData(t,e,r,s=!0){const a=["bytes32"],u=[this.hashType(t,r)];if(s){const c=(t,e,a)=>{if(r[e]!==undefined)return["bytes32",null==a?"0x0000000000000000000000000000000000000000000000000000000000000000":n.keccak(this.encodeData(e,a,r,s))];if(a===undefined)throw new Error(`missing value for field ${t} of type ${e}`);if("bytes"===e)return["bytes32",n.keccak(a)];if("string"===e)return"string"==typeof a&&(a=o.from(a,"utf8")),["bytes32",n.keccak(a)];if(e.lastIndexOf("]")===e.length-1){const r=e.slice(0,e.lastIndexOf("[")),o=a.map((e=>c(t,r,e)));return["bytes32",n.keccak(i.rawEncode(o.map((([t])=>t)),o.map((([,t])=>t))))]}return[e,a]};for(const n of r[t]){const[t,r]=c(n.name,n.type,e[n.name]);a.push(t),u.push(r)}}else for(const i of r[t]){let t=e[i.name];if(t!==undefined)if("bytes"===i.type)a.push("bytes32"),t=n.keccak(t),u.push(t);else if("string"===i.type)a.push("bytes32"),"string"==typeof t&&(t=o.from(t,"utf8")),t=n.keccak(t),u.push(t);else if(r[i.type]!==undefined)a.push("bytes32"),t=n.keccak(this.encodeData(i.type,t,r,s)),u.push(t);else{if(i.type.lastIndexOf("]")===i.type.length-1)throw new Error("Arrays currently unimplemented in encodeData");a.push(i.type),u.push(t)}}return i.rawEncode(a,u)},encodeType(t,e){let r="",n=this.findTypeDependencies(t,e).filter((e=>e!==t));n=[t].concat(n.sort());for(const t of n){if(!e[t])throw new Error("No type definition specified: "+t);r+=t+"("+e[t].map((({name:t,type:e})=>e+" "+t)).join(",")+")"}return r},findTypeDependencies(t,e,r=[]){if(t=t.match(/^\w*/)[0],r.includes(t)||e[t]===undefined)return r;r.push(t);for(const n of e[t])for(const t of this.findTypeDependencies(n.type,e,r))!r.includes(t)&&r.push(t);return r},hashStruct(t,e,r,i=!0){return n.keccak(this.encodeData(t,e,r,i))},hashType(t,e){return n.keccak(this.encodeType(t,e))},sanitizeData(t){const e={};for(const r in s.properties)t[r]&&(e[r]=t[r]);return e.types&&(e.types=Object.assign({EIP712Domain:[]},e.types)),e},hash(t,e=!0){const r=this.sanitizeData(t),i=[o.from("1901","hex")];return i.push(this.hashStruct("EIP712Domain",r.domain,r.types,e)),"EIP712Domain"!==r.primaryType&&i.push(this.hashStruct(r.primaryType,r.message,r.types,e)),n.keccak(o.concat(i))}};e.exports={TYPED_MESSAGE_SCHEMA:s,TypedDataUtils:a,hashForSignTypedDataLegacy:function(t){return function(t){const e=new Error("Expect argument to be non-empty array");if("object"!=typeof t||!t.length)throw e;const r=t.map((function(t){return"bytes"===t.type?n.toBuffer(t.value):t.value})),o=t.map((function(t){return t.type})),s=t.map((function(t){if(!t.name)throw e;return t.type+" "+t.name}));return i.soliditySHA3(["bytes32","bytes32"],[i.soliditySHA3(new Array(t.length).fill("string"),s),i.soliditySHA3(o,r)])}(t.data)},hashForSignTypedData_v3:function(t){return a.hash(t.data,!1)},hashForSignTypedData_v4:function(t){return a.hash(t.data)}}}}},{package:"eth-lattice-keyring>gridplus-sdk>eth-eip712-util-browser"}],[2737,{buffer:2437},function(){with(this)return function(){"use strict";return function(t,e,r){!function(e,r){function n(t,e){if(!t)throw new Error(e||"Assertion failed")}function i(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}function o(t,e,r){if(o.isBN(t))return t;this.negative=0,this.words=null,this.length=0,this.red=null,null!==t&&("le"!==e&&"be"!==e||(r=e,e=10),this._init(t||0,e||10,r||"be"))}var s;"object"==typeof e?e.exports=o:r.BN=o,o.BN=o,o.wordSize=26;try{s="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:t("buffer").Buffer}catch(t){}function a(t,e){var r=t.charCodeAt(e);return r>=48&&r<=57?r-48:r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:void n(!1,"Invalid character in "+t)}function u(t,e,r){var n=a(t,r);return r-1>=e&&(n|=a(t,r-1)<<4),n}function c(t,e,r,i){for(var o=0,s=0,a=Math.min(t.length,r),u=e;u<a;u++){var c=t.charCodeAt(u)-48;o*=i,s=c>=49?c-49+10:c>=17?c-17+10:c,n(c>=0&&s<i,"Invalid character"),o+=s}return o}function h(t,e){t.words=e.words,t.length=e.length,t.negative=e.negative,t.red=e.red}if(o.isBN=function(t){return t instanceof o||null!==t&&"object"==typeof t&&t.constructor.wordSize===o.wordSize&&Array.isArray(t.words)},o.max=function(t,e){return t.cmp(e)>0?t:e},o.min=function(t,e){return t.cmp(e)<0?t:e},o.prototype._init=function(t,e,r){if("number"==typeof t)return this._initNumber(t,e,r);if("object"==typeof t)return this._initArray(t,e,r);"hex"===e&&(e=16),n(e===(0|e)&&e>=2&&e<=36);var i=0;"-"===(t=t.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<t.length&&(16===e?this._parseHex(t,i,r):(this._parseBase(t,e,i),"le"===r&&this._initArray(this.toArray(),e,r)))},o.prototype._initNumber=function(t,e,r){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(n(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),e,r)},o.prototype._initArray=function(t,e,r){if(n("number"==typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var o,s,a=0;if("be"===r)for(i=t.length-1,o=0;i>=0;i-=3)s=t[i]|t[i-1]<<8|t[i-2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);else if("le"===r)for(i=0,o=0;i<t.length;i+=3)s=t[i]|t[i+1]<<8|t[i+2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);return this._strip()},o.prototype._parseHex=function(t,e,r){this.length=Math.ceil((t.length-e)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,o=0,s=0;if("be"===r)for(n=t.length-1;n>=e;n-=2)i=u(t,e,n)<<o,this.words[s]|=67108863&i,o>=18?(o-=18,s+=1,this.words[s]|=i>>>26):o+=8;else for(n=(t.length-e)%2==0?e+1:e;n<t.length;n+=2)i=u(t,e,n)<<o,this.words[s]|=67108863&i,o>=18?(o-=18,s+=1,this.words[s]|=i>>>26):o+=8;this._strip()},o.prototype._parseBase=function(t,e,r){this.words=[0],this.length=1;for(var n=0,i=1;i<=67108863;i*=e)n++;n--,i=i/e|0;for(var o=t.length-r,s=o%n,a=Math.min(o,o-s)+r,u=0,h=r;h<a;h+=n)u=c(t,h,h+n,e),this.imuln(i),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u);if(0!==s){var f=1;for(u=c(t,h,t.length,e),h=0;h<s;h++)f*=e;this.imuln(f),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u)}this._strip()},o.prototype.copy=function(t){t.words=new Array(this.length);for(var e=0;e<this.length;e++)t.words[e]=this.words[e];t.length=this.length,t.negative=this.negative,t.red=this.red},o.prototype._move=function(t){h(t,this)},o.prototype.clone=function(){var t=new o(null);return this.copy(t),t},o.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},o.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},o.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{o.prototype[Symbol.for("nodejs.util.inspect.custom")]=f}catch(t){o.prototype.inspect=f}else o.prototype.inspect=f;function f(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],d=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];o.prototype.toString=function(t,e){var r;if(e=0|e||1,16===(t=t||10)||"hex"===t){r="";for(var i=0,o=0,s=0;s<this.length;s++){var a=this.words[s],u=(16777215&(a<<i|o)).toString(16);o=a>>>24-i&16777215,(i+=2)>=26&&(i-=26,s--),r=0!==o||s!==this.length-1?l[6-u.length]+u+r:u+r}for(0!==o&&(r=o.toString(16)+r);r.length%e!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(t===(0|t)&&t>=2&&t<=36){var c=d[t],h=p[t];r="";var f=this.clone();for(f.negative=0;!f.isZero();){var m=f.modrn(h).toString(t);r=(f=f.idivn(h)).isZero()?m+r:l[c-m.length]+m+r}for(this.isZero()&&(r="0"+r);r.length%e!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},o.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},o.prototype.toJSON=function(){return this.toString(16,2)},s&&(o.prototype.toBuffer=function(t,e){return this.toArrayLike(s,t,e)}),o.prototype.toArray=function(t,e){return this.toArrayLike(Array,t,e)};function m(t,e,r){r.negative=e.negative^t.negative;var n=t.length+e.length|0;r.length=n,n=n-1|0;var i=0|t.words[0],o=0|e.words[0],s=i*o,a=67108863&s,u=s/67108864|0;r.words[0]=a;for(var c=1;c<n;c++){for(var h=u>>>26,f=67108863&u,l=Math.min(c,e.length-1),d=Math.max(0,c-t.length+1);d<=l;d++){var p=c-d|0;h+=(s=(i=0|t.words[p])*(o=0|e.words[d])+f)/67108864|0,f=67108863&s}r.words[c]=0|f,u=0|h}return 0!==u?r.words[c]=0|u:r.length--,r._strip()}o.prototype.toArrayLike=function(t,e,r){this._strip();var i=this.byteLength(),o=r||Math.max(1,i);n(i<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0");var s=function(t,e){return t.allocUnsafe?t.allocUnsafe(e):new t(e)}(t,o);return this["_toArrayLike"+("le"===e?"LE":"BE")](s,i),s},o.prototype._toArrayLikeLE=function(t,e){for(var r=0,n=0,i=0,o=0;i<this.length;i++){var s=this.words[i]<<o|n;t[r++]=255&s,r<t.length&&(t[r++]=s>>8&255),r<t.length&&(t[r++]=s>>16&255),6===o?(r<t.length&&(t[r++]=s>>24&255),n=0,o=0):(n=s>>>24,o+=2)}if(r<t.length)for(t[r++]=n;r<t.length;)t[r++]=0},o.prototype._toArrayLikeBE=function(t,e){for(var r=t.length-1,n=0,i=0,o=0;i<this.length;i++){var s=this.words[i]<<o|n;t[r--]=255&s,r>=0&&(t[r--]=s>>8&255),r>=0&&(t[r--]=s>>16&255),6===o?(r>=0&&(t[r--]=s>>24&255),n=0,o=0):(n=s>>>24,o+=2)}if(r>=0)for(t[r--]=n;r>=0;)t[r--]=0},Math.clz32?o.prototype._countBits=function(t){return 32-Math.clz32(t)}:o.prototype._countBits=function(t){var e=t,r=0;return e>=4096&&(r+=13,e>>>=13),e>=64&&(r+=7,e>>>=7),e>=8&&(r+=4,e>>>=4),e>=2&&(r+=2,e>>>=2),r+e},o.prototype._zeroBits=function(t){if(0===t)return 26;var e=t,r=0;return 0==(8191&e)&&(r+=13,e>>>=13),0==(127&e)&&(r+=7,e>>>=7),0==(15&e)&&(r+=4,e>>>=4),0==(3&e)&&(r+=2,e>>>=2),0==(1&e)&&r++,r},o.prototype.bitLength=function(){var t=this.words[this.length-1],e=this._countBits(t);return 26*(this.length-1)+e},o.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,e=0;e<this.length;e++){var r=this._zeroBits(this.words[e]);if(t+=r,26!==r)break}return t},o.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},o.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},o.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},o.prototype.isNeg=function(){return 0!==this.negative},o.prototype.neg=function(){return this.clone().ineg()},o.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},o.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var e=0;e<t.length;e++)this.words[e]=this.words[e]|t.words[e];return this._strip()},o.prototype.ior=function(t){return n(0==(this.negative|t.negative)),this.iuor(t)},o.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},o.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},o.prototype.iuand=function(t){var e;e=this.length>t.length?t:this;for(var r=0;r<e.length;r++)this.words[r]=this.words[r]&t.words[r];return this.length=e.length,this._strip()},o.prototype.iand=function(t){return n(0==(this.negative|t.negative)),this.iuand(t)},o.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},o.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},o.prototype.iuxor=function(t){var e,r;this.length>t.length?(e=this,r=t):(e=t,r=this);for(var n=0;n<r.length;n++)this.words[n]=e.words[n]^r.words[n];if(this!==e)for(;n<e.length;n++)this.words[n]=e.words[n];return this.length=e.length,this._strip()},o.prototype.ixor=function(t){return n(0==(this.negative|t.negative)),this.iuxor(t)},o.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},o.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},o.prototype.inotn=function(t){n("number"==typeof t&&t>=0);var e=0|Math.ceil(t/26),r=t%26;this._expand(e),r>0&&e--;for(var i=0;i<e;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this._strip()},o.prototype.notn=function(t){return this.clone().inotn(t)},o.prototype.setn=function(t,e){n("number"==typeof t&&t>=0);var r=t/26|0,i=t%26;return this._expand(r+1),this.words[r]=e?this.words[r]|1<<i:this.words[r]&~(1<<i),this._strip()},o.prototype.iadd=function(t){var e,r,n;if(0!==this.negative&&0===t.negative)return this.negative=0,e=this.isub(t),this.negative^=1,this._normSign();if(0===this.negative&&0!==t.negative)return t.negative=0,e=this.isub(t),t.negative=1,e._normSign();this.length>t.length?(r=this,n=t):(r=t,n=this);for(var i=0,o=0;o<n.length;o++)e=(0|r.words[o])+(0|n.words[o])+i,this.words[o]=67108863&e,i=e>>>26;for(;0!==i&&o<r.length;o++)e=(0|r.words[o])+i,this.words[o]=67108863&e,i=e>>>26;if(this.length=r.length,0!==i)this.words[this.length]=i,this.length++;else if(r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this},o.prototype.add=function(t){var e;return 0!==t.negative&&0===this.negative?(t.negative=0,e=this.sub(t),t.negative^=1,e):0===t.negative&&0!==this.negative?(this.negative=0,e=t.sub(this),this.negative=1,e):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},o.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var e=this.iadd(t);return t.negative=1,e._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var r,n,i=this.cmp(t);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(r=this,n=t):(r=t,n=this);for(var o=0,s=0;s<n.length;s++)o=(e=(0|r.words[s])-(0|n.words[s])+o)>>26,this.words[s]=67108863&e;for(;0!==o&&s<r.length;s++)o=(e=(0|r.words[s])+o)>>26,this.words[s]=67108863&e;if(0===o&&s<r.length&&r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this.length=Math.max(this.length,s),r!==this&&(this.negative=1),this._strip()},o.prototype.sub=function(t){return this.clone().isub(t)};var g=function(t,e,r){var n,i,o,s=t.words,a=e.words,u=r.words,c=0,h=0|s[0],f=8191&h,l=h>>>13,d=0|s[1],p=8191&d,m=d>>>13,g=0|s[2],y=8191&g,v=g>>>13,w=0|s[3],b=8191&w,_=w>>>13,E=0|s[4],x=8191&E,T=E>>>13,k=0|s[5],S=8191&k,A=k>>>13,M=0|s[6],P=8191&M,I=M>>>13,B=0|s[7],C=8191&B,O=B>>>13,R=0|s[8],N=8191&R,L=R>>>13,j=0|s[9],F=8191&j,D=j>>>13,U=0|a[0],K=8191&U,H=U>>>13,G=0|a[1],q=8191&G,V=G>>>13,z=0|a[2],W=8191&z,$=z>>>13,Y=0|a[3],Z=8191&Y,J=Y>>>13,X=0|a[4],Q=8191&X,tt=X>>>13,et=0|a[5],rt=8191&et,nt=et>>>13,it=0|a[6],ot=8191&it,st=it>>>13,at=0|a[7],ut=8191&at,ct=at>>>13,ht=0|a[8],ft=8191&ht,lt=ht>>>13,dt=0|a[9],pt=8191&dt,mt=dt>>>13;r.negative=t.negative^e.negative,r.length=19;var gt=(c+(n=Math.imul(f,K))|0)+((8191&(i=(i=Math.imul(f,H))+Math.imul(l,K)|0))<<13)|0;c=((o=Math.imul(l,H))+(i>>>13)|0)+(gt>>>26)|0,gt&=67108863,n=Math.imul(p,K),i=(i=Math.imul(p,H))+Math.imul(m,K)|0,o=Math.imul(m,H);var yt=(c+(n=n+Math.imul(f,q)|0)|0)+((8191&(i=(i=i+Math.imul(f,V)|0)+Math.imul(l,q)|0))<<13)|0;c=((o=o+Math.imul(l,V)|0)+(i>>>13)|0)+(yt>>>26)|0,yt&=67108863,n=Math.imul(y,K),i=(i=Math.imul(y,H))+Math.imul(v,K)|0,o=Math.imul(v,H),n=n+Math.imul(p,q)|0,i=(i=i+Math.imul(p,V)|0)+Math.imul(m,q)|0,o=o+Math.imul(m,V)|0;var vt=(c+(n=n+Math.imul(f,W)|0)|0)+((8191&(i=(i=i+Math.imul(f,$)|0)+Math.imul(l,W)|0))<<13)|0;c=((o=o+Math.imul(l,$)|0)+(i>>>13)|0)+(vt>>>26)|0,vt&=67108863,n=Math.imul(b,K),i=(i=Math.imul(b,H))+Math.imul(_,K)|0,o=Math.imul(_,H),n=n+Math.imul(y,q)|0,i=(i=i+Math.imul(y,V)|0)+Math.imul(v,q)|0,o=o+Math.imul(v,V)|0,n=n+Math.imul(p,W)|0,i=(i=i+Math.imul(p,$)|0)+Math.imul(m,W)|0,o=o+Math.imul(m,$)|0;var wt=(c+(n=n+Math.imul(f,Z)|0)|0)+((8191&(i=(i=i+Math.imul(f,J)|0)+Math.imul(l,Z)|0))<<13)|0;c=((o=o+Math.imul(l,J)|0)+(i>>>13)|0)+(wt>>>26)|0,wt&=67108863,n=Math.imul(x,K),i=(i=Math.imul(x,H))+Math.imul(T,K)|0,o=Math.imul(T,H),n=n+Math.imul(b,q)|0,i=(i=i+Math.imul(b,V)|0)+Math.imul(_,q)|0,o=o+Math.imul(_,V)|0,n=n+Math.imul(y,W)|0,i=(i=i+Math.imul(y,$)|0)+Math.imul(v,W)|0,o=o+Math.imul(v,$)|0,n=n+Math.imul(p,Z)|0,i=(i=i+Math.imul(p,J)|0)+Math.imul(m,Z)|0,o=o+Math.imul(m,J)|0;var bt=(c+(n=n+Math.imul(f,Q)|0)|0)+((8191&(i=(i=i+Math.imul(f,tt)|0)+Math.imul(l,Q)|0))<<13)|0;c=((o=o+Math.imul(l,tt)|0)+(i>>>13)|0)+(bt>>>26)|0,bt&=67108863,n=Math.imul(S,K),i=(i=Math.imul(S,H))+Math.imul(A,K)|0,o=Math.imul(A,H),n=n+Math.imul(x,q)|0,i=(i=i+Math.imul(x,V)|0)+Math.imul(T,q)|0,o=o+Math.imul(T,V)|0,n=n+Math.imul(b,W)|0,i=(i=i+Math.imul(b,$)|0)+Math.imul(_,W)|0,o=o+Math.imul(_,$)|0,n=n+Math.imul(y,Z)|0,i=(i=i+Math.imul(y,J)|0)+Math.imul(v,Z)|0,o=o+Math.imul(v,J)|0,n=n+Math.imul(p,Q)|0,i=(i=i+Math.imul(p,tt)|0)+Math.imul(m,Q)|0,o=o+Math.imul(m,tt)|0;var _t=(c+(n=n+Math.imul(f,rt)|0)|0)+((8191&(i=(i=i+Math.imul(f,nt)|0)+Math.imul(l,rt)|0))<<13)|0;c=((o=o+Math.imul(l,nt)|0)+(i>>>13)|0)+(_t>>>26)|0,_t&=67108863,n=Math.imul(P,K),i=(i=Math.imul(P,H))+Math.imul(I,K)|0,o=Math.imul(I,H),n=n+Math.imul(S,q)|0,i=(i=i+Math.imul(S,V)|0)+Math.imul(A,q)|0,o=o+Math.imul(A,V)|0,n=n+Math.imul(x,W)|0,i=(i=i+Math.imul(x,$)|0)+Math.imul(T,W)|0,o=o+Math.imul(T,$)|0,n=n+Math.imul(b,Z)|0,i=(i=i+Math.imul(b,J)|0)+Math.imul(_,Z)|0,o=o+Math.imul(_,J)|0,n=n+Math.imul(y,Q)|0,i=(i=i+Math.imul(y,tt)|0)+Math.imul(v,Q)|0,o=o+Math.imul(v,tt)|0,n=n+Math.imul(p,rt)|0,i=(i=i+Math.imul(p,nt)|0)+Math.imul(m,rt)|0,o=o+Math.imul(m,nt)|0;var Et=(c+(n=n+Math.imul(f,ot)|0)|0)+((8191&(i=(i=i+Math.imul(f,st)|0)+Math.imul(l,ot)|0))<<13)|0;c=((o=o+Math.imul(l,st)|0)+(i>>>13)|0)+(Et>>>26)|0,Et&=67108863,n=Math.imul(C,K),i=(i=Math.imul(C,H))+Math.imul(O,K)|0,o=Math.imul(O,H),n=n+Math.imul(P,q)|0,i=(i=i+Math.imul(P,V)|0)+Math.imul(I,q)|0,o=o+Math.imul(I,V)|0,n=n+Math.imul(S,W)|0,i=(i=i+Math.imul(S,$)|0)+Math.imul(A,W)|0,o=o+Math.imul(A,$)|0,n=n+Math.imul(x,Z)|0,i=(i=i+Math.imul(x,J)|0)+Math.imul(T,Z)|0,o=o+Math.imul(T,J)|0,n=n+Math.imul(b,Q)|0,i=(i=i+Math.imul(b,tt)|0)+Math.imul(_,Q)|0,o=o+Math.imul(_,tt)|0,n=n+Math.imul(y,rt)|0,i=(i=i+Math.imul(y,nt)|0)+Math.imul(v,rt)|0,o=o+Math.imul(v,nt)|0,n=n+Math.imul(p,ot)|0,i=(i=i+Math.imul(p,st)|0)+Math.imul(m,ot)|0,o=o+Math.imul(m,st)|0;var xt=(c+(n=n+Math.imul(f,ut)|0)|0)+((8191&(i=(i=i+Math.imul(f,ct)|0)+Math.imul(l,ut)|0))<<13)|0;c=((o=o+Math.imul(l,ct)|0)+(i>>>13)|0)+(xt>>>26)|0,xt&=67108863,n=Math.imul(N,K),i=(i=Math.imul(N,H))+Math.imul(L,K)|0,o=Math.imul(L,H),n=n+Math.imul(C,q)|0,i=(i=i+Math.imul(C,V)|0)+Math.imul(O,q)|0,o=o+Math.imul(O,V)|0,n=n+Math.imul(P,W)|0,i=(i=i+Math.imul(P,$)|0)+Math.imul(I,W)|0,o=o+Math.imul(I,$)|0,n=n+Math.imul(S,Z)|0,i=(i=i+Math.imul(S,J)|0)+Math.imul(A,Z)|0,o=o+Math.imul(A,J)|0,n=n+Math.imul(x,Q)|0,i=(i=i+Math.imul(x,tt)|0)+Math.imul(T,Q)|0,o=o+Math.imul(T,tt)|0,n=n+Math.imul(b,rt)|0,i=(i=i+Math.imul(b,nt)|0)+Math.imul(_,rt)|0,o=o+Math.imul(_,nt)|0,n=n+Math.imul(y,ot)|0,i=(i=i+Math.imul(y,st)|0)+Math.imul(v,ot)|0,o=o+Math.imul(v,st)|0,n=n+Math.imul(p,ut)|0,i=(i=i+Math.imul(p,ct)|0)+Math.imul(m,ut)|0,o=o+Math.imul(m,ct)|0;var Tt=(c+(n=n+Math.imul(f,ft)|0)|0)+((8191&(i=(i=i+Math.imul(f,lt)|0)+Math.imul(l,ft)|0))<<13)|0;c=((o=o+Math.imul(l,lt)|0)+(i>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,n=Math.imul(F,K),i=(i=Math.imul(F,H))+Math.imul(D,K)|0,o=Math.imul(D,H),n=n+Math.imul(N,q)|0,i=(i=i+Math.imul(N,V)|0)+Math.imul(L,q)|0,o=o+Math.imul(L,V)|0,n=n+Math.imul(C,W)|0,i=(i=i+Math.imul(C,$)|0)+Math.imul(O,W)|0,o=o+Math.imul(O,$)|0,n=n+Math.imul(P,Z)|0,i=(i=i+Math.imul(P,J)|0)+Math.imul(I,Z)|0,o=o+Math.imul(I,J)|0,n=n+Math.imul(S,Q)|0,i=(i=i+Math.imul(S,tt)|0)+Math.imul(A,Q)|0,o=o+Math.imul(A,tt)|0,n=n+Math.imul(x,rt)|0,i=(i=i+Math.imul(x,nt)|0)+Math.imul(T,rt)|0,o=o+Math.imul(T,nt)|0,n=n+Math.imul(b,ot)|0,i=(i=i+Math.imul(b,st)|0)+Math.imul(_,ot)|0,o=o+Math.imul(_,st)|0,n=n+Math.imul(y,ut)|0,i=(i=i+Math.imul(y,ct)|0)+Math.imul(v,ut)|0,o=o+Math.imul(v,ct)|0,n=n+Math.imul(p,ft)|0,i=(i=i+Math.imul(p,lt)|0)+Math.imul(m,ft)|0,o=o+Math.imul(m,lt)|0;var kt=(c+(n=n+Math.imul(f,pt)|0)|0)+((8191&(i=(i=i+Math.imul(f,mt)|0)+Math.imul(l,pt)|0))<<13)|0;c=((o=o+Math.imul(l,mt)|0)+(i>>>13)|0)+(kt>>>26)|0,kt&=67108863,n=Math.imul(F,q),i=(i=Math.imul(F,V))+Math.imul(D,q)|0,o=Math.imul(D,V),n=n+Math.imul(N,W)|0,i=(i=i+Math.imul(N,$)|0)+Math.imul(L,W)|0,o=o+Math.imul(L,$)|0,n=n+Math.imul(C,Z)|0,i=(i=i+Math.imul(C,J)|0)+Math.imul(O,Z)|0,o=o+Math.imul(O,J)|0,n=n+Math.imul(P,Q)|0,i=(i=i+Math.imul(P,tt)|0)+Math.imul(I,Q)|0,o=o+Math.imul(I,tt)|0,n=n+Math.imul(S,rt)|0,i=(i=i+Math.imul(S,nt)|0)+Math.imul(A,rt)|0,o=o+Math.imul(A,nt)|0,n=n+Math.imul(x,ot)|0,i=(i=i+Math.imul(x,st)|0)+Math.imul(T,ot)|0,o=o+Math.imul(T,st)|0,n=n+Math.imul(b,ut)|0,i=(i=i+Math.imul(b,ct)|0)+Math.imul(_,ut)|0,o=o+Math.imul(_,ct)|0,n=n+Math.imul(y,ft)|0,i=(i=i+Math.imul(y,lt)|0)+Math.imul(v,ft)|0,o=o+Math.imul(v,lt)|0;var St=(c+(n=n+Math.imul(p,pt)|0)|0)+((8191&(i=(i=i+Math.imul(p,mt)|0)+Math.imul(m,pt)|0))<<13)|0;c=((o=o+Math.imul(m,mt)|0)+(i>>>13)|0)+(St>>>26)|0,St&=67108863,n=Math.imul(F,W),i=(i=Math.imul(F,$))+Math.imul(D,W)|0,o=Math.imul(D,$),n=n+Math.imul(N,Z)|0,i=(i=i+Math.imul(N,J)|0)+Math.imul(L,Z)|0,o=o+Math.imul(L,J)|0,n=n+Math.imul(C,Q)|0,i=(i=i+Math.imul(C,tt)|0)+Math.imul(O,Q)|0,o=o+Math.imul(O,tt)|0,n=n+Math.imul(P,rt)|0,i=(i=i+Math.imul(P,nt)|0)+Math.imul(I,rt)|0,o=o+Math.imul(I,nt)|0,n=n+Math.imul(S,ot)|0,i=(i=i+Math.imul(S,st)|0)+Math.imul(A,ot)|0,o=o+Math.imul(A,st)|0,n=n+Math.imul(x,ut)|0,i=(i=i+Math.imul(x,ct)|0)+Math.imul(T,ut)|0,o=o+Math.imul(T,ct)|0,n=n+Math.imul(b,ft)|0,i=(i=i+Math.imul(b,lt)|0)+Math.imul(_,ft)|0,o=o+Math.imul(_,lt)|0;var At=(c+(n=n+Math.imul(y,pt)|0)|0)+((8191&(i=(i=i+Math.imul(y,mt)|0)+Math.imul(v,pt)|0))<<13)|0;c=((o=o+Math.imul(v,mt)|0)+(i>>>13)|0)+(At>>>26)|0,At&=67108863,n=Math.imul(F,Z),i=(i=Math.imul(F,J))+Math.imul(D,Z)|0,o=Math.imul(D,J),n=n+Math.imul(N,Q)|0,i=(i=i+Math.imul(N,tt)|0)+Math.imul(L,Q)|0,o=o+Math.imul(L,tt)|0,n=n+Math.imul(C,rt)|0,i=(i=i+Math.imul(C,nt)|0)+Math.imul(O,rt)|0,o=o+Math.imul(O,nt)|0,n=n+Math.imul(P,ot)|0,i=(i=i+Math.imul(P,st)|0)+Math.imul(I,ot)|0,o=o+Math.imul(I,st)|0,n=n+Math.imul(S,ut)|0,i=(i=i+Math.imul(S,ct)|0)+Math.imul(A,ut)|0,o=o+Math.imul(A,ct)|0,n=n+Math.imul(x,ft)|0,i=(i=i+Math.imul(x,lt)|0)+Math.imul(T,ft)|0,o=o+Math.imul(T,lt)|0;var Mt=(c+(n=n+Math.imul(b,pt)|0)|0)+((8191&(i=(i=i+Math.imul(b,mt)|0)+Math.imul(_,pt)|0))<<13)|0;c=((o=o+Math.imul(_,mt)|0)+(i>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,n=Math.imul(F,Q),i=(i=Math.imul(F,tt))+Math.imul(D,Q)|0,o=Math.imul(D,tt),n=n+Math.imul(N,rt)|0,i=(i=i+Math.imul(N,nt)|0)+Math.imul(L,rt)|0,o=o+Math.imul(L,nt)|0,n=n+Math.imul(C,ot)|0,i=(i=i+Math.imul(C,st)|0)+Math.imul(O,ot)|0,o=o+Math.imul(O,st)|0,n=n+Math.imul(P,ut)|0,i=(i=i+Math.imul(P,ct)|0)+Math.imul(I,ut)|0,o=o+Math.imul(I,ct)|0,n=n+Math.imul(S,ft)|0,i=(i=i+Math.imul(S,lt)|0)+Math.imul(A,ft)|0,o=o+Math.imul(A,lt)|0;var Pt=(c+(n=n+Math.imul(x,pt)|0)|0)+((8191&(i=(i=i+Math.imul(x,mt)|0)+Math.imul(T,pt)|0))<<13)|0;c=((o=o+Math.imul(T,mt)|0)+(i>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,n=Math.imul(F,rt),i=(i=Math.imul(F,nt))+Math.imul(D,rt)|0,o=Math.imul(D,nt),n=n+Math.imul(N,ot)|0,i=(i=i+Math.imul(N,st)|0)+Math.imul(L,ot)|0,o=o+Math.imul(L,st)|0,n=n+Math.imul(C,ut)|0,i=(i=i+Math.imul(C,ct)|0)+Math.imul(O,ut)|0,o=o+Math.imul(O,ct)|0,n=n+Math.imul(P,ft)|0,i=(i=i+Math.imul(P,lt)|0)+Math.imul(I,ft)|0,o=o+Math.imul(I,lt)|0;var It=(c+(n=n+Math.imul(S,pt)|0)|0)+((8191&(i=(i=i+Math.imul(S,mt)|0)+Math.imul(A,pt)|0))<<13)|0;c=((o=o+Math.imul(A,mt)|0)+(i>>>13)|0)+(It>>>26)|0,It&=67108863,n=Math.imul(F,ot),i=(i=Math.imul(F,st))+Math.imul(D,ot)|0,o=Math.imul(D,st),n=n+Math.imul(N,ut)|0,i=(i=i+Math.imul(N,ct)|0)+Math.imul(L,ut)|0,o=o+Math.imul(L,ct)|0,n=n+Math.imul(C,ft)|0,i=(i=i+Math.imul(C,lt)|0)+Math.imul(O,ft)|0,o=o+Math.imul(O,lt)|0;var Bt=(c+(n=n+Math.imul(P,pt)|0)|0)+((8191&(i=(i=i+Math.imul(P,mt)|0)+Math.imul(I,pt)|0))<<13)|0;c=((o=o+Math.imul(I,mt)|0)+(i>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,n=Math.imul(F,ut),i=(i=Math.imul(F,ct))+Math.imul(D,ut)|0,o=Math.imul(D,ct),n=n+Math.imul(N,ft)|0,i=(i=i+Math.imul(N,lt)|0)+Math.imul(L,ft)|0,o=o+Math.imul(L,lt)|0;var Ct=(c+(n=n+Math.imul(C,pt)|0)|0)+((8191&(i=(i=i+Math.imul(C,mt)|0)+Math.imul(O,pt)|0))<<13)|0;c=((o=o+Math.imul(O,mt)|0)+(i>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,n=Math.imul(F,ft),i=(i=Math.imul(F,lt))+Math.imul(D,ft)|0,o=Math.imul(D,lt);var Ot=(c+(n=n+Math.imul(N,pt)|0)|0)+((8191&(i=(i=i+Math.imul(N,mt)|0)+Math.imul(L,pt)|0))<<13)|0;c=((o=o+Math.imul(L,mt)|0)+(i>>>13)|0)+(Ot>>>26)|0,Ot&=67108863;var Rt=(c+(n=Math.imul(F,pt))|0)+((8191&(i=(i=Math.imul(F,mt))+Math.imul(D,pt)|0))<<13)|0;return c=((o=Math.imul(D,mt))+(i>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,u[0]=gt,u[1]=yt,u[2]=vt,u[3]=wt,u[4]=bt,u[5]=_t,u[6]=Et,u[7]=xt,u[8]=Tt,u[9]=kt,u[10]=St,u[11]=At,u[12]=Mt,u[13]=Pt,u[14]=It,u[15]=Bt,u[16]=Ct,u[17]=Ot,u[18]=Rt,0!==c&&(u[19]=c,r.length++),r};function y(t,e,r){r.negative=e.negative^t.negative,r.length=t.length+e.length;for(var n=0,i=0,o=0;o<r.length-1;o++){var s=i;i=0;for(var a=67108863&n,u=Math.min(o,e.length-1),c=Math.max(0,o-t.length+1);c<=u;c++){var h=o-c,f=(0|t.words[h])*(0|e.words[c]),l=67108863&f;a=67108863&(l=l+a|0),i+=(s=(s=s+(f/67108864|0)|0)+(l>>>26)|0)>>>26,s&=67108863}r.words[o]=a,n=s,s=i}return 0!==n?r.words[o]=n:r.length--,r._strip()}function v(t,e,r){return y(t,e,r)}function w(t,e){this.x=t,this.y=e}Math.imul||(g=m),o.prototype.mulTo=function(t,e){var r=this.length+t.length;return 10===this.length&&10===t.length?g(this,t,e):r<63?m(this,t,e):r<1024?y(this,t,e):v(this,t,e)},w.prototype.makeRBT=function(t){for(var e=new Array(t),r=o.prototype._countBits(t)-1,n=0;n<t;n++)e[n]=this.revBin(n,r,t);return e},w.prototype.revBin=function(t,e,r){if(0===t||t===r-1)return t;for(var n=0,i=0;i<e;i++)n|=(1&t)<<e-i-1,t>>=1;return n},w.prototype.permute=function(t,e,r,n,i,o){for(var s=0;s<o;s++)n[s]=e[t[s]],i[s]=r[t[s]]},w.prototype.transform=function(t,e,r,n,i,o){this.permute(o,t,e,r,n,i);for(var s=1;s<i;s<<=1)for(var a=s<<1,u=Math.cos(2*Math.PI/a),c=Math.sin(2*Math.PI/a),h=0;h<i;h+=a)for(var f=u,l=c,d=0;d<s;d++){var p=r[h+d],m=n[h+d],g=r[h+d+s],y=n[h+d+s],v=f*g-l*y;y=f*y+l*g,g=v,r[h+d]=p+g,n[h+d]=m+y,r[h+d+s]=p-g,n[h+d+s]=m-y,d!==a&&(v=u*f-c*l,l=u*l+c*f,f=v)}},w.prototype.guessLen13b=function(t,e){var r=1|Math.max(e,t),n=1&r,i=0;for(r=r/2|0;r;r>>>=1)i++;return 1<<i+1+n},w.prototype.conjugate=function(t,e,r){if(!(r<=1))for(var n=0;n<r/2;n++){var i=t[n];t[n]=t[r-n-1],t[r-n-1]=i,i=e[n],e[n]=-e[r-n-1],e[r-n-1]=-i}},w.prototype.normalize13b=function(t,e){for(var r=0,n=0;n<e/2;n++){var i=8192*Math.round(t[2*n+1]/e)+Math.round(t[2*n]/e)+r;t[n]=67108863&i,r=i<67108864?0:i/67108864|0}return t},w.prototype.convert13b=function(t,e,r,i){for(var o=0,s=0;s<e;s++)o+=0|t[s],r[2*s]=8191&o,o>>>=13,r[2*s+1]=8191&o,o>>>=13;for(s=2*e;s<i;++s)r[s]=0;n(0===o),n(0==(-8192&o))},w.prototype.stub=function(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=0;return e},w.prototype.mulp=function(t,e,r){var n=2*this.guessLen13b(t.length,e.length),i=this.makeRBT(n),o=this.stub(n),s=new Array(n),a=new Array(n),u=new Array(n),c=new Array(n),h=new Array(n),f=new Array(n),l=r.words;l.length=n,this.convert13b(t.words,t.length,s,n),this.convert13b(e.words,e.length,c,n),this.transform(s,o,a,u,n,i),this.transform(c,o,h,f,n,i);for(var d=0;d<n;d++){var p=a[d]*h[d]-u[d]*f[d];u[d]=a[d]*f[d]+u[d]*h[d],a[d]=p}return this.conjugate(a,u,n),this.transform(a,u,l,o,n,i),this.conjugate(l,o,n),this.normalize13b(l,n),r.negative=t.negative^e.negative,r.length=t.length+e.length,r._strip()},o.prototype.mul=function(t){var e=new o(null);return e.words=new Array(this.length+t.length),this.mulTo(t,e)},o.prototype.mulf=function(t){var e=new o(null);return e.words=new Array(this.length+t.length),v(this,t,e)},o.prototype.imul=function(t){return this.clone().mulTo(t,this)},o.prototype.imuln=function(t){var e=t<0;e&&(t=-t),n("number"==typeof t),n(t<67108864);for(var r=0,i=0;i<this.length;i++){var o=(0|this.words[i])*t,s=(67108863&o)+(67108863&r);r>>=26,r+=o/67108864|0,r+=s>>>26,this.words[i]=67108863&s}return 0!==r&&(this.words[i]=r,this.length++),e?this.ineg():this},o.prototype.muln=function(t){return this.clone().imuln(t)},o.prototype.sqr=function(){return this.mul(this)},o.prototype.isqr=function(){return this.imul(this.clone())},o.prototype.pow=function(t){var e=function(t){for(var e=new Array(t.bitLength()),r=0;r<e.length;r++){var n=r/26|0,i=r%26;e[r]=t.words[n]>>>i&1}return e}(t);if(0===e.length)return new o(1);for(var r=this,n=0;n<e.length&&0===e[n];n++,r=r.sqr());if(++n<e.length)for(var i=r.sqr();n<e.length;n++,i=i.sqr())0!==e[n]&&(r=r.mul(i));return r},o.prototype.iushln=function(t){n("number"==typeof t&&t>=0);var e,r=t%26,i=(t-r)/26,o=67108863>>>26-r<<26-r;if(0!==r){var s=0;for(e=0;e<this.length;e++){var a=this.words[e]&o,u=(0|this.words[e])-a<<r;this.words[e]=u|s,s=a>>>26-r}s&&(this.words[e]=s,this.length++)}if(0!==i){for(e=this.length-1;e>=0;e--)this.words[e+i]=this.words[e];for(e=0;e<i;e++)this.words[e]=0;this.length+=i}return this._strip()},o.prototype.ishln=function(t){return n(0===this.negative),this.iushln(t)},o.prototype.iushrn=function(t,e,r){var i;n("number"==typeof t&&t>=0),i=e?(e-e%26)/26:0;var o=t%26,s=Math.min((t-o)/26,this.length),a=67108863^67108863>>>o<<o,u=r;if(i-=s,i=Math.max(0,i),u){for(var c=0;c<s;c++)u.words[c]=this.words[c];u.length=s}if(0===s);else if(this.length>s)for(this.length-=s,c=0;c<this.length;c++)this.words[c]=this.words[c+s];else this.words[0]=0,this.length=1;var h=0;for(c=this.length-1;c>=0&&(0!==h||c>=i);c--){var f=0|this.words[c];this.words[c]=h<<26-o|f>>>o,h=f&a}return u&&0!==h&&(u.words[u.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},o.prototype.ishrn=function(t,e,r){return n(0===this.negative),this.iushrn(t,e,r)},o.prototype.shln=function(t){return this.clone().ishln(t)},o.prototype.ushln=function(t){return this.clone().iushln(t)},o.prototype.shrn=function(t){return this.clone().ishrn(t)},o.prototype.ushrn=function(t){return this.clone().iushrn(t)},o.prototype.testn=function(t){n("number"==typeof t&&t>=0);var e=t%26,r=(t-e)/26,i=1<<e;return!(this.length<=r)&&!!(this.words[r]&i)},o.prototype.imaskn=function(t){n("number"==typeof t&&t>=0);var e=t%26,r=(t-e)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==e&&r++,this.length=Math.min(r,this.length),0!==e){var i=67108863^67108863>>>e<<e;this.words[this.length-1]&=i}return this._strip()},o.prototype.maskn=function(t){return this.clone().imaskn(t)},o.prototype.iaddn=function(t){return n("number"==typeof t),n(t<67108864),t<0?this.isubn(-t):0!==this.negative?1===this.length&&(0|this.words[0])<=t?(this.words[0]=t-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},o.prototype._iaddn=function(t){this.words[0]+=t;for(var e=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,e===this.length-1?this.words[e+1]=1:this.words[e+1]++;return this.length=Math.max(this.length,e+1),this},o.prototype.isubn=function(t){if(n("number"==typeof t),n(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var e=0;e<this.length&&this.words[e]<0;e++)this.words[e]+=67108864,this.words[e+1]-=1;return this._strip()},o.prototype.addn=function(t){return this.clone().iaddn(t)},o.prototype.subn=function(t){return this.clone().isubn(t)},o.prototype.iabs=function(){return this.negative=0,this},o.prototype.abs=function(){return this.clone().iabs()},o.prototype._ishlnsubmul=function(t,e,r){var i,o,s=t.length+r;this._expand(s);var a=0;for(i=0;i<t.length;i++){o=(0|this.words[i+r])+a;var u=(0|t.words[i])*e;a=((o-=67108863&u)>>26)-(u/67108864|0),this.words[i+r]=67108863&o}for(;i<this.length-r;i++)a=(o=(0|this.words[i+r])+a)>>26,this.words[i+r]=67108863&o;if(0===a)return this._strip();for(n(-1===a),a=0,i=0;i<this.length;i++)a=(o=-(0|this.words[i])+a)>>26,this.words[i]=67108863&o;return this.negative=1,this._strip()},o.prototype._wordDiv=function(t,e){var r=(this.length,t.length),n=this.clone(),i=t,s=0|i.words[i.length-1];0!==(r=26-this._countBits(s))&&(i=i.ushln(r),n.iushln(r),s=0|i.words[i.length-1]);var a,u=n.length-i.length;if("mod"!==e){(a=new o(null)).length=u+1,a.words=new Array(a.length);for(var c=0;c<a.length;c++)a.words[c]=0}var h=n.clone()._ishlnsubmul(i,1,u);0===h.negative&&(n=h,a&&(a.words[u]=1));for(var f=u-1;f>=0;f--){var l=67108864*(0|n.words[i.length+f])+(0|n.words[i.length+f-1]);for(l=Math.min(l/s|0,67108863),n._ishlnsubmul(i,l,f);0!==n.negative;)l--,n.negative=0,n._ishlnsubmul(i,1,f),n.isZero()||(n.negative^=1);a&&(a.words[f]=l)}return a&&a._strip(),n._strip(),"div"!==e&&0!==r&&n.iushrn(r),{div:a||null,mod:n}},o.prototype.divmod=function(t,e,r){return n(!t.isZero()),this.isZero()?{div:new o(0),mod:new o(0)}:0!==this.negative&&0===t.negative?(a=this.neg().divmod(t,e),"mod"!==e&&(i=a.div.neg()),"div"!==e&&(s=a.mod.neg(),r&&0!==s.negative&&s.iadd(t)),{div:i,mod:s}):0===this.negative&&0!==t.negative?(a=this.divmod(t.neg(),e),"mod"!==e&&(i=a.div.neg()),{div:i,mod:a.mod}):0!=(this.negative&t.negative)?(a=this.neg().divmod(t.neg(),e),"div"!==e&&(s=a.mod.neg(),r&&0!==s.negative&&s.isub(t)),{div:a.div,mod:s}):t.length>this.length||this.cmp(t)<0?{div:new o(0),mod:this}:1===t.length?"div"===e?{div:this.divn(t.words[0]),mod:null}:"mod"===e?{div:null,mod:new o(this.modrn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new o(this.modrn(t.words[0]))}:this._wordDiv(t,e);var i,s,a},o.prototype.div=function(t){return this.divmod(t,"div",!1).div},o.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},o.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},o.prototype.divRound=function(t){var e=this.divmod(t);if(e.mod.isZero())return e.div;var r=0!==e.div.negative?e.mod.isub(t):e.mod,n=t.ushrn(1),i=t.andln(1),o=r.cmp(n);return o<0||1===i&&0===o?e.div:0!==e.div.negative?e.div.isubn(1):e.div.iaddn(1)},o.prototype.modrn=function(t){var e=t<0;e&&(t=-t),n(t<=67108863);for(var r=(1<<26)%t,i=0,o=this.length-1;o>=0;o--)i=(r*i+(0|this.words[o]))%t;return e?-i:i},o.prototype.modn=function(t){return this.modrn(t)},o.prototype.idivn=function(t){var e=t<0;e&&(t=-t),n(t<=67108863);for(var r=0,i=this.length-1;i>=0;i--){var o=(0|this.words[i])+67108864*r;this.words[i]=o/t|0,r=o%t}return this._strip(),e?this.ineg():this},o.prototype.divn=function(t){return this.clone().idivn(t)},o.prototype.egcd=function(t){n(0===t.negative),n(!t.isZero());var e=this,r=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var i=new o(1),s=new o(0),a=new o(0),u=new o(1),c=0;e.isEven()&&r.isEven();)e.iushrn(1),r.iushrn(1),++c;for(var h=r.clone(),f=e.clone();!e.isZero();){for(var l=0,d=1;0==(e.words[0]&d)&&l<26;++l,d<<=1);if(l>0)for(e.iushrn(l);l-- >0;)(i.isOdd()||s.isOdd())&&(i.iadd(h),s.isub(f)),i.iushrn(1),s.iushrn(1);for(var p=0,m=1;0==(r.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(a.isOdd()||u.isOdd())&&(a.iadd(h),u.isub(f)),a.iushrn(1),u.iushrn(1);e.cmp(r)>=0?(e.isub(r),i.isub(a),s.isub(u)):(r.isub(e),a.isub(i),u.isub(s))}return{a:a,b:u,gcd:r.iushln(c)}},o.prototype._invmp=function(t){n(0===t.negative),n(!t.isZero());var e=this,r=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var i,s=new o(1),a=new o(0),u=r.clone();e.cmpn(1)>0&&r.cmpn(1)>0;){for(var c=0,h=1;0==(e.words[0]&h)&&c<26;++c,h<<=1);if(c>0)for(e.iushrn(c);c-- >0;)s.isOdd()&&s.iadd(u),s.iushrn(1);for(var f=0,l=1;0==(r.words[0]&l)&&f<26;++f,l<<=1);if(f>0)for(r.iushrn(f);f-- >0;)a.isOdd()&&a.iadd(u),a.iushrn(1);e.cmp(r)>=0?(e.isub(r),s.isub(a)):(r.isub(e),a.isub(s))}return(i=0===e.cmpn(1)?s:a).cmpn(0)<0&&i.iadd(t),i},o.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var e=this.clone(),r=t.clone();e.negative=0,r.negative=0;for(var n=0;e.isEven()&&r.isEven();n++)e.iushrn(1),r.iushrn(1);for(;;){for(;e.isEven();)e.iushrn(1);for(;r.isEven();)r.iushrn(1);var i=e.cmp(r);if(i<0){var o=e;e=r,r=o}else if(0===i||0===r.cmpn(1))break;e.isub(r)}return r.iushln(n)},o.prototype.invm=function(t){return this.egcd(t).a.umod(t)},o.prototype.isEven=function(){return 0==(1&this.words[0])},o.prototype.isOdd=function(){return 1==(1&this.words[0])},o.prototype.andln=function(t){return this.words[0]&t},o.prototype.bincn=function(t){n("number"==typeof t);var e=t%26,r=(t-e)/26,i=1<<e;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var o=i,s=r;0!==o&&s<this.length;s++){var a=0|this.words[s];o=(a+=o)>>>26,a&=67108863,this.words[s]=a}return 0!==o&&(this.words[s]=o,this.length++),this},o.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},o.prototype.cmpn=function(t){var e,r=t<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this._strip(),this.length>1)e=1;else{r&&(t=-t),n(t<=67108863,"Number is too big");var i=0|this.words[0];e=i===t?0:i<t?-1:1}return 0!==this.negative?0|-e:e},o.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return-1;if(0===this.negative&&0!==t.negative)return 1;var e=this.ucmp(t);return 0!==this.negative?0|-e:e},o.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var e=0,r=this.length-1;r>=0;r--){var n=0|this.words[r],i=0|t.words[r];if(n!==i){n<i?e=-1:n>i&&(e=1);break}}return e},o.prototype.gtn=function(t){return 1===this.cmpn(t)},o.prototype.gt=function(t){return 1===this.cmp(t)},o.prototype.gten=function(t){return this.cmpn(t)>=0},o.prototype.gte=function(t){return this.cmp(t)>=0},o.prototype.ltn=function(t){return-1===this.cmpn(t)},o.prototype.lt=function(t){return-1===this.cmp(t)},o.prototype.lten=function(t){return this.cmpn(t)<=0},o.prototype.lte=function(t){return this.cmp(t)<=0},o.prototype.eqn=function(t){return 0===this.cmpn(t)},o.prototype.eq=function(t){return 0===this.cmp(t)},o.red=function(t){return new S(t)},o.prototype.toRed=function(t){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),t.convertTo(this)._forceRed(t)},o.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},o.prototype._forceRed=function(t){return this.red=t,this},o.prototype.forceRed=function(t){return n(!this.red,"Already a number in reduction context"),this._forceRed(t)},o.prototype.redAdd=function(t){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},o.prototype.redIAdd=function(t){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},o.prototype.redSub=function(t){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},o.prototype.redISub=function(t){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},o.prototype.redShl=function(t){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},o.prototype.redMul=function(t){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},o.prototype.redIMul=function(t){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},o.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},o.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},o.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},o.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},o.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},o.prototype.redPow=function(t){return n(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var b={k256:null,p224:null,p192:null,p25519:null};function _(t,e){this.name=t,this.p=new o(e,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function E(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function x(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function T(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function k(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(t){if("string"==typeof t){var e=o._prime(t);this.m=e.p,this.prime=e}else n(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function A(t){S.call(this,t),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var t=new o(null);return t.words=new Array(Math.ceil(this.n/13)),t},_.prototype.ireduce=function(t){var e,r=t;do{this.split(r,this.tmp),e=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(e>this.n);var n=e<this.n?-1:r.ucmp(this.p);return 0===n?(r.words[0]=0,r.length=1):n>0?r.isub(this.p):r.strip!==undefined?r.strip():r._strip(),r},_.prototype.split=function(t,e){t.iushrn(this.n,0,e)},_.prototype.imulK=function(t){return t.imul(this.k)},i(E,_),E.prototype.split=function(t,e){for(var r=4194303,n=Math.min(t.length,9),i=0;i<n;i++)e.words[i]=t.words[i];if(e.length=n,t.length<=9)return t.words[0]=0,void(t.length=1);var o=t.words[9];for(e.words[e.length++]=o&r,i=10;i<t.length;i++){var s=0|t.words[i];t.words[i-10]=(s&r)<<4|o>>>22,o=s}o>>>=22,t.words[i-10]=o,0===o&&t.length>10?t.length-=10:t.length-=9},E.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var e=0,r=0;r<t.length;r++){var n=0|t.words[r];e+=977*n,t.words[r]=67108863&e,e=64*n+(e/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},i(x,_),i(T,_),i(k,_),k.prototype.imulK=function(t){for(var e=0,r=0;r<t.length;r++){var n=19*(0|t.words[r])+e,i=67108863&n;n>>>=26,t.words[r]=i,e=n}return 0!==e&&(t.words[t.length++]=e),t},o._prime=function(t){if(b[t])return b[t];var e;if("k256"===t)e=new E;else if("p224"===t)e=new x;else if("p192"===t)e=new T;else{if("p25519"!==t)throw new Error("Unknown prime "+t);e=new k}return b[t]=e,e},S.prototype._verify1=function(t){n(0===t.negative,"red works only with positives"),n(t.red,"red works only with red numbers")},S.prototype._verify2=function(t,e){n(0==(t.negative|e.negative),"red works only with positives"),n(t.red&&t.red===e.red,"red works only with red numbers")},S.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):(h(t,t.umod(this.m)._forceRed(this)),t)},S.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},S.prototype.add=function(t,e){this._verify2(t,e);var r=t.add(e);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},S.prototype.iadd=function(t,e){this._verify2(t,e);var r=t.iadd(e);return r.cmp(this.m)>=0&&r.isub(this.m),r},S.prototype.sub=function(t,e){this._verify2(t,e);var r=t.sub(e);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},S.prototype.isub=function(t,e){this._verify2(t,e);var r=t.isub(e);return r.cmpn(0)<0&&r.iadd(this.m),r},S.prototype.shl=function(t,e){return this._verify1(t),this.imod(t.ushln(e))},S.prototype.imul=function(t,e){return this._verify2(t,e),this.imod(t.imul(e))},S.prototype.mul=function(t,e){return this._verify2(t,e),this.imod(t.mul(e))},S.prototype.isqr=function(t){return this.imul(t,t.clone())},S.prototype.sqr=function(t){return this.mul(t,t)},S.prototype.sqrt=function(t){if(t.isZero())return t.clone();var e=this.m.andln(3);if(n(e%2==1),3===e){var r=this.m.add(new o(1)).iushrn(2);return this.pow(t,r)}for(var i=this.m.subn(1),s=0;!i.isZero()&&0===i.andln(1);)s++,i.iushrn(1);n(!i.isZero());var a=new o(1).toRed(this),u=a.redNeg(),c=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new o(2*h*h).toRed(this);0!==this.pow(h,c).cmp(u);)h.redIAdd(u);for(var f=this.pow(h,i),l=this.pow(t,i.addn(1).iushrn(1)),d=this.pow(t,i),p=s;0!==d.cmp(a);){for(var m=d,g=0;0!==m.cmp(a);g++)m=m.redSqr();n(g<p);var y=this.pow(f,new o(1).iushln(p-g-1));l=l.redMul(y),f=y.redSqr(),d=d.redMul(f),p=g}return l},S.prototype.invm=function(t){var e=t._invmp(this.m);return 0!==e.negative?(e.negative=0,this.imod(e).redNeg()):this.imod(e)},S.prototype.pow=function(t,e){if(e.isZero())return new o(1).toRed(this);if(0===e.cmpn(1))return t.clone();var r=new Array(16);r[0]=new o(1).toRed(this),r[1]=t;for(var n=2;n<r.length;n++)r[n]=this.mul(r[n-1],t);var i=r[0],s=0,a=0,u=e.bitLength()%26;for(0===u&&(u=26),n=e.length-1;n>=0;n--){for(var c=e.words[n],h=u-1;h>=0;h--){var f=c>>h&1;i!==r[0]&&(i=this.sqr(i)),0!==f||0!==s?(s<<=1,s|=f,(4===++a||0===n&&0===h)&&(i=this.mul(i,r[s]),a=0,s=0)):a=0}u=26}return i},S.prototype.convertTo=function(t){var e=t.umod(this.m);return e===t?e.clone():e},S.prototype.convertFrom=function(t){var e=t.clone();return e.red=null,e},o.mont=function(t){return new A(t)},i(A,S),A.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},A.prototype.convertFrom=function(t){var e=this.imod(t.mul(this.rinv));return e.red=null,e},A.prototype.imul=function(t,e){if(t.isZero()||e.isZero())return t.words[0]=0,t.length=1,t;var r=t.imul(e),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},A.prototype.mul=function(t,e){if(t.isZero()||e.isZero())return new o(0)._forceRed(this);var r=t.mul(e),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),s=i;return i.cmp(this.m)>=0?s=i.isub(this.m):i.cmpn(0)<0&&(s=i.iadd(this.m)),s._forceRed(this)},A.prototype.invm=function(t){return this.imod(t._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===e||e,this)}}},{package:"eth-lattice-keyring>gridplus-sdk>eth-eip712-util-browser>bn.js"}],[2738,{"base64-js":2320,ieee754:5288},function(){with(this)return function(){"use strict";return function(t,e,r){const n=t("base64-js"),i=t("ieee754"),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=u,r.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},r.INSPECT_MAX_BYTES=50;const s=2147483647;function a(t){if(t>s)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,u.prototype),e}function u(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return f(t)}return c(t,e,r)}function c(t,e,r){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!u.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const r=0|m(t,e);let n=a(r);const i=n.write(t,e);i!==r&&(n=n.slice(0,i));return n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(Y(t,Uint8Array)){const e=new Uint8Array(t);return d(e.buffer,e.byteOffset,e.byteLength)}return l(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof t);if(Y(t,ArrayBuffer)||t&&Y(t.buffer,ArrayBuffer))return d(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(Y(t,SharedArrayBuffer)||t&&Y(t.buffer,SharedArrayBuffer)))return d(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return u.from(n,e,r);const i=function(t){if(u.isBuffer(t)){const e=0|p(t.length),r=a(e);return 0===r.length||t.copy(r,0,0,e),r}if(t.length!==undefined)return"number"!=typeof t.length||Z(t.length)?a(0):l(t);if("Buffer"===t.type&&Array.isArray(t.data))return l(t.data)}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return u.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof t)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function f(t){return h(t),a(t<0?0:0|p(t))}function l(t){const e=t.length<0?0:0|p(t.length),r=a(e);for(let n=0;n<e;n+=1)r[n]=255&t[n];return r}function d(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=e===undefined&&r===undefined?new Uint8Array(t):r===undefined?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,u.prototype),n}function p(t){if(t>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+s.toString(16)+" bytes");return 0|t}function m(t,e){if(u.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Y(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. '+"Received type "+typeof t);const r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return W(t).length;default:if(i)return n?-1:z(t).length;e=(""+e).toLowerCase(),i=!0}}function g(t,e,r){let n=!1;if((e===undefined||e<0)&&(e=0),e>this.length)return"";if((r===undefined||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return I(this,e,r);case"utf8":case"utf-8":return S(this,e,r);case"ascii":return M(this,e,r);case"latin1":case"binary":return P(this,e,r);case"base64":return k(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function y(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function v(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Z(r=+r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=u.from(e,n)),u.isBuffer(e))return 0===e.length?-1:w(t,e,r,n,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):w(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function w(t,e,r,n,i){let o,s=1,a=t.length,u=e.length;if(n!==undefined&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,r/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){let n=-1;for(o=r;o<a;o++)if(c(t,o)===c(e,-1===n?0:o-n)){if(-1===n&&(n=o),o-n+1===u)return n*s}else-1!==n&&(o-=o-n),n=-1}else for(r+u>a&&(r=a-u),o=r;o>=0;o--){let r=!0;for(let n=0;n<u;n++)if(c(t,o+n)!==c(e,n)){r=!1;break}if(r)return o}return-1}function b(t,e,r,n){r=Number(r)||0;const i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;const o=e.length;let s;for(n>o/2&&(n=o/2),s=0;s<n;++s){const n=parseInt(e.substr(2*s,2),16);if(Z(n))return s;t[r+s]=n}return s}function _(t,e,r,n){return $(z(e,t.length-r),t,r,n)}function E(t,e,r,n){return $(function(t){const e=[];for(let r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function x(t,e,r,n){return $(W(e),t,r,n)}function T(t,e,r,n){return $(function(t,e){let r,n,i;const o=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(e,t.length-r),t,r,n)}function k(t,e,r){return 0===e&&r===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,r))}function S(t,e,r){r=Math.min(t.length,r);const n=[];let i=e;for(;i<r;){const e=t[i];let o=null,s=e>239?4:e>223?3:e>191?2:1;if(i+s<=r){let r,n,a,u;switch(s){case 1:e<128&&(o=e);break;case 2:r=t[i+1],128==(192&r)&&(u=(31&e)<<6|63&r,u>127&&(o=u));break;case 3:r=t[i+1],n=t[i+2],128==(192&r)&&128==(192&n)&&(u=(15&e)<<12|(63&r)<<6|63&n,u>2047&&(u<55296||u>57343)&&(o=u));break;case 4:r=t[i+1],n=t[i+2],a=t[i+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(u=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&a,u>65535&&u<1114112&&(o=u))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),i+=s}return function(t){const e=t.length;if(e<=A)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=A));return r}(n)}r.kMaxLength=s,u.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),u.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by "+"`buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){return u.isBuffer(this)?this.buffer:undefined}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){return u.isBuffer(this)?this.byteOffset:undefined}}),u.poolSize=8192,u.from=function(t,e,r){return c(t,e,r)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array),u.alloc=function(t,e,r){return function(t,e,r){return h(t),t<=0?a(t):e!==undefined?"string"==typeof r?a(t).fill(e,r):a(t).fill(e):a(t)}(t,e,r)},u.allocUnsafe=function(t){return f(t)},u.allocUnsafeSlow=function(t){return f(t)},u.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==u.prototype},u.compare=function(t,e){if(Y(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),Y(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let r=t.length,n=e.length;for(let i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);let r;if(e===undefined)for(e=0,r=0;r<t.length;++r)e+=t[r].length;const n=u.allocUnsafe(e);let i=0;for(r=0;r<t.length;++r){let e=t[r];if(Y(e,Uint8Array))i+e.length>n.length?(u.isBuffer(e)||(e=u.from(e)),e.copy(n,i)):Uint8Array.prototype.set.call(n,e,i);else{if(!u.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(n,i)}i+=e.length}return n},u.byteLength=m,u.prototype._isBuffer=!0,u.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)y(this,e,e+1);return this},u.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},u.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},u.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?S(this,0,t):g.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){let t="";const e=r.INSPECT_MAX_BYTES;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},o&&(u.prototype[o]=u.prototype.inspect),u.prototype.compare=function(t,e,r,n,i){if(Y(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),!u.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. '+"Received type "+typeof t);if(e===undefined&&(e=0),r===undefined&&(r=t?t.length:0),n===undefined&&(n=0),i===undefined&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;let o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(e>>>=0);const a=Math.min(o,s),c=this.slice(n,i),h=t.slice(e,r);for(let t=0;t<a;++t)if(c[t]!==h[t]){o=c[t],s=h[t];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},u.prototype.indexOf=function(t,e,r){return v(this,t,e,r,!0)},u.prototype.lastIndexOf=function(t,e,r){return v(this,t,e,r,!1)},u.prototype.write=function(t,e,r,n){if(e===undefined)n="utf8",r=this.length,e=0;else if(r===undefined&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,n===undefined&&(n="utf8")):(n=r,r=undefined)}const i=this.length-e;if((r===undefined||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return b(this,t,e,r);case"utf8":case"utf-8":return _(this,t,e,r);case"ascii":case"latin1":case"binary":return E(this,t,e,r);case"base64":return x(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const A=4096;function M(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function P(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function I(t,e,r){const n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=e;n<r;++n)i+=J[t[n]];return i}function B(t,e,r){const n=t.slice(e,r);let i="";for(let t=0;t<n.length-1;t+=2)i+=String.fromCharCode(n[t]+256*n[t+1]);return i}function C(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function O(t,e,r,n,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function R(t,e,r,n,i){H(e,n,i,t,r,7);let o=Number(e&BigInt(4294967295));t[r++]=o,o>>=8,t[r++]=o,o>>=8,t[r++]=o,o>>=8,t[r++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=s,s>>=8,t[r++]=s,s>>=8,t[r++]=s,s>>=8,t[r++]=s,r}function N(t,e,r,n,i){H(e,n,i,t,r,7);let o=Number(e&BigInt(4294967295));t[r+7]=o,o>>=8,t[r+6]=o,o>>=8,t[r+5]=o,o>>=8,t[r+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=s,s>>=8,t[r+2]=s,s>>=8,t[r+1]=s,s>>=8,t[r]=s,r+8}function L(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function j(t,e,r,n,o){return e=+e,r>>>=0,o||L(t,0,r,4),i.write(t,e,r,n,23,4),r+4}function F(t,e,r,n,o){return e=+e,r>>>=0,o||L(t,0,r,8),i.write(t,e,r,n,52,8),r+8}u.prototype.slice=function(t,e){const r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=e===undefined?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);const n=this.subarray(t,e);return Object.setPrototypeOf(n,u.prototype),n},u.prototype.readUintLE=u.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||C(t,e,this.length);let n=this[t],i=1,o=0;for(;++o<e&&(i*=256);)n+=this[t+o]*i;return n},u.prototype.readUintBE=u.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||C(t,e,this.length);let n=this[t+--e],i=1;for(;e>0&&(i*=256);)n+=this[t+--e]*i;return n},u.prototype.readUint8=u.prototype.readUInt8=function(t,e){return t>>>=0,e||C(t,1,this.length),this[t]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(t,e){return t>>>=0,e||C(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(t,e){return t>>>=0,e||C(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(t,e){return t>>>=0,e||C(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(t,e){return t>>>=0,e||C(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readBigUInt64LE=X((function(t){G(t>>>=0,"offset");const e=this[t],r=this[t+7];e!==undefined&&r!==undefined||q(t,this.length-8);const n=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,i=this[++t]+256*this[++t]+65536*this[++t]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),u.prototype.readBigUInt64BE=X((function(t){G(t>>>=0,"offset");const e=this[t],r=this[t+7];e!==undefined&&r!==undefined||q(t,this.length-8);const n=e*2**24+65536*this[++t]+256*this[++t]+this[++t],i=this[++t]*2**24+65536*this[++t]+256*this[++t]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),u.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||C(t,e,this.length);let n=this[t],i=1,o=0;for(;++o<e&&(i*=256);)n+=this[t+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*e)),n},u.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||C(t,e,this.length);let n=e,i=1,o=this[t+--n];for(;n>0&&(i*=256);)o+=this[t+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return t>>>=0,e||C(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){t>>>=0,e||C(t,2,this.length);const r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(t,e){t>>>=0,e||C(t,2,this.length);const r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(t,e){return t>>>=0,e||C(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return t>>>=0,e||C(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readBigInt64LE=X((function(t){G(t>>>=0,"offset");const e=this[t],r=this[t+7];e!==undefined&&r!==undefined||q(t,this.length-8);const n=this[t+4]+256*this[t+5]+65536*this[t+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),u.prototype.readBigInt64BE=X((function(t){G(t>>>=0,"offset");const e=this[t],r=this[t+7];e!==undefined&&r!==undefined||q(t,this.length-8);const n=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(n)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+r)})),u.prototype.readFloatLE=function(t,e){return t>>>=0,e||C(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return t>>>=0,e||C(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return t>>>=0,e||C(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return t>>>=0,e||C(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUintLE=u.prototype.writeUIntLE=function(t,e,r,n){if(t=+t,e>>>=0,r>>>=0,!n){O(this,t,e,r,Math.pow(2,8*r)-1,0)}let i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(t,e,r,n){if(t=+t,e>>>=0,r>>>=0,!n){O(this,t,e,r,Math.pow(2,8*r)-1,0)}let i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},u.prototype.writeUint8=u.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,1,255,0),this[e]=255&t,e+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},u.prototype.writeBigUInt64LE=X((function(t,e=0){return R(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeBigUInt64BE=X((function(t,e=0){return N(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);O(this,t,e,r,n-1,-n)}let i=0,o=1,s=0;for(this[e]=255&t;++i<r&&(o*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+r},u.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);O(this,t,e,r,n-1,-n)}let i=r-1,o=1,s=0;for(this[e+i]=255&t;--i>=0&&(o*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+r},u.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},u.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},u.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},u.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},u.prototype.writeBigInt64LE=X((function(t,e=0){return R(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeBigInt64BE=X((function(t,e=0){return N(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeFloatLE=function(t,e,r){return j(this,t,e,!0,r)},u.prototype.writeFloatBE=function(t,e,r){return j(this,t,e,!1,r)},u.prototype.writeDoubleLE=function(t,e,r){return F(this,t,e,!0,r)},u.prototype.writeDoubleBE=function(t,e,r){return F(this,t,e,!1,r)},u.prototype.copy=function(t,e,r,n){if(!u.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);const i=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),i},u.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),n!==undefined&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){const e=t.charCodeAt(0);("utf8"===n&&e<128||"latin1"===n)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;let i;if(e>>>=0,r=r===undefined?this.length:r>>>0,t||(t=0),"number"==typeof t)for(i=e;i<r;++i)this[i]=t;else{const o=u.isBuffer(t)?t:u.from(t,n),s=o.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(i=0;i<r-e;++i)this[i+e]=o[i%s]}return this};const D={};function U(t,e,r){D[t]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function K(t){let e="",r=t.length;const n="-"===t[0]?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function H(t,e,r,n,i,o){if(t>r||t<e){const n="bigint"==typeof e?"n":"";let i;throw i=o>3?0===e||e===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(o+1)}${n}`:`>= -(2${n} ** ${8*(o+1)-1}${n}) and < 2 ** ${8*(o+1)-1}${n}`:`>= ${e}${n} and <= ${r}${n}`,new D.ERR_OUT_OF_RANGE("value",i,t)}!function(t,e,r){G(e,"offset"),t[e]!==undefined&&t[e+r]!==undefined||q(e,t.length-(r+1))}(n,i,o)}function G(t,e){if("number"!=typeof t)throw new D.ERR_INVALID_ARG_TYPE(e,"number",t)}function q(t,e,r){if(Math.floor(t)!==t)throw G(t,r),new D.ERR_OUT_OF_RANGE(r||"offset","an integer",t);if(e<0)throw new D.ERR_BUFFER_OUT_OF_BOUNDS;throw new D.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}U("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),U("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),U("ERR_OUT_OF_RANGE",(function(t,e,r){let n=`The value of "${t}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=K(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=K(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n}),RangeError);const V=/[^+/0-9A-Za-z-_]/g;function z(t,e){let r;e=e||Infinity;const n=t.length;let i=null;const o=[];for(let s=0;s<n;++s){if(r=t.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function W(t){return n.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(V,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function $(t,e,r,n){let i;for(i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function Y(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function Z(t){return t!=t}const J=function(){const t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)e[n+i]=t[r]+t[i]}return e}();function X(t){return"undefined"==typeof BigInt?Q:t}function Q(){throw new Error("BigInt not supported")}}}},{package:"eth-lattice-keyring>gridplus-sdk>eth-eip712-util-browser>buffer"}],[2739,{"bn.js":2737,"buffer/":2738,"js-sha3":5616},function(){with(this)return function(){"use strict";return function(t,e,r){const n=t("bn.js"),i=t("buffer/").Buffer,o=t("js-sha3").keccak256;function s(t){return i.allocUnsafe(t).fill(0)}function a(t,e,r){const n=s(e);return t=u(t),r?t.length<e?(t.copy(n),n):t.slice(0,e):t.length<e?(t.copy(n,e-t.length),n):t.slice(-e)}function u(t){if(!i.isBuffer(t))if(Array.isArray(t))t=i.from(t);else if("string"==typeof t)t=c(t)?i.from((e=h(t)).length%2?"0"+e:e,"hex"):i.from(t);else if("number"==typeof t)t=intToBuffer(t);else if(null===t||t===undefined)t=i.allocUnsafe(0);else if(n.isBN(t))t=t.toArrayLike(i);else{if(!t.toArray)throw new Error("invalid type");t=i.from(t.toArray())}var e;return t}function c(t){return"string"==typeof t&&t.match(/^0x[0-9A-Fa-f]*$/)}function h(t){return"string"==typeof t&&t.startsWith("0x")?t.slice(2):t}e.exports={zeros:s,setLength:a,setLengthRight:function(t,e){return a(t,e,!0)},isHexString:c,stripHexPrefix:h,toBuffer:u,bufferToHex:function(t){return"0x"+(t=u(t)).toString("hex")},keccak:function(t){return t=u(t),i.from(o(t),"hex")}}}}},{package:"eth-lattice-keyring>gridplus-sdk>eth-eip712-util-browser"}],[2766,{"./logging-utils":2773,"./utils/cache":2778,"json-rpc-engine":5626},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockCacheMiddleware=void 0;const n=t("json-rpc-engine"),i=t("./logging-utils"),o=t("./utils/cache"),s=(0,i.createModuleLogger)(i.projectLogger,"block-cache"),a=[undefined,null,"<nil>"];class u{constructor(){this.cache={}}getBlockCacheForPayload(t,e){const r=Number.parseInt(e,16);let n=this.cache[r];if(!n){const t={};this.cache[r]=t,n=t}return n}async get(t,e){const r=this.getBlockCacheForPayload(t,e),n=(0,o.cacheIdentifierForPayload)(t,!0);return n?r[n]:undefined}async set(t,e,r){if(!this.canCacheResult(t,r))return;const n=(0,o.cacheIdentifierForPayload)(t,!0);if(!n)return;this.getBlockCacheForPayload(t,e)[n]=r}canCacheRequest(t){if(!(0,o.canCache)(t))return!1;return"pending"!==(0,o.blockTagForPayload)(t)}canCacheResult(t,e){return!a.includes(e)&&!(t.method&&["eth_getTransactionByHash","eth_getTransactionReceipt"].includes(t.method)&&(!e||!e.blockHash||"0x0000000000000000000000000000000000000000000000000000000000000000"===e.blockHash))}clearBefore(t){const e=Number.parseInt(t,16);Object.keys(this.cache).map(Number).filter((t=>t<e)).forEach((t=>delete this.cache[t]))}}r.createBlockCacheMiddleware=function({blockTracker:t}={}){if(!t)throw new Error("createBlockCacheMiddleware - No PollingBlockTracker specified");const e=new u,r={perma:e,block:e,fork:e};return(0,n.createAsyncMiddleware)((async(n,i,a)=>{if(n.skipCache)return a();const u=(0,o.cacheTypeForPayload)(n),c=r[u];if(!c)return a();if(!c.canCacheRequest(n))return a();let h,f=(0,o.blockTagForPayload)(n);if(f||(f="latest"),s("blockTag = %o, req = %o",f,n),"earliest"===f)h="0x00";else if("latest"===f){s("Fetching latest block number to determine cache key");const r=await t.getLatestBlock();s("Clearing values stored under block numbers before %o",r),e.clearBefore(r),h=r}else h=f;const l=await c.get(n,h);return l===undefined?(s("No cache stored under block number %o, carrying request forward",h),await a(),s("Populating cache with",i),await c.set(n,h,i.result)):(s("Cache hit, reusing cache result stored under block number %o",h),i.result=l),undefined}))}}}},{package:"eth-json-rpc-middleware"}],[2767,{"./utils/cache":2778,"json-rpc-engine":5626},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockRefRewriteMiddleware=void 0;const n=t("json-rpc-engine"),i=t("./utils/cache");r.createBlockRefRewriteMiddleware=function({blockTracker:t}={}){if(!t)throw Error('BlockRefRewriteMiddleware - mandatory "blockTracker" option is missing.');return(0,n.createAsyncMiddleware)((async(e,r,n)=>{var o;const s=(0,i.blockTagParamIndex)(e);if(s===undefined)return n();let a=null===(o=e.params)||void 0===o?void 0:o[s];if(a===undefined&&(a="latest"),"latest"!==a)return n();const u=await t.getLatestBlock();return e.params&&(e.params[s]=u),n()}))}}}},{package:"eth-json-rpc-middleware"}],[2768,{"./logging-utils":2773,"./utils/cache":2778,clone:2489,"json-rpc-engine":5626,pify:2798},function(){with(this)return function(){"use strict";return function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockRefMiddleware=void 0;const i=t("json-rpc-engine"),o=n(t("clone")),s=n(t("pify")),a=t("./logging-utils"),u=t("./utils/cache"),c=(0,a.createModuleLogger)(a.projectLogger,"block-ref");r.createBlockRefMiddleware=function({provider:t,blockTracker:e}={}){if(!t)throw Error('BlockRefMiddleware - mandatory "provider" option is missing.');if(!e)throw Error('BlockRefMiddleware - mandatory "blockTracker" option is missing.');return(0,i.createAsyncMiddleware)((async(r,n,i)=>{var a;const h=(0,u.blockTagParamIndex)(r);if(h===undefined)return i();let f=null===(a=r.params)||void 0===a?void 0:a[h];if(f===undefined&&(f="latest"),"latest"!==f)return c('blockRef is not "latest", carrying request forward'),i();const l=await e.getLatestBlock(),d=(0,o.default)(r);d.params&&(d.params[h]=l),c("Performing another request %o",d);const p=await(0,s.default)(t.sendAsync).call(t,d);return n.result=p.result,n.error=p.error,i()}))}}}},{package:"eth-json-rpc-middleware"}],[2769,{"./logging-utils":2773,"json-rpc-engine":5626},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createBlockTrackerInspectorMiddleware=void 0;const n=t("json-rpc-engine"),i=t("./logging-utils"),o=(0,i.createModuleLogger)(i.projectLogger,"block-tracker-inspector"),s=["eth_getTransactionByHash","eth_getTransactionReceipt"];r.createBlockTrackerInspectorMiddleware=function({blockTracker:t}){return(0,n.createAsyncMiddleware)((async(e,r,n)=>{var i;if(!s.includes(e.method))return n();if(await n(),!(null===(i=r.result)||void 0===i?void 0:i.blockNumber))return undefined;if(o("res.result.blockNumber exists, proceeding. res = %o",r),"string"==typeof r.result.blockNumber){Number.parseInt(r.result.blockNumber,16)>Number.parseInt(t.getCurrentBlock(),16)&&(o("blockNumber from response is greater than current block number, refreshing current block number"),await t.checkForLatestBlock())}return undefined}))}}}},{package:"eth-json-rpc-middleware"}],[2770,{btoa:2437,"eth-rpc-errors":2821,"json-rpc-engine":5626,"node-fetch":2437},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createFetchConfigFromReq=r.createFetchMiddleware=void 0;const n=t("json-rpc-engine"),i=t("eth-rpc-errors"),o=global.fetch||t("node-fetch"),s=global.btoa||t("btoa"),a=["Gateway timeout","ETIMEDOUT","failed to parse response body","Failed to fetch"];function u(t){switch(t.status){case 405:throw i.ethErrors.rpc.methodNotFound();case 418:throw i.ethErrors.rpc.internal({message:"Request is being rate limited."});case 503:case 504:throw function(){let t="Gateway timeout. The request took too long to process. ";return t+="This can happen when querying logs over too wide a block range.",i.ethErrors.rpc.internal({message:t})}()}}function c(t,e){if(200!==t.status)throw i.ethErrors.rpc.internal({message:`Non-200 status code: '${t.status}'`,data:e});if(e.error)throw i.ethErrors.rpc.internal({data:e.error});return e.result}function h({req:t,rpcUrl:e,originHttpHeaderKey:r}){const n=new URL(e),i=function(t){let e="";e+=t.protocol,e+=`//${t.hostname}`,t.port&&(e+=`:${t.port}`);return e+=`${t.pathname}`,e+=`${t.search}`,e}(n),o={id:t.id,jsonrpc:t.jsonrpc,method:t.method,params:t.params},a=t.origin,u={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(o)};if(n.username&&n.password){const t=`${n.username}:${n.password}`,e=s(t);u.headers.Authorization=`Basic ${e}`}return r&&a&&(u.headers[r]=a),{fetchUrl:i,fetchParams:u}}function f(t){return new Promise((e=>setTimeout(e,t)))}r.createFetchMiddleware=function({rpcUrl:t,originHttpHeaderKey:e}){return(0,n.createAsyncMiddleware)((async(r,n,i)=>{const{fetchUrl:s,fetchParams:l}=h({req:r,rpcUrl:t,originHttpHeaderKey:e});for(let t=0;t<5;t++){try{const t=await o(s,l);u(t);const e=await t.text();let r;try{r=JSON.parse(e)}catch(t){throw new Error(`FetchMiddleware - failed to parse response body: "${e}"`)}const i=c(t,r);return void(n.result=i)}catch(t){const e=t.toString();if(!a.some((t=>e.includes(t))))throw t}await f(1e3)}}))},r.createFetchConfigFromReq=h}}},{package:"eth-json-rpc-middleware"}],[2771,{"./block-cache":2766,"./block-ref":2768,"./block-ref-rewrite":2767,"./block-tracker-inspector":2769,"./fetch":2770,"./inflight-cache":2772,"./providerAsMiddleware":2774,"./providerFromEngine":2775,"./providerFromMiddleware":2776,"./retryOnEmpty":2777,"./wallet":2779},function(){with(this)return function(){"use strict";return function(t,e,r){var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){n===undefined&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===undefined&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(t("./block-cache"),r),i(t("./block-ref-rewrite"),r),i(t("./block-ref"),r),i(t("./block-tracker-inspector"),r),i(t("./fetch"),r),i(t("./inflight-cache"),r),i(t("./providerAsMiddleware"),r),i(t("./providerFromEngine"),r),i(t("./providerFromMiddleware"),r),i(t("./retryOnEmpty"),r),i(t("./wallet"),r)}}},{package:"eth-json-rpc-middleware"}],[2772,{"./logging-utils":2773,"./utils/cache":2778,clone:2489,"json-rpc-engine":5626},function(){with(this)return function(){"use strict";return function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0}),r.createInflightCacheMiddleware=void 0;const i=n(t("clone")),o=t("json-rpc-engine"),s=t("./logging-utils"),a=t("./utils/cache"),u=(0,s.createModuleLogger)(s.projectLogger,"inflight-cache");r.createInflightCacheMiddleware=function(){const t={};return(0,o.createAsyncMiddleware)((async(e,r,n)=>{if(e.skipCache)return n();const o=(0,a.cacheIdentifierForPayload)(e);if(!o)return u("Request is not cacheable, proceeding. req = %o",e),n();let s=t[o];return s?(u("Running %i handler(s) for request %o",s.length,e),await function(t,e){const{resolve:r,promise:n}=function(){let t;const e=new Promise((e=>{t=e}));return{resolve:t,promise:e}}();return e.push((e=>{t.result=(0,i.default)(e.result),t.error=(0,i.default)(e.error),r()})),n}(r,s),undefined):(s=[],t[o]=s,u("Carrying original request forward %o",e),await n(),delete t[o],u("Running %i collected handler(s) for request %o",s.length,e),function(t,e){setTimeout((()=>{e.forEach((e=>{try{e(t)}catch(t){console.error(t)}}))}))}(r,s),undefined)}))}}}},{package:"eth-json-rpc-middleware"}],[2773,{"@metamask/utils":1773},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createModuleLogger=r.projectLogger=void 0;const n=t("@metamask/utils");Object.defineProperty(r,"createModuleLogger",{enumerable:!0,get:function(){return n.createModuleLogger}}),r.projectLogger=(0,n.createProjectLogger)("eth-json-rpc-middleware")}}},{package:"eth-json-rpc-middleware"}],[2774,{},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ethersProviderAsMiddleware=r.providerAsMiddleware=void 0,r.providerAsMiddleware=function(t){return(e,r,n,i)=>{t.sendAsync(e,((t,e)=>t instanceof Error?i(t):(Object.assign(r,e),i())))}},r.ethersProviderAsMiddleware=function(t){return(e,r,n,i)=>{t.send(e,((t,e)=>t?i(t):(Object.assign(r,e),i())))}}}}},{package:"eth-json-rpc-middleware"}],[2775,{"@metamask/safe-event-emitter":1574},function(){with(this)return function(){"use strict";return function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0}),r.providerFromEngine=void 0;const i=n(t("@metamask/safe-event-emitter"));r.providerFromEngine=function(t){const e=new i.default;return e.sendAsync=(e,r)=>{t.handle(e,r)},e.send=(e,r)=>{if("function"!=typeof r)throw new Error('Must provide callback to "send" method.');t.handle(e,r)},t.on&&t.on("notification",(t=>{e.emit("data",null,t)})),e}}}},{package:"eth-json-rpc-middleware"}],[2776,{"./providerFromEngine":2775,"json-rpc-engine":5626},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.providerFromMiddleware=void 0;const n=t("json-rpc-engine"),i=t("./providerFromEngine");r.providerFromMiddleware=function(t){const e=new n.JsonRpcEngine;return e.push(t),(0,i.providerFromEngine)(e)}}}},{package:"eth-json-rpc-middleware"}],[2777,{"./logging-utils":2773,"./utils/cache":2778,clone:2489,"json-rpc-engine":5626,pify:2798},function(){with(this)return function(){"use strict";return function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0}),r.createRetryOnEmptyMiddleware=void 0;const i=n(t("clone")),o=t("json-rpc-engine"),s=n(t("pify")),a=t("./logging-utils"),u=t("./utils/cache"),c=(0,a.createModuleLogger)(a.projectLogger,"retry-on-empty"),h=[undefined,null,"<nil>"];function f(t){return new Promise((e=>setTimeout(e,t)))}r.createRetryOnEmptyMiddleware=function({provider:t,blockTracker:e}={}){if(!t)throw Error('RetryOnEmptyMiddleware - mandatory "provider" option is missing.');if(!e)throw Error('RetryOnEmptyMiddleware - mandatory "blockTracker" option is missing.');return(0,o.createAsyncMiddleware)((async(r,n,o)=>{var a;const l=(0,u.blockTagParamIndex)(r);if(l===undefined)return o();let d=null===(a=r.params)||void 0===a?void 0:a[l];if(d===undefined&&(d="latest"),["latest","pending"].includes(d))return o();const p=Number.parseInt(d.slice(2),16);if(Number.isNaN(p))return o();const m=await e.getLatestBlock(),g=Number.parseInt(m.slice(2),16);if(p>g)return c("Requested block number %o is higher than latest block number %o, falling through to original request",p,g),o();c("Requested block number %o is not higher than latest block number %o, retrying request until non-empty response is received",p,g);const y=(0,i.default)(r),v=await async function(t,e){for(let r=0;r<t;r++)try{return await e()}catch(t){await f(1e3)}throw new Error("RetryOnEmptyMiddleware - retries exhausted")}(10,(async()=>{c("Performing another request %o",y);const e=await(0,s.default)(t.sendAsync).call(t,y);if(c("Response is %o",e),h.includes(e))throw new Error(`RetryOnEmptyMiddleware - empty response "${JSON.stringify(e)}" for request "${JSON.stringify(y)}"`);return e}));return n.result=v.result,n.error=v.error,o()}))}}}},{package:"eth-json-rpc-middleware"}],[2778,{"json-stable-stringify":5630},function(){with(this)return function(){"use strict";return function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0}),r.cacheTypeForPayload=r.blockTagParamIndex=r.paramsWithoutBlockTag=r.blockTagForPayload=r.canCache=r.cacheIdentifierForPayload=void 0;const i=n(t("json-stable-stringify"));function o(t){return"never"!==u(t)}function s(t){if(!t.params)return[];const e=a(t);return e===undefined||e>=t.params.length?t.params:"eth_getBlockByNumber"===t.method?t.params.slice(1):t.params.slice(0,e)}function a(t){switch(t.method){case"eth_getStorageAt":return 2;case"eth_getBalance":case"eth_getCode":case"eth_getTransactionCount":case"eth_call":return 1;case"eth_getBlockByNumber":return 0;default:return undefined}}function u(t){switch(t.method){case"web3_clientVersion":case"web3_sha3":case"eth_protocolVersion":case"eth_getBlockTransactionCountByHash":case"eth_getUncleCountByBlockHash":case"eth_getCode":case"eth_getBlockByHash":case"eth_getTransactionByHash":case"eth_getTransactionByBlockHashAndIndex":case"eth_getTransactionReceipt":case"eth_getUncleByBlockHashAndIndex":case"eth_getCompilers":case"eth_compileLLL":case"eth_compileSolidity":case"eth_compileSerpent":case"shh_version":case"test_permaCache":return"perma";case"eth_getBlockByNumber":case"eth_getBlockTransactionCountByNumber":case"eth_getUncleCountByBlockNumber":case"eth_getTransactionByBlockNumberAndIndex":case"eth_getUncleByBlockNumberAndIndex":case"test_forkCache":return"fork";case"eth_gasPrice":case"eth_blockNumber":case"eth_getBalance":case"eth_getStorageAt":case"eth_getTransactionCount":case"eth_call":case"eth_estimateGas":case"eth_getFilterLogs":case"eth_getLogs":case"test_blockCache":return"block";default:return"never"}}r.cacheIdentifierForPayload=function(t,e){var r;const n=e?s(t):null!==(r=t.params)&&void 0!==r?r:[];return o(t)?`${t.method}:${(0,i.default)(n)}`:null},r.canCache=o,r.blockTagForPayload=function(t){if(!t.params)return undefined;const e=a(t);return e===undefined||e>=t.params.length?undefined:t.params[e]},r.paramsWithoutBlockTag=s,r.blockTagParamIndex=a,r.cacheTypeForPayload=u}}},{package:"eth-json-rpc-middleware"}],[2779,{"eth-rpc-errors":2821,"eth-sig-util":2780,"json-rpc-engine":5626},function(){with(this)return function(){"use strict";return function(t,e,r){var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){n===undefined&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===undefined&&(n=r),t[n]=e[r]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&n(e,t,r);return i(e,t),e};Object.defineProperty(r,"__esModule",{value:!0}),r.createWalletMiddleware=void 0;const s=t("json-rpc-engine"),a=o(t("eth-sig-util")),u=t("eth-rpc-errors");function c(t){return 42===t.length}r.createWalletMiddleware=function({getAccounts:t,processDecryptMessage:e,processEncryptionPublicKey:r,processEthSignMessage:n,processPersonalMessage:i,processTransaction:o,processSignTransaction:h,processTypedMessage:f,processTypedMessageV3:l,processTypedMessageV4:d}){if(!t)throw new Error("opts.getAccounts is required");return(0,s.createScaffoldMiddleware)({eth_accounts:(0,s.createAsyncMiddleware)((async function(e,r){r.result=await t(e)})),eth_coinbase:(0,s.createAsyncMiddleware)((async function(e,r){const n=await t(e);r.result=n[0]||null})),eth_sendTransaction:(0,s.createAsyncMiddleware)((async function(t,e){if(!o)throw u.ethErrors.rpc.methodNotSupported();const r=t.params[0]||{};r.from=await p(r.from,t),e.result=await o(r,t)})),eth_signTransaction:(0,s.createAsyncMiddleware)((async function(t,e){if(!h)throw u.ethErrors.rpc.methodNotSupported();const r=t.params[0]||{};r.from=await p(r.from,t),e.result=await h(r,t)})),eth_sign:(0,s.createAsyncMiddleware)((async function(t,e){if(!n)throw u.ethErrors.rpc.methodNotSupported();const r=await p(t.params[0],t),i=t.params[1],o=t.params[2]||{},s=Object.assign(Object.assign({},o),{from:r,data:i});e.result=await n(s,t)})),eth_signTypedData:(0,s.createAsyncMiddleware)((async function(t,e){if(!f)throw u.ethErrors.rpc.methodNotSupported();const r=t.params[0],n=await p(t.params[1],t),i=t.params[2]||{},o=Object.assign(Object.assign({},i),{from:n,data:r});e.result=await f(o,t,"V1")})),eth_signTypedData_v3:(0,s.createAsyncMiddleware)((async function(t,e){if(!l)throw u.ethErrors.rpc.methodNotSupported();const r=await p(t.params[0],t),n=t.params[1],i={data:n,from:r,version:"V3"};e.result=await l(i,t,"V3")})),eth_signTypedData_v4:(0,s.createAsyncMiddleware)((async function(t,e){if(!d)throw u.ethErrors.rpc.methodNotSupported();const r=await p(t.params[0],t),n=t.params[1],i={data:n,from:r,version:"V4"};e.result=await d(i,t,"V4")})),personal_sign:(0,s.createAsyncMiddleware)((async function(t,e){if(!i)throw u.ethErrors.rpc.methodNotSupported();const r=t.params[0],n=t.params[1],o=t.params[2]||{};let s,a;if(c(r)&&!c(n)){let t="The eth_personalSign method requires params ordered ";t+="[message, address]. This was previously handled incorrectly, ",t+="and has been corrected automatically. ",t+="Please switch this param order for smooth behavior in the future.",e.warning=t,s=r,a=n}else a=r,s=n;s=await p(s,t);const h=Object.assign(Object.assign({},o),{from:s,data:a});e.result=await i(h,t)})),eth_getEncryptionPublicKey:(0,s.createAsyncMiddleware)((async function(t,e){if(!r)throw u.ethErrors.rpc.methodNotSupported();const n=await p(t.params[0],t);e.result=await r(n,t)})),eth_decrypt:(0,s.createAsyncMiddleware)((async function(t,r){if(!e)throw u.ethErrors.rpc.methodNotSupported();const n=t.params[0],i=await p(t.params[1],t),o=t.params[2]||{},s=Object.assign(Object.assign({},o),{from:i,data:n});r.result=await e(s,t)})),personal_ecRecover:(0,s.createAsyncMiddleware)((async function(t,e){const r=t.params[0],n=t.params[1],i=t.params[2]||{},o=Object.assign(Object.assign({},i),{sig:n,data:r}),s=a.recoverPersonalSignature(o);e.result=s}))});async function p(e,r){if("string"==typeof e&&e.length>0&&c(e)){const n=(await t(r,{suppressUnauthorized:!1})).map((t=>t.toLowerCase())),i=e.toLowerCase();if(n.includes(i))return i;throw u.ethErrors.provider.unauthorized()}throw u.ethErrors.rpc.invalidParams({message:"Invalid parameters: must provide an Ethereum address."})}}}}},{package:"eth-json-rpc-middleware"}],[2780,{"ethereumjs-abi":2781,"ethereumjs-util":2793},function(){with(this)return function(){"use strict";return function(t,e,r){const n=t("ethereumjs-util"),i=t("ethereumjs-abi");function o(t){const e=new Error("Expect argument to be non-empty array");if("object"!=typeof t||!t.length)throw e;const r=t.map((function(t){return"bytes"===t.type?n.toBuffer(t.value):t.value})),o=t.map((function(t){return t.type})),s=t.map((function(t){if(!t.name)throw e;return t.type+" "+t.name}));return i.soliditySHA3(["bytes32","bytes32"],[i.soliditySHA3(new Array(t.length).fill("string"),s),i.soliditySHA3(o,r)])}function s(t,e){const r=n.toBuffer(e),i=n.fromRpcSig(r);return n.ecrecover(t,i.v,i.r,i.s)}function a(t){const e=n.toBuffer(t.data);return s(n.hashPersonalMessage(e),t.sig)}function u(t,e){for(var r=""+t;r.length<e;)r="0"+r;return r}e.exports={concatSig:function(t,e,r){const i=n.fromSigned(e),o=n.fromSigned(r),s=n.bufferToInt(t),a=u(n.toUnsigned(i).toString("hex"),64),c=u(n.toUnsigned(o).toString("hex"),64),h=n.stripHexPrefix(n.intToHex(s));return n.addHexPrefix(a.concat(c,h)).toString("hex")},normalize:function(t){if(t){if("number"==typeof t){const e=n.toBuffer(t);t=n.bufferToHex(e)}if("string"!=typeof t){var e="eth-sig-util.normalize() requires hex string or integer input.";throw new Error(e+=" received "+typeof t+": "+t)}return n.addHexPrefix(t.toLowerCase())}},personalSign:function(t,e){var r=n.toBuffer(e.data),i=n.hashPersonalMessage(r),o=n.ecsign(i,t);return n.bufferToHex(this.concatSig(o.v,o.r,o.s))},recoverPersonalSignature:function(t){const e=a(t),r=n.publicToAddress(e);return n.bufferToHex(r)},extractPublicKey:function(t){return"0x"+a(t).toString("hex")},typedSignatureHash:function(t){const e=o(t);return n.bufferToHex(e)},signTypedData:function(t,e){const r=o(e.data),i=n.ecsign(r,t);return n.bufferToHex(this.concatSig(i.v,i.r,i.s))},recoverTypedSignature:function(t){const e=s(o(t.data),t.sig),r=n.publicToAddress(e);return n.bufferToHex(r)}}}}},{package:"eth-json-rpc-middleware>eth-sig-util"}],[2781,{"./lib/index.js":2782},function(){with(this)return function(){"use strict";return function(t,e,r){e.exports=t("./lib/index.js")}}},{package:"eth-json-rpc-middleware>eth-sig-util>ethereumjs-abi"}],[2782,{"bn.js":2394,buffer:2438,"ethereumjs-util":2787},function(){with(this)return function(){"use strict";return function(t,e,r){(function(r){(function(){const n=t("ethereumjs-util"),i=t("bn.js");var o=function(){};function s(t){return t.startsWith("int[")?"int256"+t.slice(3):"int"===t?"int256":t.startsWith("uint[")?"uint256"+t.slice(4):"uint"===t?"uint256":t.startsWith("fixed[")?"fixed128x128"+t.slice(5):"fixed"===t?"fixed128x128":t.startsWith("ufixed[")?"ufixed128x128"+t.slice(6):"ufixed"===t?"ufixed128x128":t}function a(t){return parseInt(/^\D+(\d+)$/.exec(t)[1],10)}function u(t){var e=/^\D+(\d+)x(\d+)$/.exec(t);return[parseInt(e[1],10),parseInt(e[2],10)]}function c(t){var e=t.match(/(.*)\[(.*?)\]$/);return e?""===e[2]?"dynamic":parseInt(e[2],10):null}function h(t){var e=typeof t;if("string"===e)return n.isHexPrefixed(t)?new i(n.stripHexPrefix(t),16):new i(t,10);if("number"===e)return new i(t);if(t.toArray)return t;throw new Error("Argument is not a number")}function f(t){var e=/^(\w+)\((.*)\)$/.exec(t);if(3!==e.length)throw new Error("Invalid method signature");var r=/^(.+)\):\((.+)$/.exec(e[2]);if(null!==r&&3===r.length)return{method:e[1],args:r[1].split(","),retargs:r[2].split(",")};var n=e[2].split(",");return 1===n.length&&""===n[0]&&(n=[]),{method:e[1],args:n}}function l(t,e){var o,s,f,d;if("address"===t)return l("uint160",h(e));if("bool"===t)return l("uint8",e?1:0);if("string"===t)return l("bytes",r.from(e,"utf8"));if(g(t)){if(void 0===e.length)throw new Error("Not an array?");if("dynamic"!==(o=c(t))&&0!==o&&e.length>o)throw new Error("Elements exceed array size: "+o);for(d in f=[],t=t.slice(0,t.lastIndexOf("[")),"string"==typeof e&&(e=JSON.parse(e)),e)f.push(l(t,e[d]));if("dynamic"===o){var p=l("uint256",e.length);f.unshift(p)}return r.concat(f)}if("bytes"===t)return e=r.from(e),f=r.concat([l("uint256",e.length),e]),e.length%32!=0&&(f=r.concat([f,n.zeros(32-e.length%32)])),f;if(t.startsWith("bytes")){if((o=a(t))<1||o>32)throw new Error("Invalid bytes<N> width: "+o);return n.setLengthRight(e,32)}if(t.startsWith("uint")){if((o=a(t))%8||o<8||o>256)throw new Error("Invalid uint<N> width: "+o);if((s=h(e)).bitLength()>o)throw new Error("Supplied uint exceeds width: "+o+" vs "+s.bitLength());if(s<0)throw new Error("Supplied uint is negative");return s.toArrayLike(r,"be",32)}if(t.startsWith("int")){if((o=a(t))%8||o<8||o>256)throw new Error("Invalid int<N> width: "+o);if((s=h(e)).bitLength()>o)throw new Error("Supplied int exceeds width: "+o+" vs "+s.bitLength());return s.toTwos(256).toArrayLike(r,"be",32)}if(t.startsWith("ufixed")){if(o=u(t),(s=h(e))<0)throw new Error("Supplied ufixed is negative");return l("uint256",s.mul(new i(2).pow(new i(o[1]))))}if(t.startsWith("fixed"))return o=u(t),l("int256",h(e).mul(new i(2).pow(new i(o[1]))));throw new Error("Unsupported or invalid type: "+t)}function d(t,e,n){var o,s,a,u;if("string"==typeof t&&(t=p(t)),"address"===t.name)return d(t.rawType,e,n).toArrayLike(r,"be",20).toString("hex");if("bool"===t.name)return d(t.rawType,e,n).toString()===new i(1).toString();if("string"===t.name){var c=d(t.rawType,e,n);return r.from(c,"utf8").toString()}if(t.isArray){for(a=[],o=t.size,"dynamic"===t.size&&(n=d("uint256",e,n).toNumber(),o=d("uint256",e,n).toNumber(),n+=32),u=0;u<o;u++){var h=d(t.subArray,e,n);a.push(h),n+=t.subArray.memoryUsage}return a}if("bytes"===t.name)return n=d("uint256",e,n).toNumber(),o=d("uint256",e,n).toNumber(),e.slice(n+32,n+32+o);if(t.name.startsWith("bytes"))return e.slice(n,n+t.size);if(t.name.startsWith("uint")){if((s=new i(e.slice(n,n+32),16,"be")).bitLength()>t.size)throw new Error("Decoded int exceeds width: "+t.size+" vs "+s.bitLength());return s}if(t.name.startsWith("int")){if((s=new i(e.slice(n,n+32),16,"be").fromTwos(256)).bitLength()>t.size)throw new Error("Decoded uint exceeds width: "+t.size+" vs "+s.bitLength());return s}if(t.name.startsWith("ufixed")){if(o=new i(2).pow(new i(t.size[1])),!(s=d("uint256",e,n)).mod(o).isZero())throw new Error("Decimals not supported yet");return s.div(o)}if(t.name.startsWith("fixed")){if(o=new i(2).pow(new i(t.size[1])),!(s=d("int256",e,n)).mod(o).isZero())throw new Error("Decimals not supported yet");return s.div(o)}throw new Error("Unsupported or invalid type: "+t.name)}function p(t){var e,r,n;if(g(t)){e=c(t);var i=t.slice(0,t.lastIndexOf("["));return i=p(i),r={isArray:!0,name:t,size:e,memoryUsage:"dynamic"===e?32:i.memoryUsage*e,subArray:i}}switch(t){case"address":n="uint160";break;case"bool":n="uint8";break;case"string":n="bytes"}if(r={rawType:n,name:t,memoryUsage:32},t.startsWith("bytes")&&"bytes"!==t||t.startsWith("uint")||t.startsWith("int")?r.size=a(t):(t.startsWith("ufixed")||t.startsWith("fixed"))&&(r.size=u(t)),t.startsWith("bytes")&&"bytes"!==t&&(r.size<1||r.size>32))throw new Error("Invalid bytes<N> width: "+r.size);if((t.startsWith("uint")||t.startsWith("int"))&&(r.size%8||r.size<8||r.size>256))throw new Error("Invalid int/uint<N> width: "+r.size);return r}function m(t){return"string"===t||"bytes"===t||"dynamic"===c(t)}function g(t){return t.lastIndexOf("]")===t.length-1}function y(t,e){return t.startsWith("address")||t.startsWith("bytes")?"0x"+e.toString("hex"):e.toString()}o.eventID=function(t,e){var i=t+"("+e.map(s).join(",")+")";return n.keccak256(r.from(i))},o.methodID=function(t,e){return o.eventID(t,e).slice(0,4)},o.rawEncode=function(t,e){var n=[],i=[],o=0;t.forEach((function(t){if(g(t)){var e=c(t);o+="dynamic"!==e?32*e:32}else o+=32}));for(var a=0;a<t.length;a++){var u=s(t[a]),h=l(u,e[a]);m(u)?(n.push(l("uint256",o)),i.push(h),o+=h.length):n.push(h)}return r.concat(n.concat(i))},o.rawDecode=function(t,e){var n=[];e=r.from(e);for(var i=0,o=0;o<t.length;o++){var a=p(s(t[o])),u=d(a,e,i);i+=a.memoryUsage,n.push(u)}return n},o.simpleEncode=function(t){var e=Array.prototype.slice.call(arguments).slice(1),n=f(t);if(e.length!==n.args.length)throw new Error("Argument count mismatch");return r.concat([o.methodID(n.method,n.args),o.rawEncode(n.args,e)])},o.simpleDecode=function(t,e){var r=f(t);if(!r.retargs)throw new Error("No return values in method");return o.rawDecode(r.retargs,e)},o.stringify=function(t,e){var r=[];for(var n in t){var i=t[n],o=e[n];o=/^[^\[]+\[.*\]$/.test(i)?o.map((function(t){return y(i,t)})).join(", "):y(i,o),r.push(o)}return r},o.solidityHexValue=function(t,e,i){var s,u;if(g(t)){var f=t.replace(/\[.*?\]/,"");if(!g(f)){var l=c(t);if("dynamic"!==l&&0!==l&&e.length>l)throw new Error("Elements exceed array size: "+l)}var d=e.map((function(t){return o.solidityHexValue(f,t,256)}));return r.concat(d)}if("bytes"===t)return e;if("string"===t)return r.from(e,"utf8");if("bool"===t){i=i||8;var p=Array(i/4).join("0");return r.from(e?p+"1":p+"0","hex")}if("address"===t){var m=20;return i&&(m=i/8),n.setLengthLeft(e,m)}if(t.startsWith("bytes")){if((s=a(t))<1||s>32)throw new Error("Invalid bytes<N> width: "+s);return n.setLengthRight(e,s)}if(t.startsWith("uint")){if((s=a(t))%8||s<8||s>256)throw new Error("Invalid uint<N> width: "+s);if((u=h(e)).bitLength()>s)throw new Error("Supplied uint exceeds width: "+s+" vs "+u.bitLength());return i=i||s,u.toArrayLike(r,"be",i/8)}if(t.startsWith("int")){if((s=a(t))%8||s<8||s>256)throw new Error("Invalid int<N> width: "+s);if((u=h(e)).bitLength()>s)throw new Error("Supplied int exceeds width: "+s+" vs "+u.bitLength());return i=i||s,u.toTwos(s).toArrayLike(r,"be",i/8)}throw new Error("Unsupported or invalid type: "+t)},o.solidityPack=function(t,e){if(t.length!==e.length)throw new Error("Number of types are not matching the values");for(var n=[],i=0;i<t.length;i++){var a=s(t[i]),u=e[i];n.push(o.solidityHexValue(a,u,null))}return r.concat(n)},o.soliditySHA3=function(t,e){return n.keccak256(o.solidityPack(t,e))},o.soliditySHA256=function(t,e){return n.sha256(o.solidityPack(t,e))},o.solidityRIPEMD160=function(t,e){return n.ripemd160(o.solidityPack(t,e),!0)},o.fromSerpent=function(t){for(var e,r=[],n=0;n<t.length;n++){var i=t[n];if("s"===i)r.push("bytes");else if("b"===i){for(var o="bytes",s=n+1;s<t.length&&((e=t[s])>="0"&&e<="9");)o+=t[s]-"0",s++;n=s-1,r.push(o)}else if("i"===i)r.push("int256");else{if("a"!==i)throw new Error("Unsupported or invalid type: "+i);r.push("int256[]")}}return r},o.toSerpent=function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];if("bytes"===n)e.push("s");else if(n.startsWith("bytes"))e.push("b"+a(n));else if("int256"===n)e.push("i");else{if("int256[]"!==n)throw new Error("Unsupported or invalid type: "+n);e.push("a")}}return e.join("")},e.exports=o}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-json-rpc-middleware>eth-sig-util>ethereumjs-abi"}],[2783,{"./bytes":2784,"./hash":2786,"./secp256k1v3-adapter":2789,assert:2066,"bn.js":2394,buffer:2438,"ethjs-util":2797},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.importPublic=r.privateToPublic=r.privateToAddress=r.publicToAddress=r.pubToAddress=r.isValidPublic=r.isValidPrivate=r.isPrecompiled=r.generateAddress2=r.generateAddress=r.isValidChecksumAddress=r.toChecksumAddress=r.isZeroAddress=r.isValidAddress=r.zeroAddress=void 0;var n=t("assert"),i=t("ethjs-util"),o=t("./secp256k1v3-adapter"),s=t("bn.js"),a=t("./bytes"),u=t("./hash");r.zeroAddress=function(){var t=a.zeros(20);return a.bufferToHex(t)},r.isValidAddress=function(t){return/^0x[0-9a-fA-F]{40}$/.test(t)},r.isZeroAddress=function(t){return r.zeroAddress()===a.addHexPrefix(t)},r.toChecksumAddress=function(t,e){t=i.stripHexPrefix(t).toLowerCase();for(var r=e!==undefined?e.toString()+"0x":"",n=u.keccak(r+t).toString("hex"),o="0x",s=0;s<t.length;s++)parseInt(n[s],16)>=8?o+=t[s].toUpperCase():o+=t[s];return o},r.isValidChecksumAddress=function(t,e){return r.isValidAddress(t)&&r.toChecksumAddress(t,e)===t},r.generateAddress=function(t,r){t=a.toBuffer(t);var n=new s(r);return n.isZero()?u.rlphash([t,null]).slice(-20):u.rlphash([t,e.from(n.toArray())]).slice(-20)},r.generateAddress2=function(t,r,i){var o=a.toBuffer(t),s=a.toBuffer(r),c=a.toBuffer(i);return n(20===o.length),n(32===s.length),u.keccak256(e.concat([e.from("ff","hex"),o,s,u.keccak256(c)])).slice(-20)},r.isPrecompiled=function(t){var e=a.unpad(t);return 1===e.length&&e[0]>=1&&e[0]<=8},r.isValidPrivate=function(t){return o.privateKeyVerify(t)},r.isValidPublic=function(t,r){return void 0===r&&(r=!1),64===t.length?o.publicKeyVerify(e.concat([e.from([4]),t])):!!r&&o.publicKeyVerify(t)},r.pubToAddress=function(t,e){return void 0===e&&(e=!1),t=a.toBuffer(t),e&&64!==t.length&&(t=o.publicKeyConvert(t,!1).slice(1)),n(64===t.length),u.keccak(t).slice(-20)},r.publicToAddress=r.pubToAddress,r.privateToAddress=function(t){return r.publicToAddress(r.privateToPublic(t))},r.privateToPublic=function(t){return t=a.toBuffer(t),o.publicKeyCreate(t,!1).slice(1)},r.importPublic=function(t){return 64!==(t=a.toBuffer(t)).length&&(t=o.publicKeyConvert(t,!1).slice(1)),t}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-json-rpc-middleware>eth-sig-util>ethereumjs-abi>ethereumjs-util"}],[2784,{"bn.js":2394,buffer:2438,"ethjs-util":2797},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.baToJSON=r.addHexPrefix=r.toUnsigned=r.fromSigned=r.bufferToHex=r.bufferToInt=r.toBuffer=r.stripZeros=r.unpad=r.setLengthRight=r.setLength=r.setLengthLeft=r.zeros=void 0;var n=t("ethjs-util"),i=t("bn.js");r.zeros=function(t){return e.allocUnsafe(t).fill(0)},r.setLengthLeft=function(t,e,n){void 0===n&&(n=!1);var i=r.zeros(e);return t=r.toBuffer(t),n?t.length<e?(t.copy(i),i):t.slice(0,e):t.length<e?(t.copy(i,e-t.length),i):t.slice(-e)},r.setLength=r.setLengthLeft,r.setLengthRight=function(t,e){return r.setLength(t,e,!0)},r.unpad=function(t){for(var e=(t=n.stripHexPrefix(t))[0];t.length>0&&"0"===e.toString();)e=(t=t.slice(1))[0];return t},r.stripZeros=r.unpad,r.toBuffer=function(t){if(!e.isBuffer(t))if(Array.isArray(t))t=e.from(t);else if("string"==typeof t){if(!n.isHexString(t))throw new Error("Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: "+t);t=e.from(n.padToEven(n.stripHexPrefix(t)),"hex")}else if("number"==typeof t)t=n.intToBuffer(t);else if(null===t||t===undefined)t=e.allocUnsafe(0);else if(i.isBN(t))t=t.toArrayLike(e);else{if(!t.toArray)throw new Error("invalid type");t=e.from(t.toArray())}return t},r.bufferToInt=function(t){return new i(r.toBuffer(t)).toNumber()},r.bufferToHex=function(t){return"0x"+(t=r.toBuffer(t)).toString("hex")},r.fromSigned=function(t){return new i(t).fromTwos(256)},r.toUnsigned=function(t){return e.from(t.toTwos(256).toArray())},r.addHexPrefix=function(t){return"string"!=typeof t||n.isHexPrefixed(t)?t:"0x"+t},r.baToJSON=function(t){if(e.isBuffer(t))return"0x"+t.toString("hex");if(t instanceof Array){for(var n=[],i=0;i<t.length;i++)n.push(r.baToJSON(t[i]));return n}}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-json-rpc-middleware>eth-sig-util>ethereumjs-abi>ethereumjs-util"}],[2785,{"bn.js":2394,buffer:2438},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.KECCAK256_RLP=r.KECCAK256_RLP_S=r.KECCAK256_RLP_ARRAY=r.KECCAK256_RLP_ARRAY_S=r.KECCAK256_NULL=r.KECCAK256_NULL_S=r.TWO_POW256=r.MAX_INTEGER=void 0;var n=t("bn.js");r.MAX_INTEGER=new n("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16),r.TWO_POW256=new n("10000000000000000000000000000000000000000000000000000000000000000",16),r.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",r.KECCAK256_NULL=e.from(r.KECCAK256_NULL_S,"hex"),r.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",r.KECCAK256_RLP_ARRAY=e.from(r.KECCAK256_RLP_ARRAY_S,"hex"),r.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",r.KECCAK256_RLP=e.from(r.KECCAK256_RLP_S,"hex")}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-json-rpc-middleware>eth-sig-util>ethereumjs-abi>ethereumjs-util"}],[2786,{"./bytes":2784,buffer:2438,"create-hash":2553,"ethereum-cryptography/keccak":2841,"ethjs-util":2797,rlp:6613},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.rlphash=r.ripemd160=r.sha256=r.keccak256=r.keccak=void 0;var n=t("ethereum-cryptography/keccak"),i=n.keccak224,o=n.keccak384,s=n.keccak256,a=n.keccak512,u=t("create-hash"),c=t("ethjs-util"),h=t("rlp"),f=t("./bytes");r.keccak=function(t,r){switch(void 0===r&&(r=256),t="string"!=typeof t||c.isHexString(t)?f.toBuffer(t):e.from(t,"utf8"),r||(r=256),r){case 224:return i(t);case 256:return s(t);case 384:return o(t);case 512:return a(t);default:throw new Error("Invald algorithm: keccak"+r)}},r.keccak256=function(t){return r.keccak(t)},r.sha256=function(t){return t=f.toBuffer(t),u("sha256").update(t).digest()},r.ripemd160=function(t,e){t=f.toBuffer(t);var r=u("rmd160").update(t).digest();return!0===e?f.setLength(r,32):r},r.rlphash=function(t){return r.keccak(h.encode(t))}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-json-rpc-middleware>eth-sig-util>ethereumjs-abi>ethereumjs-util"}],[2787,{"./account":2783,"./bytes":2784,"./constants":2785,"./hash":2786,"./object":2788,"./secp256k1v3-adapter":2789,"./signature":2792,"bn.js":2394,"ethjs-util":2797,rlp:6613},function(){with(this)return function(){"use strict";return function(t,e,r){var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){n===undefined&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===undefined&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.secp256k1=r.rlp=r.BN=void 0;var o=t("./secp256k1v3-adapter");r.secp256k1=o;var s=t("ethjs-util"),a=t("bn.js");r.BN=a;var u=t("rlp");r.rlp=u,Object.assign(r,s),i(t("./constants"),r),i(t("./account"),r),i(t("./hash"),r),i(t("./signature"),r),i(t("./bytes"),r),i(t("./object"),r)}}},{package:"eth-json-rpc-middleware>eth-sig-util>ethereumjs-abi>ethereumjs-util"}],[2788,{"./bytes":2784,assert:2066,buffer:2438,"ethjs-util":2797,rlp:6613},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.defineProperties=void 0;var n=t("assert"),i=t("ethjs-util"),o=t("rlp"),s=t("./bytes");r.defineProperties=function(t,r,a){if(t.raw=[],t._fields=[],t.toJSON=function(e){if(void 0===e&&(e=!1),e){var r={};return t._fields.forEach((function(e){r[e]="0x"+t[e].toString("hex")})),r}return s.baToJSON(t.raw)},t.serialize=function(){return o.encode(t.raw)},r.forEach((function(r,i){function o(){return t.raw[i]}function a(o){"00"!==(o=s.toBuffer(o)).toString("hex")||r.allowZero||(o=e.allocUnsafe(0)),r.allowLess&&r.length?(o=s.stripZeros(o),n(r.length>=o.length,"The field "+r.name+" must not have more "+r.length+" bytes")):r.allowZero&&0===o.length||!r.length||n(r.length===o.length,"The field "+r.name+" must have byte length of "+r.length),t.raw[i]=o}t._fields.push(r.name),Object.defineProperty(t,r.name,{enumerable:!0,configurable:!0,get:o,set:a}),r.default&&(t[r.name]=r.default),r.alias&&Object.defineProperty(t,r.alias,{enumerable:!1,configurable:!0,set:a,get:o})})),a)if("string"==typeof a&&(a=e.from(i.stripHexPrefix(a),"hex")),e.isBuffer(a)&&(a=o.decode(a)),Array.isArray(a)){if(a.length>t._fields.length)throw new Error("wrong number of fields in data");a.forEach((function(e,r){t[t._fields[r]]=s.toBuffer(e)}))}else{if("object"!=typeof a)throw new Error("invalid data");var u=Object.keys(a);r.forEach((function(e){-1!==u.indexOf(e.name)&&(t[e.name]=a[e.name]),-1!==u.indexOf(e.alias)&&(t[e.alias]=a[e.alias])}))}}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-json-rpc-middleware>eth-sig-util>ethereumjs-abi>ethereumjs-util"}],[2789,{"./secp256k1v3-lib/der":2790,"./secp256k1v3-lib/index":2791,buffer:2438,"ethereum-cryptography/secp256k1":2873},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.ecdhUnsafe=r.ecdh=r.recover=r.verify=r.sign=r.signatureImportLax=r.signatureImport=r.signatureExport=r.signatureNormalize=r.publicKeyCombine=r.publicKeyTweakMul=r.publicKeyTweakAdd=r.publicKeyVerify=r.publicKeyConvert=r.publicKeyCreate=r.privateKeyTweakMul=r.privateKeyTweakAdd=r.privateKeyModInverse=r.privateKeyNegate=r.privateKeyImport=r.privateKeyExport=r.privateKeyVerify=void 0;var n=t("ethereum-cryptography/secp256k1"),i=t("./secp256k1v3-lib/index"),o=t("./secp256k1v3-lib/der");r.privateKeyVerify=function(t){return 32===t.length&&n.privateKeyVerify(Uint8Array.from(t))},r.privateKeyExport=function(t,e){if(32!==t.length)throw new RangeError("private key length is invalid");var r=i.privateKeyExport(t,e);return o.privateKeyExport(t,r,e)},r.privateKeyImport=function(t){if(null!==(t=o.privateKeyImport(t))&&32===t.length&&r.privateKeyVerify(t))return t;throw new Error("couldn't import from DER format")},r.privateKeyNegate=function(t){return e.from(n.privateKeyNegate(Uint8Array.from(t)))},r.privateKeyModInverse=function(t){if(32!==t.length)throw new Error("private key length is invalid");return e.from(i.privateKeyModInverse(Uint8Array.from(t)))},r.privateKeyTweakAdd=function(t,r){return e.from(n.privateKeyTweakAdd(Uint8Array.from(t),r))},r.privateKeyTweakMul=function(t,r){return e.from(n.privateKeyTweakMul(Uint8Array.from(t),Uint8Array.from(r)))},r.publicKeyCreate=function(t,r){return e.from(n.publicKeyCreate(Uint8Array.from(t),r))},r.publicKeyConvert=function(t,r){return e.from(n.publicKeyConvert(Uint8Array.from(t),r))},r.publicKeyVerify=function(t){return(33===t.length||65===t.length)&&n.publicKeyVerify(Uint8Array.from(t))},r.publicKeyTweakAdd=function(t,r,i){return e.from(n.publicKeyTweakAdd(Uint8Array.from(t),Uint8Array.from(r),i))},r.publicKeyTweakMul=function(t,r,i){return e.from(n.publicKeyTweakMul(Uint8Array.from(t),Uint8Array.from(r),i))},r.publicKeyCombine=function(t,r){var i=[];return t.forEach((function(t){i.push(Uint8Array.from(t))})),e.from(n.publicKeyCombine(i,r))},r.signatureNormalize=function(t){return e.from(n.signatureNormalize(Uint8Array.from(t)))},r.signatureExport=function(t){return e.from(n.signatureExport(Uint8Array.from(t)))},r.signatureImport=function(t){return e.from(n.signatureImport(Uint8Array.from(t)))},r.signatureImportLax=function(t){if(0===t.length)throw new RangeError("signature length is invalid");var e=o.signatureImportLax(t);if(null===e)throw new Error("couldn't parse DER signature");return i.signatureImport(e)},r.sign=function(t,r,i){if(null===i)throw new TypeError("options should be an Object");var o=undefined;if(i){if(o={},null===i.data)throw new TypeError("options.data should be a Buffer");if(i.data){if(32!=i.data.length)throw new RangeError("options.data length is invalid");o.data=new Uint8Array(i.data)}if(null===i.noncefn)throw new TypeError("options.noncefn should be a Function");i.noncefn&&(o.noncefn=function(t,r,n,o,s){var a=null!=n?e.from(n):null,u=null!=o?e.from(o):null,c=e.from("");return i.noncefn&&(c=i.noncefn(e.from(t),e.from(r),a,u,s)),new Uint8Array(c)})}var s=n.ecdsaSign(Uint8Array.from(t),Uint8Array.from(r),o);return{signature:e.from(s.signature),recovery:s.recid}},r.verify=function(t,e,r){return n.ecdsaVerify(Uint8Array.from(e),Uint8Array.from(t),r)},r.recover=function(t,r,i,o){return e.from(n.ecdsaRecover(Uint8Array.from(r),i,Uint8Array.from(t),o))},r.ecdh=function(t,r){return e.from(n.ecdh(Uint8Array.from(t),Uint8Array.from(r),{}))},r.ecdhUnsafe=function(t,r,n){if(33!==t.length&&65!==t.length)throw new RangeError("public key length is invalid");if(32!==r.length)throw new RangeError("private key length is invalid");return e.from(i.ecdhUnsafe(Uint8Array.from(t),Uint8Array.from(r),n))}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-json-rpc-middleware>eth-sig-util>ethereumjs-abi>ethereumjs-util"}],[2790,{buffer:2438},function(){with(this)return function(){"use strict";return function(t,e,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var e=t.from([48,129,211,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,133,48,129,130,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,33,2,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,36,3,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),n=t.from([48,130,1,19,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,165,48,129,162,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,65,4,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,72,58,218,119,38,163,196,101,93,164,251,252,14,17,8,168,253,23,180,72,166,133,84,25,156,71,208,143,251,16,212,184,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,68,3,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);r.privateKeyExport=function(r,i,o){void 0===o&&(o=!0);var s=t.from(o?e:n);return r.copy(s,o?8:9),i.copy(s,o?181:214),s},r.privateKeyImport=function(t){var e=t.length,r=0;if(e<r+1||48!==t[r])return null;if(e<(r+=1)+1||!(128&t[r]))return null;var n=127&t[r];if(n<1||n>2)return null;if(e<(r+=1)+n)return null;var i=t[r+n-1]|(n>1?t[r+n-2]<<8:0);return e<(r+=n)+i||e<r+3||2!==t[r]||1!==t[r+1]||1!==t[r+2]||e<(r+=3)+2||4!==t[r]||t[r+1]>32||e<r+2+t[r+1]?null:t.slice(r+2,r+2+t[r+1])},r.signatureImportLax=function(e){var r=t.alloc(32,0),n=t.alloc(32,0),i=e.length,o=0;if(48!==e[o++])return null;var s=e[o++];if(128&s&&(o+=s-128)>i)return null;if(2!==e[o++])return null;var a=e[o++];if(128&a){if(o+(s=a-128)>i)return null;for(;s>0&&0===e[o];o+=1,s-=1);for(a=0;s>0;o+=1,s-=1)a=(a<<8)+e[o]}if(a>i-o)return null;var u=o;if(o+=a,2!==e[o++])return null;var c=e[o++];if(128&c){if(o+(s=c-128)>i)return null;for(;s>0&&0===e[o];o+=1,s-=1);for(c=0;s>0;o+=1,s-=1)c=(c<<8)+e[o]}if(c>i-o)return null;var h=o;for(o+=c;a>0&&0===e[u];a-=1,u+=1);if(a>32)return null;var f=e.slice(u,u+a);for(f.copy(r,32-f.length);c>0&&0===e[h];c-=1,h+=1);if(c>32)return null;var l=e.slice(h,h+c);return l.copy(n,32-l.length),{r:r,s:n}}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-json-rpc-middleware>eth-sig-util>ethereumjs-abi>ethereumjs-util"}],[2791,{"bn.js":2394,buffer:2438,elliptic:2685},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n=t("bn.js"),i=new(0,t("elliptic").ec)("secp256k1"),o=i.curve;r.privateKeyExport=function(t,e){void 0===e&&(e=!0);var r=new n(t);if(r.ucmp(o.n)>=0)throw new Error("couldn't export to DER format");var a=i.g.mul(r);return s(a.getX(),a.getY(),e)},r.privateKeyModInverse=function(t){var r=new n(t);if(r.ucmp(o.n)>=0||r.isZero())throw new Error("private key range is invalid");return r.invm(o.n).toArrayLike(e,"be",32)},r.signatureImport=function(t){var r=new n(t.r);r.ucmp(o.n)>=0&&(r=new n(0));var i=new n(t.s);return i.ucmp(o.n)>=0&&(i=new n(0)),e.concat([r.toArrayLike(e,"be",32),i.toArrayLike(e,"be",32)])},r.ecdhUnsafe=function(t,e,r){void 0===r&&(r=!0);var a=i.keyFromPublic(t),u=new n(e);if(u.ucmp(o.n)>=0||u.isZero())throw new Error("scalar was invalid (zero or overflow)");var c=a.pub.mul(u);return s(c.getX(),c.getY(),r)};var s=function(t,r,n){var i;return n?((i=e.alloc(33))[0]=r.isOdd()?3:2,t.toArrayLike(e,"be",32).copy(i,1)):((i=e.alloc(65))[0]=4,t.toArrayLike(e,"be",32).copy(i,1),r.toArrayLike(e,"be",32).copy(i,33)),i}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-json-rpc-middleware>eth-sig-util>ethereumjs-abi>ethereumjs-util"}],[2792,{"./bytes":2784,"./hash":2786,"./secp256k1v3-adapter":2789,"bn.js":2394,buffer:2438},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.hashPersonalMessage=r.isValidSignature=r.fromRpcSig=r.toRpcSig=r.ecrecover=r.ecsign=void 0;var n=t("./secp256k1v3-adapter"),i=t("bn.js"),o=t("./bytes"),s=t("./hash");function a(t,e){return e?t-(2*e+35):t-27}function u(t){return 0===t||1===t}r.ecsign=function(t,e,r){var i=n.sign(t,e),o=i.recovery;return{r:i.signature.slice(0,32),s:i.signature.slice(32,64),v:r?o+(2*r+35):o+27}},r.ecrecover=function(t,r,i,s,c){var h=e.concat([o.setLength(i,32),o.setLength(s,32)],64),f=a(r,c);if(!u(f))throw new Error("Invalid signature v value");var l=n.recover(t,h,f);return n.publicKeyConvert(l,!1).slice(1)},r.toRpcSig=function(t,r,n,i){if(!u(a(t,i)))throw new Error("Invalid signature v value");return o.bufferToHex(e.concat([o.setLengthLeft(r,32),o.setLengthLeft(n,32),o.toBuffer(t)]))},r.fromRpcSig=function(t){var e=o.toBuffer(t);if(65!==e.length)throw new Error("Invalid signature length");var r=e[64];return r<27&&(r+=27),{v:r,r:e.slice(0,32),s:e.slice(32,64)}},r.isValidSignature=function(t,e,r,n,o){void 0===n&&(n=!0);var s=new i("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),c=new i("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16);if(32!==e.length||32!==r.length)return!1;if(!u(a(t,o)))return!1;var h=new i(e),f=new i(r);return!(h.isZero()||h.gt(c)||f.isZero()||f.gt(c))&&(!n||1!==f.cmp(s))},r.hashPersonalMessage=function(t){var r=e.from("Ethereum Signed Message:\n"+t.length.toString(),"utf-8");return s.keccak(e.concat([r,t]))}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-json-rpc-middleware>eth-sig-util>ethereumjs-abi>ethereumjs-util"}],[2793,{"./secp256k1-adapter":2794,assert:2066,"bn.js":2394,"create-hash":2553,"ethereum-cryptography/keccak":2841,"ethjs-util":2797,rlp:6613,"safe-buffer":6615},function(){with(this)return function(){"use strict";return function(t,e,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=t("ethereum-cryptography/keccak"),o=i.keccak224,s=i.keccak384,a=i.keccak256,u=i.keccak512,c=t("./secp256k1-adapter"),h=t("assert"),f=t("rlp"),l=t("bn.js"),d=t("create-hash"),p=t("safe-buffer").Buffer;Object.assign(r,t("ethjs-util")),r.MAX_INTEGER=new l("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16),r.TWO_POW256=new l("10000000000000000000000000000000000000000000000000000000000000000",16),r.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",r.SHA3_NULL_S=r.KECCAK256_NULL_S,r.KECCAK256_NULL=p.from(r.KECCAK256_NULL_S,"hex"),r.SHA3_NULL=r.KECCAK256_NULL,r.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",r.SHA3_RLP_ARRAY_S=r.KECCAK256_RLP_ARRAY_S,r.KECCAK256_RLP_ARRAY=p.from(r.KECCAK256_RLP_ARRAY_S,"hex"),r.SHA3_RLP_ARRAY=r.KECCAK256_RLP_ARRAY,r.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",r.SHA3_RLP_S=r.KECCAK256_RLP_S,r.KECCAK256_RLP=p.from(r.KECCAK256_RLP_S,"hex"),r.SHA3_RLP=r.KECCAK256_RLP,r.BN=l,r.rlp=f,r.secp256k1=c,r.zeros=function(t){return p.allocUnsafe(t).fill(0)},r.zeroAddress=function(){var t=r.zeros(20);return r.bufferToHex(t)},r.setLengthLeft=r.setLength=function(t,e,n){var i=r.zeros(e);return t=r.toBuffer(t),n?t.length<e?(t.copy(i),i):t.slice(0,e):t.length<e?(t.copy(i,e-t.length),i):t.slice(-e)},r.setLengthRight=function(t,e){return r.setLength(t,e,!0)},r.unpad=r.stripZeros=function(t){for(var e=(t=r.stripHexPrefix(t))[0];t.length>0&&"0"===e.toString();)e=(t=t.slice(1))[0];return t},r.toBuffer=function(t){if(!p.isBuffer(t))if(Array.isArray(t))t=p.from(t);else if("string"==typeof t)t=r.isHexString(t)?p.from(r.padToEven(r.stripHexPrefix(t)),"hex"):p.from(t);else if("number"==typeof t)t=r.intToBuffer(t);else if(null===t||t===undefined)t=p.allocUnsafe(0);else if(l.isBN(t))t=t.toArrayLike(p);else{if(!t.toArray)throw new Error("invalid type");t=p.from(t.toArray())}return t},r.bufferToInt=function(t){return new l(r.toBuffer(t)).toNumber()},r.bufferToHex=function(t){return"0x"+(t=r.toBuffer(t)).toString("hex")},r.fromSigned=function(t){return new l(t).fromTwos(256)},r.toUnsigned=function(t){return p.from(t.toTwos(256).toArray())},r.keccak=function(t,e){switch(t=r.toBuffer(t),e||(e=256),e){case 224:return o(t);case 256:return a(t);case 384:return s(t);case 512:return u(t);default:throw new Error("Invald algorithm: keccak"+e)}},r.keccak256=function(t){return r.keccak(t)},r.sha3=r.keccak,r.sha256=function(t){return t=r.toBuffer(t),d("sha256").update(t).digest()},r.ripemd160=function(t,e){t=r.toBuffer(t);var n=d("rmd160").update(t).digest();return!0===e?r.setLength(n,32):n},r.rlphash=function(t){return r.keccak(f.encode(t))},r.isValidPrivate=function(t){return c.privateKeyVerify(t)},r.isValidPublic=function(t,e){return 64===t.length?c.publicKeyVerify(p.concat([p.from([4]),t])):!!e&&c.publicKeyVerify(t)},r.pubToAddress=r.publicToAddress=function(t,e){return t=r.toBuffer(t),e&&64!==t.length&&(t=c.publicKeyConvert(t,!1).slice(1)),h(64===t.length),r.keccak(t).slice(-20)};var m=r.privateToPublic=function(t){return t=r.toBuffer(t),c.publicKeyCreate(t,!1).slice(1)};r.importPublic=function(t){return 64!==(t=r.toBuffer(t)).length&&(t=c.publicKeyConvert(t,!1).slice(1)),t},r.ecsign=function(t,e){var r=c.sign(t,e),n={};return n.r=r.signature.slice(0,32),n.s=r.signature.slice(32,64),n.v=r.recovery+27,n},r.hashPersonalMessage=function(t){var e=r.toBuffer("Ethereum Signed Message:\n"+t.length.toString());return r.keccak(p.concat([e,t]))},r.ecrecover=function(t,e,n,i){var o=p.concat([r.setLength(n,32),r.setLength(i,32)],64),s=e-27;if(0!==s&&1!==s)throw new Error("Invalid signature v value");var a=c.recover(t,o,s);return c.publicKeyConvert(a,!1).slice(1)},r.toRpcSig=function(t,e,n){if(27!==t&&28!==t)throw new Error("Invalid recovery id");return r.bufferToHex(p.concat([r.setLengthLeft(e,32),r.setLengthLeft(n,32),r.toBuffer(t-27)]))},r.fromRpcSig=function(t){if(65!==(t=r.toBuffer(t)).length)throw new Error("Invalid signature length");var e=t[64];return e<27&&(e+=27),{v:e,r:t.slice(0,32),s:t.slice(32,64)}},r.privateToAddress=function(t){return r.publicToAddress(m(t))},r.isValidAddress=function(t){return/^0x[0-9a-fA-F]{40}$/.test(t)},r.isZeroAddress=function(t){return r.zeroAddress()===r.addHexPrefix(t)},r.toChecksumAddress=function(t){t=r.stripHexPrefix(t).toLowerCase();for(var e=r.keccak(t).toString("hex"),n="0x",i=0;i<t.length;i++)parseInt(e[i],16)>=8?n+=t[i].toUpperCase():n+=t[i];return n},r.isValidChecksumAddress=function(t){return r.isValidAddress(t)&&r.toChecksumAddress(t)===t},r.generateAddress=function(t,e){return t=r.toBuffer(t),e=(e=new l(e)).isZero()?null:p.from(e.toArray()),r.rlphash([t,e]).slice(-20)},r.isPrecompiled=function(t){var e=r.unpad(t);return 1===e.length&&e[0]>=1&&e[0]<=8},r.addHexPrefix=function(t){return"string"!=typeof t||r.isHexPrefixed(t)?t:"0x"+t},r.isValidSignature=function(t,e,r,n){var i=new l("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),o=new l("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16);return 32===e.length&&32===r.length&&((27===t||28===t)&&(e=new l(e),r=new l(r),!(e.isZero()||e.gt(o)||r.isZero()||r.gt(o))&&(!1!==n||1!==new l(r).cmp(i))))},r.baToJSON=function(t){if(p.isBuffer(t))return"0x"+t.toString("hex");if(t instanceof Array){for(var e=[],n=0;n<t.length;n++)e.push(r.baToJSON(t[n]));return e}},r.defineProperties=function(t,e,i){if(t.raw=[],t._fields=[],t.toJSON=function(e){if(e){var n={};return t._fields.forEach((function(e){n[e]="0x"+t[e].toString("hex")})),n}return r.baToJSON(this.raw)},t.serialize=function(){return f.encode(t.raw)},e.forEach((function(e,n){function i(){return t.raw[n]}function o(i){"00"!==(i=r.toBuffer(i)).toString("hex")||e.allowZero||(i=p.allocUnsafe(0)),e.allowLess&&e.length?(i=r.stripZeros(i),h(e.length>=i.length,"The field "+e.name+" must not have more "+e.length+" bytes")):e.allowZero&&0===i.length||!e.length||h(e.length===i.length,"The field "+e.name+" must have byte length of "+e.length),t.raw[n]=i}t._fields.push(e.name),Object.defineProperty(t,e.name,{enumerable:!0,configurable:!0,get:i,set:o}),e.default&&(t[e.name]=e.default),e.alias&&Object.defineProperty(t,e.alias,{enumerable:!1,configurable:!0,set:o,get:i})})),i)if("string"==typeof i&&(i=p.from(r.stripHexPrefix(i),"hex")),p.isBuffer(i)&&(i=f.decode(i)),Array.isArray(i)){if(i.length>t._fields.length)throw new Error("wrong number of fields in data");i.forEach((function(e,n){t[t._fields[n]]=r.toBuffer(e)}))}else{if("object"!==(void 0===i?"undefined":n(i)))throw new Error("invalid data");var o=Object.keys(i);e.forEach((function(e){-1!==o.indexOf(e.name)&&(t[e.name]=i[e.name]),-1!==o.indexOf(e.alias)&&(t[e.alias]=i[e.alias])}))}}}}},{package:"eth-json-rpc-middleware>eth-sig-util>ethereumjs-util"}],[2794,{"./secp256k1-lib/der":2795,"./secp256k1-lib/index":2796,buffer:2438,"ethereum-cryptography/secp256k1":2873},function(){with(this)return function(){"use strict";return function(t,e,r){(function(r){(function(){var n=t("ethereum-cryptography/secp256k1"),i=t("./secp256k1-lib/index"),o=t("./secp256k1-lib/der"),s=function(t){return 32===t.length&&n.privateKeyVerify(Uint8Array.from(t))};e.exports={privateKeyVerify:s,privateKeyExport:function(t,e){if(32!==t.length)throw new RangeError("private key length is invalid");var r=i.privateKeyExport(t,e);return o.privateKeyExport(t,r,e)},privateKeyImport:function(t){if(null!==(t=o.privateKeyImport(t))&&32===t.length&&s(t))return t;throw new Error("couldn't import from DER format")},privateKeyNegate:function(t){return r.from(n.privateKeyNegate(Uint8Array.from(t)))},privateKeyModInverse:function(t){if(32!==t.length)throw new Error("private key length is invalid");return r.from(i.privateKeyModInverse(Uint8Array.from(t)))},privateKeyTweakAdd:function(t,e){return r.from(n.privateKeyTweakAdd(Uint8Array.from(t),e))},privateKeyTweakMul:function(t,e){return r.from(n.privateKeyTweakMul(Uint8Array.from(t),Uint8Array.from(e)))},publicKeyCreate:function(t,e){return r.from(n.publicKeyCreate(Uint8Array.from(t),e))},publicKeyConvert:function(t,e){return r.from(n.publicKeyConvert(Uint8Array.from(t),e))},publicKeyVerify:function(t){return(33===t.length||65===t.length)&&n.publicKeyVerify(Uint8Array.from(t))},publicKeyTweakAdd:function(t,e,i){return r.from(n.publicKeyTweakAdd(Uint8Array.from(t),Uint8Array.from(e),i))},publicKeyTweakMul:function(t,e,i){return r.from(n.publicKeyTweakMul(Uint8Array.from(t),Uint8Array.from(e),i))},publicKeyCombine:function(t,e){var i=[];return t.forEach((function(t){i.push(Uint8Array.from(t))})),r.from(n.publicKeyCombine(i,e))},signatureNormalize:function(t){return r.from(n.signatureNormalize(Uint8Array.from(t)))},signatureExport:function(t){return r.from(n.signatureExport(Uint8Array.from(t)))},signatureImport:function(t){return r.from(n.signatureImport(Uint8Array.from(t)))},signatureImportLax:function(t){if(0===t.length)throw new RangeError("signature length is invalid");var e=o.signatureImportLax(t);if(null===e)throw new Error("couldn't parse DER signature");return i.signatureImport(e)},sign:function(t,e,i){if(null===i)throw new TypeError("options should be an Object");var o=void 0;if(i){if(o={},null===i.data)throw new TypeError("options.data should be a Buffer");if(i.data){if(32!==i.data.length)throw new RangeError("options.data length is invalid");o.data=new Uint8Array(i.data)}if(null===i.noncefn)throw new TypeError("options.noncefn should be a Function");i.noncefn&&(o.noncefn=function(t,e,n,o,s){var a=null!=n?r.from(n):null,u=null!=o?r.from(o):null,c=r.from("");return i.noncefn&&(c=i.noncefn(r.from(t),r.from(e),a,u,s)),Uint8Array.from(c)})}var s=n.ecdsaSign(Uint8Array.from(t),Uint8Array.from(e),o);return{signature:r.from(s.signature),recovery:s.recid}},verify:function(t,e,r){return n.ecdsaVerify(Uint8Array.from(e),Uint8Array.from(t),r)},recover:function(t,e,i,o){return r.from(n.ecdsaRecover(Uint8Array.from(e),i,Uint8Array.from(t),o))},ecdh:function(t,e){return r.from(n.ecdh(Uint8Array.from(t),Uint8Array.from(e),{}))},ecdhUnsafe:function(t,e,n){if(33!==t.length&&65!==t.length)throw new RangeError("public key length is invalid");if(32!==e.length)throw new RangeError("private key length is invalid");return r.from(i.ecdhUnsafe(Uint8Array.from(t),Uint8Array.from(e),n))}}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-json-rpc-middleware>eth-sig-util>ethereumjs-util"}],[2795,{buffer:2438},function(){with(this)return function(){"use strict";return function(t,e,r){(function(t){(function(){var e=t.from([48,129,211,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,133,48,129,130,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,33,2,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,36,3,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),n=t.from([48,130,1,19,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,165,48,129,162,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,65,4,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,72,58,218,119,38,163,196,101,93,164,251,252,14,17,8,168,253,23,180,72,166,133,84,25,156,71,208,143,251,16,212,184,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,68,3,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);r.privateKeyExport=function(r,i,o){var s=t.from(o?e:n);return r.copy(s,o?8:9),i.copy(s,o?181:214),s},r.privateKeyImport=function(t){var e=t.length,r=0;if(e<r+1||48!==t[r])return null;if(e<(r+=1)+1||!(128&t[r]))return null;var n=127&t[r];if(n<1||n>2)return null;if(e<(r+=1)+n)return null;var i=t[r+n-1]|(n>1?t[r+n-2]<<8:0);return e<(r+=n)+i||e<r+3||2!==t[r]||1!==t[r+1]||1!==t[r+2]||e<(r+=3)+2||4!==t[r]||t[r+1]>32||e<r+2+t[r+1]?null:t.slice(r+2,r+2+t[r+1])},r.signatureImportLax=function(e){var r=t.alloc(32,0),n=t.alloc(32,0),i=e.length,o=0;if(48!==e[o++])return null;var s=e[o++];if(128&s&&(o+=s-128)>i)return null;if(2!==e[o++])return null;var a=e[o++];if(128&a){if(o+(s=a-128)>i)return null;for(;s>0&&0===e[o];o+=1,s-=1);for(a=0;s>0;o+=1,s-=1)a=(a<<8)+e[o]}if(a>i-o)return null;var u=o;if(o+=a,2!==e[o++])return null;var c=e[o++];if(128&c){if(o+(s=c-128)>i)return null;for(;s>0&&0===e[o];o+=1,s-=1);for(c=0;s>0;o+=1,s-=1)c=(c<<8)+e[o]}if(c>i-o)return null;var h=o;for(o+=c;a>0&&0===e[u];a-=1,u+=1);if(a>32)return null;var f=e.slice(u,u+a);for(f.copy(r,32-f.length);c>0&&0===e[h];c-=1,h+=1);if(c>32)return null;var l=e.slice(h,h+c);return l.copy(n,32-l.length),{r:r,s:n}}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-json-rpc-middleware>eth-sig-util>ethereumjs-util"}],[2796,{"bn.js":2394,buffer:2438,elliptic:2685},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){var n=t("bn.js"),i=new(0,t("elliptic").ec)("secp256k1"),o=i.curve;r.privateKeyExport=function(t,e){var r=new n(t);if(r.ucmp(o.n)>=0)throw new Error("couldn't export to DER format");var a=i.g.mul(r);return s(a.getX(),a.getY(),e)},r.privateKeyModInverse=function(t){var r=new n(t);if(r.ucmp(o.n)>=0||r.isZero())throw new Error("private key range is invalid");return r.invm(o.n).toArrayLike(e,"be",32)},r.signatureImport=function(t){var r=new n(t.r);r.ucmp(o.n)>=0&&(r=new n(0));var i=new n(t.s);return i.ucmp(o.n)>=0&&(i=new n(0)),e.concat([r.toArrayLike(e,"be",32),i.toArrayLike(e,"be",32)])},r.ecdhUnsafe=function(t,e,r){var a=i.keyFromPublic(t),u=new n(e);if(u.ucmp(o.n)>=0||u.isZero())throw new Error("scalar was invalid (zero or overflow)");var c=a.pub.mul(u);return s(c.getX(),c.getY(),r)};var s=function(t,r,n){var i=void 0;return n?((i=e.alloc(33))[0]=r.isOdd()?3:2,t.toArrayLike(e,"be",32).copy(i,1)):((i=e.alloc(65))[0]=4,t.toArrayLike(e,"be",32).copy(i,1),r.toArrayLike(e,"be",32).copy(i,33)),i}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-json-rpc-middleware>eth-sig-util>ethereumjs-util"}],[2797,{buffer:2438,"is-hex-prefixed":5592,"strip-hex-prefix":6784},function(){with(this)return function(){"use strict";return function(t,e,r){(function(r){(function(){var n=t("is-hex-prefixed"),i=t("strip-hex-prefix");function o(t){var e=t;if("string"!=typeof e)throw new Error("[ethjs-util] while padding to even, value must be string, is currently "+typeof e+", while padToEven.");return e.length%2&&(e="0"+e),e}function s(t){return"0x"+t.toString(16)}e.exports={arrayContainsArray:function(t,e,r){if(!0!==Array.isArray(t))throw new Error("[ethjs-util] method arrayContainsArray requires input 'superset' to be an array got type '"+typeof t+"'");if(!0!==Array.isArray(e))throw new Error("[ethjs-util] method arrayContainsArray requires input 'subset' to be an array got type '"+typeof e+"'");return e[Boolean(r)?"some":"every"]((function(e){return t.indexOf(e)>=0}))},intToBuffer:function(t){var e=s(t);return new r(o(e.slice(2)),"hex")},getBinarySize:function(t){if("string"!=typeof t)throw new Error("[ethjs-util] while getting binary size, method getBinarySize requires input 'str' to be type String, got '"+typeof t+"'.");return r.byteLength(t,"utf8")},isHexPrefixed:n,stripHexPrefix:i,padToEven:o,intToHex:s,fromAscii:function(t){for(var e="",r=0;r<t.length;r++){var n=t.charCodeAt(r).toString(16);e+=n.length<2?"0"+n:n}return"0x"+e},fromUtf8:function(t){return"0x"+o(new r(t,"utf8").toString("hex")).replace(/^0+|0+$/g,"")},toAscii:function(t){var e="",r=0,n=t.length;for("0x"===t.substring(0,2)&&(r=2);r<n;r+=2){var i=parseInt(t.substr(r,2),16);e+=String.fromCharCode(i)}return e},toUtf8:function(t){return new r(o(i(t).replace(/^0+|0+$/g,"")),"hex").toString("utf8")},getKeys:function(t,e,r){if(!Array.isArray(t))throw new Error("[ethjs-util] method getKeys expecting type Array as 'params' input, got '"+typeof t+"'");if("string"!=typeof e)throw new Error("[ethjs-util] method getKeys expecting type String for input 'key' got '"+typeof e+"'.");for(var n=[],i=0;i<t.length;i++){var o=t[i][e];if(r&&!o)o="";else if("string"!=typeof o)throw new Error("invalid abi");n.push(o)}return n},isHexString:function(t,e){return!("string"!=typeof t||!t.match(/^0x[0-9A-Fa-f]*$/))&&(!e||t.length===2+2*e)}}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-json-rpc-middleware>eth-sig-util>ethereumjs-util>ethjs-util"}],[2798,{},function(){with(this)return function(){"use strict";return function(t,e,r){const n=(t,e)=>function(){const r=e.promiseModule,n=new Array(arguments.length);for(let t=0;t<arguments.length;t++)n[t]=arguments[t];return new r(((r,i)=>{e.errorFirst?n.push((function(t,n){if(e.multiArgs){const e=new Array(arguments.length-1);for(let t=1;t<arguments.length;t++)e[t-1]=arguments[t];t?(e.unshift(t),i(e)):r(e)}else t?i(t):r(n)})):n.push((function(t){if(e.multiArgs){const t=new Array(arguments.length-1);for(let e=0;e<arguments.length;e++)t[e]=arguments[e];r(t)}else r(t)})),t.apply(this,n)}))};e.exports=(t,e)=>{e=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},e);const r=t=>{const r=e=>"string"==typeof e?t===e:e.test(t);return e.include?e.include.some(r):!e.exclude.some(r)};let i;i="function"==typeof t?function(){return e.excludeMain?t.apply(this,arguments):n(t,e).apply(this,arguments)}:Object.create(Object.getPrototypeOf(t));for(const o in t){const s=t[o];i[o]="function"==typeof s&&r(o)?n(s,e):s}return i}}}},{package:"eth-json-rpc-middleware>pify"}],[28,{"../../../../../shared/constants/permissions":7061,"@metamask/rpc-methods":1474,"@metamask/snap-controllers":1587},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.buildSnapEndowmentSpecifications=void 0,r.buildSnapRestrictedMethodSpecifications=function(t){return Object.values(i.restrictedMethodPermissionBuilders).reduce(((e,{targetKey:r,specificationBuilder:n,methodHooks:s})=>(o.ExcludedSnapPermissions.has(r)||(e[r]=n({methodHooks:(0,i.selectHooks)(t,s)})),e)),{})};var n=t("@metamask/snap-controllers"),i=t("@metamask/rpc-methods"),o=t("../../../../../shared/constants/permissions");r.buildSnapEndowmentSpecifications=()=>Object.values(n.endowmentPermissionBuilders).reduce(((t,{targetKey:e,specificationBuilder:r})=>(o.ExcludedSnapEndowments.has(e)||(t[e]=r()),t)),{})}}},{package:"$root$"}],[2800,{"@ethereumjs/tx":2804,"@ethereumjs/util":636,"bn.js":2809,buffer:2438,crypto:2560,events:2439,"gridplus-sdk":5101,rlp:2810},function(){with(this)return function(){"use strict";return function(t,e,r){(function(r){(function(){const n=t("crypto"),i=t("events").EventEmitter,o=t("bn.js"),s=t("gridplus-sdk"),a=t("@ethereumjs/tx"),{addHexPrefix:u}=t("@ethereumjs/util"),c=t("rlp"),h="Lattice Hardware",f=12e4;class l extends i{constructor(t={}){super(),this.type=h,this._resetDefaults(),this.deserialize(t)}async deserialize(t={}){t.hdPath&&(this.hdPath=t.hdPath),t.creds&&(this.creds=t.creds),t.accounts&&(this.accounts=t.accounts),t.accountIndices&&(this.accountIndices=t.accountIndices),t.accountOpts&&(this.accountOpts=t.accountOpts),t.walletUID&&(this.walletUID=t.walletUID),t.name&&(this.appName=t.name),t.appName&&(this.appName=t.appName),t.network&&(this.network=t.network),t.page&&(this.page=t.page)}setHdPath(t){this.hdPath=t}async serialize(){return{creds:this.creds,accounts:this.accounts,accountIndices:this.accountIndices,accountOpts:this.accountOpts,walletUID:this.walletUID,appName:this.appName,name:this.name,network:this.network,page:this.page,hdPath:this.hdPath}}isUnlocked(){return!!this._getCurrentWalletUID()&&!!this.sdkSession}async unlock(t=!1){if(this.isUnlocked())return"Unlocked";const e=await this._getCreds();e&&(this.creds.deviceID=e.deviceID,this.creds.password=e.password,this.creds.endpoint=e.endpoint||null);return await this._initSession()&&t||await this._connect(),"Unlocked"}async addAccounts(t=1){if(t<=0)throw new Error("Number of accounts to add must be a positive number.");await this.unlock();const e=await this._fetchAddresses(t,this.unlockedAccount),r=this._getCurrentWalletUID();if(!r)throw await this._connect(),new Error("No active wallet found in Lattice. Please retry.");return e.forEach(((t,e)=>{let n=!1;for(let e=0;e<this.accounts.length;e++)this.accounts[e]===t&&this.accountOpts[e].walletUID===r&&this.accountOpts[e].hdPath===this.hdPath&&(n=!0);n||(this.accounts.push(t),this.accountIndices.push(this.unlockedAccount+e),this.accountOpts.push({walletUID:r,hdPath:this.hdPath}))})),this.accounts}async getAccounts(){return this.accounts?[...this.accounts]:[]}async signTransaction(t,e){let r,n;const i=e.toJSON();i.type=e._type||null;const h=await this._findSignerIdx(t),f=function(t){if(t&&t.common&&"function"==typeof t.common.chainIdBN)return t.common.chainIdBN();if(t&&t.chainId)return new o(t.chainId);return new o(1)}(e).toNumber(),l=this.sdkSession.getFwVersion(),d=this.accountIndices[h],{hdPath:p}=this.accountOpts[h],m=this._getHDPathIndices(p,d);if(0===l.major&&l.minor<=11)throw new Error("Please update Lattice firmware.");if(l.major>0||l.minor>=15){const t={payload:e._type?e.getMessageToSign(!1):c.encode(e.getMessageToSign(!1)),curveType:s.Constants.SIGNING.CURVES.SECP256K1,hashType:s.Constants.SIGNING.HASHES.KECCAK256,encodingType:s.Constants.SIGNING.ENCODINGS.EVM,signerPath:m},n=l.major>0||l.minor>=16,{def:i}=await s.Utils.fetchCalldataDecoder(e.data,e.to,f,n);i&&(t.decoder=i),r=await this.sdkSession.sign({data:t})}else{const t=function(t){let e;try{switch(e={nonce:`0x${t.nonce.toString("hex")}`||0,gasLimit:`0x${t.gasLimit.toString("hex")}`,to:t.to?t.to.toString("hex"):null,value:`0x${t.value.toString("hex")}`,data:0===t.data.length?null:`0x${t.data.toString("hex")}`},t._type){case 2:if(null===t.maxPriorityFeePerGas||null===t.maxFeePerGas||t.maxPriorityFeePerGas===undefined||t.maxFeePerGas===undefined)throw new Error("`maxPriorityFeePerGas` and `maxFeePerGas` must be included for EIP1559 transactions.");e.maxPriorityFeePerGas=`0x${t.maxPriorityFeePerGas.toString("hex")}`,e.maxFeePerGas=`0x${t.maxFeePerGas.toString("hex")}`,e.accessList=t.accessList||[],e.type=2;break;case 1:e.accessList=t.accessList||[],e.gasPrice=`0x${t.gasPrice.toString("hex")}`,e.type=1;break;default:e.gasPrice=`0x${t.gasPrice.toString("hex")}`,e.type=null}}catch(t){throw new Error("Failed to build transaction.")}return e}(e);t.chainId=f,t.signerPath=m,r=await this.sdkSession.sign({currency:"ETH",data:t})}if(!r.sig||!r.sig.r||!r.sig.s)throw new Error("No signature returned.");n=r.sig.v===undefined?s.Utils.getV(e,r):0===r.sig.v.length?"0":r.sig.v.toString("hex"),i.r=u(r.sig.r.toString("hex")),i.s=u(r.sig.s.toString("hex")),i.v=u(n);if(null===await this._accountIdxInCurrentWallet(t))throw new Error("Wrong account. Please change your Lattice wallet or "+"switch to an account on your current active wallet.");return a.TransactionFactory.fromTxData(i,{common:e.common,freeze:Object.isFrozen(e)})}async signPersonalMessage(t,e){return this.signMessage(t,{payload:e,protocol:"signPersonal"})}async signTypedData(t,e,r){if(r.version&&"V4"!==r.version&&"V3"!==r.version)throw new Error(`Only signTypedData V3 and V4 messages (EIP712) are supported. Got version ${r.version}`);return this.signMessage(t,{payload:e,protocol:"eip712"})}async signMessage(t,e){const r=await this._findSignerIdx(t);let{payload:n,protocol:i}=e;n&&i||(n=e,i="signPersonal");const o=this.accountIndices[r],s=this.accountOpts[r].hdPath,a={currency:"ETH_MSG",data:{protocol:i,payload:n,signerPath:this._getHDPathIndices(s,o)}},u=await this.sdkSession.sign(a);if(!u.sig)throw new Error("No signature returned");let c;try{c=u.sig.v.toString("hex"),c.length<2&&(c=`0${c}`)}catch(t){throw new Error("Invalid signature format returned.")}if(null===await this._accountIdxInCurrentWallet(t))throw new Error("Wrong account. Please change your Lattice wallet or "+"switch to an account on your current active wallet.");return`0x${u.sig.r}${u.sig.s}${c}`}async exportAccount(t){throw new Error("exportAccount not supported by this device")}removeAccount(t){this.accounts.forEach(((e,r)=>{if(e.toLowerCase()===t.toLowerCase())return this.accounts.splice(r,1),this.accountIndices.splice(r,1),void this.accountOpts.splice(r,1)}))}async getFirstPage(){return this.page=0,this._getPage(0)}async getNextPage(){return this._getPage(1)}async getPreviousPage(){return this._getPage(-1)}setAccountToUnlock(t){this.unlockedAccount=parseInt(t,10)}forgetDevice(){this._resetDefaults()}async _findSignerIdx(t){const e=this.isUnlocked();await this.unlock(!0);let r=await this._accountIdxInCurrentWallet(t);if(null!==r)return r;if(e&&(await this._connect(),r=await this._accountIdxInCurrentWallet(t),null!==r))return r;throw new Error("Account not found in active Lattice wallet. Please switch.")}async _accountIdxInCurrentWallet(t){const e=await this._findAccountByAddress(t),{walletUID:r}=this.accountOpts[e],n=this.sdkSession.getActiveWallet();if(!n)throw this._connect(),new Error("No active wallet in Lattice.");const i=n.uid.toString("hex");return r.toString("hex")===i?e:null}async _findAccountByAddress(t){const e=await this.getAccounts();let r=-1;if(e.forEach(((e,n)=>{t.toLowerCase()===e.toLowerCase()&&(r=n)})),r<0)throw new Error("Signer not present");return r}_getHDPathIndices(t,e=0){const r=t.split("/").slice(1),n=[];let i=!1;if(r.forEach((t=>{const r="'"===t[t.length-1];let o=r?2147483648:0;t.indexOf("x")>-1?(o+=e,i=!0):o+=Number(r?t.slice(0,t.length-1):t),n.push(o)})),!1===i&&n.push(e),n.length>5)throw new Error("Only HD paths with up to 5 indices are allowed.");return n}_resetDefaults(){this.accounts=[],this.accountIndices=[],this.accountOpts=[],this.isLocked=!0,this.creds={deviceID:null,password:null,endpoint:null},this.walletUID=null,this.sdkSession=null,this.page=0,this.unlockedAccount=0,this.network=null,this.hdPath="m/44'/60'/0'/0/x"}async _openConnectorTab(t){try{const e=window.open(t);if(e)return{chromium:e};if(browser&&browser.tabs&&browser.tabs.create){return{firefox:await browser.tabs.create({url:t})}}throw new Error("Unknown browser context. Cannot open Lattice connector.")}catch(t){throw new Error("Failed to open Lattice connector.")}}async _findTabById(t){return(await browser.tabs.query({})).find((e=>e.id===t))}_getCreds(){return new Promise(((t,e)=>{if(this._hasCreds())return t();const n=this.appName?this.appName:"Unknown",i="https://lattice.gridplus.io",o=`${i}?keyring=${n}&forceLogin=true`;let s;function a(r){if(r.origin===i)try{clearInterval(s);const n=JSON.parse(r.data);return n.deviceID&&n.password?t(n):e(new Error("Invalid credentials returned from Lattice."))}catch(t){return e(t)}}this._openConnectorTab(o).then((n=>{if(n.chromium)window.addEventListener("message",a,!1),s=setInterval((()=>{if(n.chromium.closed)return clearInterval(s),e(new Error("Lattice connector closed."))}),500);else if(n.firefox){const i="&loginCache=";s=setInterval((()=>{this._findTabById(n.firefox.id).then((n=>{if(!n||!n.url)return e(new Error("Lattice connector closed."));const o=n.url.indexOf(i);if(o<0)return;const a=o+i.length;clearInterval(s);try{const i=r.from(n.url.slice(a),"base64").toString();browser.tabs.remove(n.id).then((()=>{const r=JSON.parse(i);return r.deviceID&&r.password?t(r):e(new Error("Invalid credentials returned from Lattice."))}))}catch(t){return e("Failed to get login data from Lattice. Please try again.")}}))}),500)}}))}))}async _connect(){try{return this.sdkSession.timeout=2e4,this.sdkSession.connect(this.creds.deviceID)}finally{this.sdkSession.timeout=f}}async _initSession(){if(this.isUnlocked())return;let t="https://signing.gridpl.us";this.creds.endpoint&&(t=this.creds.endpoint);let e={name:this.appName,baseUrl:t,timeout:f,privKey:this._genSessionKey(),network:this.network,skipRetryOnWrongWallet:!0};return this.sdkSession=new s.Client(e),!!e.stateData}async _fetchAddresses(t=1,e=0,r=[]){if(!this.isUnlocked())throw new Error("No connection to Lattice. Cannot fetch addresses.");return this.__fetchAddresses(t,e)}async __fetchAddresses(t=1,e=0,r=[]){if(0===t)return r;const n=this._hdPathHasInternalVarIdx(),i={currency:"ETH",startPath:this._getHDPathIndices(this.hdPath,e),n:n?1:t},o=await this.sdkSession.getAddresses(i);if(o.length<1)throw new Error("No addresses returned");return n?await this.__fetchAddresses(t-1,e+1,r.concat(o)):o}async _getPage(t=0){try{this.page+=t,this.page<0&&(this.page=0);const e=5*this.page;await this.unlock();const r=await this._fetchAddresses(5,e);return r.map(((t,r)=>({address:t,balance:null,index:e+r})))}catch(t){try{if(!await this._connect())throw new Error("NOT_PAIRED");return await this._getPage(0)}catch(t){throw 0===this.accounts.length&&this.forgetDevice(),new Error("Failed to get accounts. Please forget the device and try again. "+"Make sure you do not have a locked SafeCard inserted.")}}}_hasCreds(){return null!==this.creds.deviceID&&null!==this.creds.password&&this.appName}_genSessionKey(){if(this.name&&!this.appName&&(this.appName=this.name),!this._hasCreds())throw new Error("No credentials -- cannot create session key!");const t=r.concat([r.from(this.creds.password),r.from(this.creds.deviceID),r.from(this.appName)]);return n.createHash("sha256").update(t).digest()}_hdPathHasInternalVarIdx(){const t=this.hdPath.split("/").slice(1);for(let e=0;e<t.length-1;e++)if(t[e].indexOf("x")>-1)return!0;return!1}_getCurrentWalletUID(){if(!this.sdkSession)return null;const t=this.sdkSession.getActiveWallet();return t&&t.uid?t.uid.toString("hex"):null}}l.type=h,e.exports=l}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-lattice-keyring"}],[2801,{"./types":2807,"@ethereumjs/common":621,"ethereumjs-util":2896},function(){with(this)return function(){"use strict";return function(t,e,r){var n=this&&this.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(r,"__esModule",{value:!0}),r.BaseTransaction=void 0;var s=o(t("@ethereumjs/common")),a=t("ethereumjs-util"),u=t("./types"),c=function(){function t(t){this.activeCapabilities=[],this.DEFAULT_CHAIN="mainnet",this.DEFAULT_HARDFORK="istanbul";var e=t.nonce,r=t.gasLimit,n=t.to,i=t.value,o=t.data,s=t.v,u=t.r,c=t.s,h=t.type;this._type=new a.BN(a.toBuffer(h)).toNumber();var f=a.toBuffer(""===n?"0x":n),l=a.toBuffer(""===s?"0x":s),d=a.toBuffer(""===u?"0x":u),p=a.toBuffer(""===c?"0x":c);this.nonce=new a.BN(a.toBuffer(""===e?"0x":e)),this.gasLimit=new a.BN(a.toBuffer(""===r?"0x":r)),this.to=f.length>0?new a.Address(f):undefined,this.value=new a.BN(a.toBuffer(""===i?"0x":i)),this.data=a.toBuffer(""===o?"0x":o),this.v=l.length>0?new a.BN(l):undefined,this.r=d.length>0?new a.BN(d):undefined,this.s=p.length>0?new a.BN(p):undefined,this._validateCannotExceedMaxInteger({nonce:this.nonce,gasLimit:this.gasLimit,value:this.value,r:this.r,s:this.s})}return Object.defineProperty(t.prototype,"transactionType",{get:function(){return this.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),t.prototype.supports=function(t){return this.activeCapabilities.includes(t)},t.prototype.validate=function(t){void 0===t&&(t=!1);var e=[];return this.getBaseFee().gt(this.gasLimit)&&e.push("gasLimit is too low. given "+this.gasLimit+", need at least "+this.getBaseFee()),this.isSigned()&&!this.verifySignature()&&e.push("Invalid Signature"),t?e:0===e.length},t.prototype.getBaseFee=function(){var t=this.getDataFee().addn(this.common.param("gasPrices","tx"));return this.common.gteHardfork("homestead")&&this.toCreationAddress()&&t.iaddn(this.common.param("gasPrices","txCreation")),t},t.prototype.getDataFee=function(){for(var t=this.common.param("gasPrices","txDataZero"),e=this.common.param("gasPrices","txDataNonZero"),r=0,n=0;n<this.data.length;n++)0===this.data[n]?r+=t:r+=e;return new a.BN(r)},t.prototype.toCreationAddress=function(){return this.to===undefined||0===this.to.buf.length},t.prototype.isSigned=function(){var t=this,e=t.v,r=t.r,n=t.s;return 0===this.type?!!(e&&r&&n):!(e===undefined||!r||!n)},t.prototype.verifySignature=function(){try{var t=this.getSenderPublicKey();return 0!==a.unpadBuffer(t).length}catch(t){return!1}},t.prototype.getSenderAddress=function(){return new a.Address(a.publicToAddress(this.getSenderPublicKey()))},t.prototype.sign=function(t){if(32!==t.length)throw new Error("Private key must be 32 bytes in length.");var e=!1;0===this.type&&this.common.gteHardfork("spuriousDragon")&&!this.supports(u.Capability.EIP155ReplayProtection)&&(this.activeCapabilities.push(u.Capability.EIP155ReplayProtection),e=!0);var r=this.getMessageToSign(!0),n=a.ecsign(r,t),i=n.v,o=n.r,s=n.s,c=this._processSignature(i,o,s);if(e){var h=this.activeCapabilities.indexOf(u.Capability.EIP155ReplayProtection);h>-1&&this.activeCapabilities.splice(h,1)}return c},t.prototype._getCommon=function(t,e){var r;if(e){var n=new a.BN(a.toBuffer(e));if(t){if(!t.chainIdBN().eq(n))throw new Error("The chain ID does not match the chain ID of Common");return t.copy()}return s.default.isSupportedChainId(n)?new s.default({chain:n,hardfork:this.DEFAULT_HARDFORK}):s.default.forCustomChain(this.DEFAULT_CHAIN,{name:"custom-chain",networkId:n,chainId:n},this.DEFAULT_HARDFORK)}return null!==(r=null==t?void 0:t.copy())&&void 0!==r?r:new s.default({chain:this.DEFAULT_CHAIN,hardfork:this.DEFAULT_HARDFORK})},t.prototype._validateCannotExceedMaxInteger=function(t,e){var r,o;void 0===e&&(e=53);try{for(var s=n(Object.entries(t)),u=s.next();!u.done;u=s.next()){var c=i(u.value,2),h=c[0],f=c[1];if(53===e){if(null==f?void 0:f.gt(a.MAX_INTEGER))throw new Error(h+" cannot exceed MAX_INTEGER, given "+f)}else{if(256!==e)throw new Error("unimplemented bits value");if(null==f?void 0:f.gte(a.TWO_POW256))throw new Error(h+" must be less than 2^256, given "+f)}}}catch(t){r={error:t}}finally{try{u&&!u.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}},t}();r.BaseTransaction=c}}},{package:"eth-lattice-keyring>@ethereumjs/tx"}],[2802,{"./baseTransaction":2801,"./types":2807,"./util":2808,buffer:2438,"ethereumjs-util":2896},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},n(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=this&&this.__assign||function(){return o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},o.apply(this,arguments)},s=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s};Object.defineProperty(r,"__esModule",{value:!0});var a=t("ethereumjs-util"),u=t("./baseTransaction"),c=t("./types"),h=t("./util"),f=e.from(2..toString(16).padStart(2,"0"),"hex"),l=function(t){function r(e,r){var n,i;void 0===r&&(r={});var s=t.call(this,o(o({},e),{type:2}))||this;s.DEFAULT_HARDFORK="london";var u=e.chainId,f=e.accessList,l=e.maxFeePerGas,d=e.maxPriorityFeePerGas;if(s.common=s._getCommon(r.common,u),s.chainId=s.common.chainIdBN(),!s.common.isActivatedEIP(1559))throw new Error("EIP-1559 not enabled on Common");s.activeCapabilities=s.activeCapabilities.concat([1559,2718,2930]);var p=h.AccessLists.getAccessListData(null!=f?f:[]);if(s.accessList=p.accessList,s.AccessListJSON=p.AccessListJSON,h.AccessLists.verifyAccessList(s.accessList),s.maxFeePerGas=new a.BN(a.toBuffer(""===l?"0x":l)),s.maxPriorityFeePerGas=new a.BN(a.toBuffer(""===d?"0x":d)),s._validateCannotExceedMaxInteger({maxFeePerGas:s.maxFeePerGas,maxPriorityFeePerGas:s.maxPriorityFeePerGas},256),s.maxFeePerGas.lt(s.maxPriorityFeePerGas))throw new Error("maxFeePerGas cannot be less than maxPriorityFeePerGas (The total must be the larger of the two)");if(s.v&&!s.v.eqn(0)&&!s.v.eqn(1))throw new Error("The y-parity of the transaction should either be 0 or 1");if(s.common.gteHardfork("homestead")&&(null===(n=s.s)||void 0===n?void 0:n.gt(c.N_DIV_2)))throw new Error("Invalid Signature: s-values greater than secp256k1n/2 are considered invalid");return(null===(i=null==r?void 0:r.freeze)||void 0===i||i)&&Object.freeze(s),s}return i(r,t),Object.defineProperty(r.prototype,"senderR",{get:function(){return this.r},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"senderS",{get:function(){return this.s},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"yParity",{get:function(){return this.v},enumerable:!1,configurable:!0}),r.fromTxData=function(t,e){return void 0===e&&(e={}),new r(t,e)},r.fromSerializedTx=function(t,e){if(void 0===e&&(e={}),!t.slice(0,1).equals(f))throw new Error("Invalid serialized tx input: not an EIP-1559 transaction (wrong tx type, expected: "+2+", received: "+t.slice(0,1).toString("hex"));var n=a.rlp.decode(t.slice(1));if(!Array.isArray(n))throw new Error("Invalid serialized tx input: must be array");return r.fromValuesArray(n,e)},r.fromRlpSerializedTx=function(t,e){return void 0===e&&(e={}),r.fromSerializedTx(t,e)},r.fromValuesArray=function(t,e){if(void 0===e&&(e={}),9!==t.length&&12!==t.length)throw new Error("Invalid EIP-1559 transaction. Only expecting 9 values (for unsigned tx) or 12 values (for signed tx).");var n=s(t,12),i=n[0],o=n[1],u=n[2],c=n[3],h=n[4],f=n[5],l=n[6],d=n[7],p=n[8],m=n[9],g=n[10],y=n[11];return new r({chainId:new a.BN(i),nonce:o,maxPriorityFeePerGas:u,maxFeePerGas:c,gasLimit:h,to:f,value:l,data:d,accessList:null!=p?p:[],v:m!==undefined?new a.BN(m):undefined,r:g,s:y},e)},r.prototype.getDataFee=function(){var e=t.prototype.getDataFee.call(this);return e.iaddn(h.AccessLists.getDataFeeEIP2930(this.accessList,this.common)),e},r.prototype.getUpfrontCost=function(t){void 0===t&&(t=new a.BN(0));var e=a.BN.min(this.maxPriorityFeePerGas,this.maxFeePerGas.sub(t)).add(t);return this.gasLimit.mul(e).add(this.value)},r.prototype.raw=function(){return[a.bnToUnpaddedBuffer(this.chainId),a.bnToUnpaddedBuffer(this.nonce),a.bnToUnpaddedBuffer(this.maxPriorityFeePerGas),a.bnToUnpaddedBuffer(this.maxFeePerGas),a.bnToUnpaddedBuffer(this.gasLimit),this.to!==undefined?this.to.buf:e.from([]),a.bnToUnpaddedBuffer(this.value),this.data,this.accessList,this.v!==undefined?a.bnToUnpaddedBuffer(this.v):e.from([]),this.r!==undefined?a.bnToUnpaddedBuffer(this.r):e.from([]),this.s!==undefined?a.bnToUnpaddedBuffer(this.s):e.from([])]},r.prototype.serialize=function(){var t=this.raw();return e.concat([f,a.rlp.encode(t)])},r.prototype.getMessageToSign=function(t){void 0===t&&(t=!0);var r=this.raw().slice(0,9),n=e.concat([f,a.rlp.encode(r)]);return t?a.keccak256(n):n},r.prototype.hash=function(){if(!this.isSigned())throw new Error("Cannot call hash method if transaction is not signed");return a.keccak256(this.serialize())},r.prototype.getMessageToVerifySignature=function(){return this.getMessageToSign()},r.prototype.getSenderPublicKey=function(){var t;if(!this.isSigned())throw new Error("Cannot call this method if transaction is not signed");var e=this.getMessageToVerifySignature();if(this.common.gteHardfork("homestead")&&(null===(t=this.s)||void 0===t?void 0:t.gt(c.N_DIV_2)))throw new Error("Invalid Signature: s-values greater than secp256k1n/2 are considered invalid");var r=this,n=r.v,i=r.r,o=r.s;try{return a.ecrecover(e,n.addn(27),a.bnToUnpaddedBuffer(i),a.bnToUnpaddedBuffer(o))}catch(t){throw new Error("Invalid Signature")}},r.prototype._processSignature=function(t,e,n){var i={common:this.common};return r.fromTxData({chainId:this.chainId,nonce:this.nonce,maxPriorityFeePerGas:this.maxPriorityFeePerGas,maxFeePerGas:this.maxFeePerGas,gasLimit:this.gasLimit,to:this.to,value:this.value,data:this.data,accessList:this.accessList,v:new a.BN(t-27),r:new a.BN(e),s:new a.BN(n)},i)},r.prototype.toJSON=function(){var t=h.AccessLists.getAccessListJSON(this.accessList);return{chainId:a.bnToHex(this.chainId),nonce:a.bnToHex(this.nonce),maxPriorityFeePerGas:a.bnToHex(this.maxPriorityFeePerGas),maxFeePerGas:a.bnToHex(this.maxFeePerGas),gasLimit:a.bnToHex(this.gasLimit),to:this.to!==undefined?this.to.toString():undefined,value:a.bnToHex(this.value),data:"0x"+this.data.toString("hex"),accessList:t,v:this.v!==undefined?a.bnToHex(this.v):undefined,r:this.r!==undefined?a.bnToHex(this.r):undefined,s:this.s!==undefined?a.bnToHex(this.s):undefined}},r}(u.BaseTransaction);r.default=l}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-lattice-keyring>@ethereumjs/tx"}],[2803,{"./baseTransaction":2801,"./types":2807,"./util":2808,buffer:2438,"ethereumjs-util":2896},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},n(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=this&&this.__assign||function(){return o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},o.apply(this,arguments)},s=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s};Object.defineProperty(r,"__esModule",{value:!0});var a=t("ethereumjs-util"),u=t("./baseTransaction"),c=t("./types"),h=t("./util"),f=e.from(1..toString(16).padStart(2,"0"),"hex"),l=function(t){function r(e,r){var n,i;void 0===r&&(r={});var s=t.call(this,o(o({},e),{type:1}))||this;s.DEFAULT_HARDFORK="berlin";var u=e.chainId,f=e.accessList,l=e.gasPrice;if(s.common=s._getCommon(r.common,u),s.chainId=s.common.chainIdBN(),!s.common.isActivatedEIP(2930))throw new Error("EIP-2930 not enabled on Common");s.activeCapabilities=s.activeCapabilities.concat([2718,2930]);var d=h.AccessLists.getAccessListData(null!=f?f:[]);if(s.accessList=d.accessList,s.AccessListJSON=d.AccessListJSON,h.AccessLists.verifyAccessList(s.accessList),s.gasPrice=new a.BN(a.toBuffer(""===l?"0x":l)),s._validateCannotExceedMaxInteger({gasPrice:s.gasPrice}),s.v&&!s.v.eqn(0)&&!s.v.eqn(1))throw new Error("The y-parity of the transaction should either be 0 or 1");if(s.common.gteHardfork("homestead")&&(null===(n=s.s)||void 0===n?void 0:n.gt(c.N_DIV_2)))throw new Error("Invalid Signature: s-values greater than secp256k1n/2 are considered invalid");return(null===(i=null==r?void 0:r.freeze)||void 0===i||i)&&Object.freeze(s),s}return i(r,t),Object.defineProperty(r.prototype,"senderR",{get:function(){return this.r},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"senderS",{get:function(){return this.s},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"yParity",{get:function(){return this.v},enumerable:!1,configurable:!0}),r.fromTxData=function(t,e){return void 0===e&&(e={}),new r(t,e)},r.fromSerializedTx=function(t,e){if(void 0===e&&(e={}),!t.slice(0,1).equals(f))throw new Error("Invalid serialized tx input: not an EIP-2930 transaction (wrong tx type, expected: "+1+", received: "+t.slice(0,1).toString("hex"));var n=a.rlp.decode(t.slice(1));if(!Array.isArray(n))throw new Error("Invalid serialized tx input: must be array");return r.fromValuesArray(n,e)},r.fromRlpSerializedTx=function(t,e){return void 0===e&&(e={}),r.fromSerializedTx(t,e)},r.fromValuesArray=function(t,e){if(void 0===e&&(e={}),8!==t.length&&11!==t.length)throw new Error("Invalid EIP-2930 transaction. Only expecting 8 values (for unsigned tx) or 11 values (for signed tx).");var n=s(t,11),i=n[0],o=n[1],u=n[2],c=n[3],h=n[4],f=n[5],l=n[6],d=n[7],p=n[8],m=n[9],g=n[10];return new r({chainId:new a.BN(i),nonce:o,gasPrice:u,gasLimit:c,to:h,value:f,data:l,accessList:null!=d?d:[],v:p!==undefined?new a.BN(p):undefined,r:m,s:g},e)},r.prototype.getDataFee=function(){var e=t.prototype.getDataFee.call(this);return e.iaddn(h.AccessLists.getDataFeeEIP2930(this.accessList,this.common)),e},r.prototype.getUpfrontCost=function(){return this.gasLimit.mul(this.gasPrice).add(this.value)},r.prototype.raw=function(){return[a.bnToUnpaddedBuffer(this.chainId),a.bnToUnpaddedBuffer(this.nonce),a.bnToUnpaddedBuffer(this.gasPrice),a.bnToUnpaddedBuffer(this.gasLimit),this.to!==undefined?this.to.buf:e.from([]),a.bnToUnpaddedBuffer(this.value),this.data,this.accessList,this.v!==undefined?a.bnToUnpaddedBuffer(this.v):e.from([]),this.r!==undefined?a.bnToUnpaddedBuffer(this.r):e.from([]),this.s!==undefined?a.bnToUnpaddedBuffer(this.s):e.from([])]},r.prototype.serialize=function(){var t=this.raw();return e.concat([f,a.rlp.encode(t)])},r.prototype.getMessageToSign=function(t){void 0===t&&(t=!0);var r=this.raw().slice(0,8),n=e.concat([f,a.rlp.encode(r)]);return t?a.keccak256(n):n},r.prototype.hash=function(){if(!this.isSigned())throw new Error("Cannot call hash method if transaction is not signed");return a.keccak256(this.serialize())},r.prototype.getMessageToVerifySignature=function(){return this.getMessageToSign()},r.prototype.getSenderPublicKey=function(){var t;if(!this.isSigned())throw new Error("Cannot call this method if transaction is not signed");var e=this.getMessageToVerifySignature();if(this.common.gteHardfork("homestead")&&(null===(t=this.s)||void 0===t?void 0:t.gt(c.N_DIV_2)))throw new Error("Invalid Signature: s-values greater than secp256k1n/2 are considered invalid");var r=this,n=r.yParity,i=r.r,o=r.s;try{return a.ecrecover(e,n.addn(27),a.bnToUnpaddedBuffer(i),a.bnToUnpaddedBuffer(o))}catch(t){throw new Error("Invalid Signature")}},r.prototype._processSignature=function(t,e,n){var i={common:this.common};return r.fromTxData({chainId:this.chainId,nonce:this.nonce,gasPrice:this.gasPrice,gasLimit:this.gasLimit,to:this.to,value:this.value,data:this.data,accessList:this.accessList,v:new a.BN(t-27),r:new a.BN(e),s:new a.BN(n)},i)},r.prototype.toJSON=function(){var t=h.AccessLists.getAccessListJSON(this.accessList);return{chainId:a.bnToHex(this.chainId),nonce:a.bnToHex(this.nonce),gasPrice:a.bnToHex(this.gasPrice),gasLimit:a.bnToHex(this.gasLimit),to:this.to!==undefined?this.to.toString():undefined,value:a.bnToHex(this.value),data:"0x"+this.data.toString("hex"),accessList:t,v:this.v!==undefined?a.bnToHex(this.v):undefined,r:this.r!==undefined?a.bnToHex(this.r):undefined,s:this.s!==undefined?a.bnToHex(this.s):undefined}},r}(u.BaseTransaction);r.default=l}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-lattice-keyring>@ethereumjs/tx"}],[2804,{"./eip1559Transaction":2802,"./eip2930Transaction":2803,"./legacyTransaction":2805,"./transactionFactory":2806,"./types":2807},function(){with(this)return function(){"use strict";return function(t,e,r){var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){n===undefined&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===undefined&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(r,"__esModule",{value:!0});var o=t("./legacyTransaction");Object.defineProperty(r,"Transaction",{enumerable:!0,get:function(){return o.default}});var s=t("./eip2930Transaction");Object.defineProperty(r,"AccessListEIP2930Transaction",{enumerable:!0,get:function(){return s.default}});var a=t("./transactionFactory");Object.defineProperty(r,"TransactionFactory",{enumerable:!0,get:function(){return a.default}});var u=t("./eip1559Transaction");Object.defineProperty(r,"FeeMarketEIP1559Transaction",{enumerable:!0,get:function(){return u.default}}),i(t("./types"),r)}}},{package:"eth-lattice-keyring>@ethereumjs/tx"}],[2805,{"./baseTransaction":2801,"./types":2807,buffer:2438,"ethereumjs-util":2896},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){var n,i=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},n(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=this&&this.__assign||function(){return o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},o.apply(this,arguments)},s=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s};Object.defineProperty(r,"__esModule",{value:!0});var a=t("ethereumjs-util"),u=t("./types"),c=t("./baseTransaction"),h=function(t){function r(e,r){var n;void 0===r&&(r={});var i=t.call(this,o(o({},e),{type:0}))||this;if(i.common=i._validateTxV(i.v,r.common),i.gasPrice=new a.BN(a.toBuffer(""===e.gasPrice?"0x":e.gasPrice)),i._validateCannotExceedMaxInteger({gasPrice:i.gasPrice}),i.common.gteHardfork("spuriousDragon"))if(i.isSigned()){var s=i.v,c=i.common.chainIdBN().muln(2);(s.eq(c.addn(35))||s.eq(c.addn(36)))&&i.activeCapabilities.push(u.Capability.EIP155ReplayProtection)}else i.activeCapabilities.push(u.Capability.EIP155ReplayProtection);return(null===(n=null==r?void 0:r.freeze)||void 0===n||n)&&Object.freeze(i),i}return i(r,t),r.fromTxData=function(t,e){return void 0===e&&(e={}),new r(t,e)},r.fromSerializedTx=function(t,e){void 0===e&&(e={});var r=a.rlp.decode(t);if(!Array.isArray(r))throw new Error("Invalid serialized tx input. Must be array");return this.fromValuesArray(r,e)},r.fromRlpSerializedTx=function(t,e){return void 0===e&&(e={}),r.fromSerializedTx(t,e)},r.fromValuesArray=function(t,e){if(void 0===e&&(e={}),6!==t.length&&9!==t.length)throw new Error("Invalid transaction. Only expecting 6 values (for unsigned tx) or 9 values (for signed tx).");var n=s(t,9);return new r({nonce:n[0],gasPrice:n[1],gasLimit:n[2],to:n[3],value:n[4],data:n[5],v:n[6],r:n[7],s:n[8]},e)},r.prototype.raw=function(){return[a.bnToUnpaddedBuffer(this.nonce),a.bnToUnpaddedBuffer(this.gasPrice),a.bnToUnpaddedBuffer(this.gasLimit),this.to!==undefined?this.to.buf:e.from([]),a.bnToUnpaddedBuffer(this.value),this.data,this.v!==undefined?a.bnToUnpaddedBuffer(this.v):e.from([]),this.r!==undefined?a.bnToUnpaddedBuffer(this.r):e.from([]),this.s!==undefined?a.bnToUnpaddedBuffer(this.s):e.from([])]},r.prototype.serialize=function(){return a.rlp.encode(this.raw())},r.prototype._getMessageToSign=function(){var t=[a.bnToUnpaddedBuffer(this.nonce),a.bnToUnpaddedBuffer(this.gasPrice),a.bnToUnpaddedBuffer(this.gasLimit),this.to!==undefined?this.to.buf:e.from([]),a.bnToUnpaddedBuffer(this.value),this.data];return this.supports(u.Capability.EIP155ReplayProtection)&&(t.push(a.toBuffer(this.common.chainIdBN())),t.push(a.unpadBuffer(a.toBuffer(0))),t.push(a.unpadBuffer(a.toBuffer(0)))),t},r.prototype.getMessageToSign=function(t){void 0===t&&(t=!0);var e=this._getMessageToSign();return t?a.rlphash(e):e},r.prototype.getUpfrontCost=function(){return this.gasLimit.mul(this.gasPrice).add(this.value)},r.prototype.hash=function(){return a.rlphash(this.raw())},r.prototype.getMessageToVerifySignature=function(){if(!this.isSigned())throw Error("This transaction is not signed");var t=this._getMessageToSign();return a.rlphash(t)},r.prototype.getSenderPublicKey=function(){var t,e=this.getMessageToVerifySignature();if(this.common.gteHardfork("homestead")&&(null===(t=this.s)||void 0===t?void 0:t.gt(u.N_DIV_2)))throw new Error("Invalid Signature: s-values greater than secp256k1n/2 are considered invalid");var r=this,n=r.v,i=r.r,o=r.s;try{return a.ecrecover(e,n,a.bnToUnpaddedBuffer(i),a.bnToUnpaddedBuffer(o),this.supports(u.Capability.EIP155ReplayProtection)?this.common.chainIdBN():undefined)}catch(t){throw new Error("Invalid Signature")}},r.prototype._processSignature=function(t,e,n){var i=new a.BN(t);this.supports(u.Capability.EIP155ReplayProtection)&&i.iadd(this.common.chainIdBN().muln(2).addn(8));var o={common:this.common};return r.fromTxData({nonce:this.nonce,gasPrice:this.gasPrice,gasLimit:this.gasLimit,to:this.to,value:this.value,data:this.data,v:i,r:new a.BN(e),s:new a.BN(n)},o)},r.prototype.toJSON=function(){return{nonce:a.bnToHex(this.nonce),gasPrice:a.bnToHex(this.gasPrice),gasLimit:a.bnToHex(this.gasLimit),to:this.to!==undefined?this.to.toString():undefined,value:a.bnToHex(this.value),data:"0x"+this.data.toString("hex"),v:this.v!==undefined?a.bnToHex(this.v):undefined,r:this.r!==undefined?a.bnToHex(this.r):undefined,s:this.s!==undefined?a.bnToHex(this.s):undefined}},r.prototype._validateTxV=function(t,e){var r;if(t!==undefined&&!t.eqn(0)&&(!e||e.gteHardfork("spuriousDragon"))&&!t.eqn(27)&&!t.eqn(28))if(e){var n=e.chainIdBN().muln(2);if(!(t.eq(n.addn(35))||t.eq(n.addn(36))))throw new Error("Incompatible EIP155-based V "+t.toString()+" and chain id "+e.chainIdBN().toString()+". See the Common parameter of the Transaction constructor to set the chain id.")}else{var i=void 0;i=t.subn(35).isEven()?35:36,r=t.subn(i).divn(2)}return this._getCommon(e,r)},r.prototype._unsignedTxImplementsEIP155=function(){return this.common.gteHardfork("spuriousDragon")},r.prototype._signedTxImplementsEIP155=function(){if(!this.isSigned())throw Error("This transaction is not signed");var t=this.common.gteHardfork("spuriousDragon"),e=this.v,r=this.common.chainIdBN().muln(2);return(e.eq(r.addn(35))||e.eq(r.addn(36)))&&t},r}(c.BaseTransaction);r.default=h}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-lattice-keyring>@ethereumjs/tx"}],[2806,{".":2804,"../../../../../is-buffer/index.js":5584,"ethereumjs-util":2896},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n=t("ethereumjs-util"),i=t("."),o=function(){function t(){}return t.fromTxData=function(t,e){if(void 0===e&&(e={}),"type"in t&&t.type!==undefined){var r=new n.BN(n.toBuffer(t.type)).toNumber();if(0===r)return i.Transaction.fromTxData(t,e);if(1===r)return i.AccessListEIP2930Transaction.fromTxData(t,e);if(2===r)return i.FeeMarketEIP1559Transaction.fromTxData(t,e);throw new Error("Tx instantiation with type "+r+" not supported")}return i.Transaction.fromTxData(t,e)},t.fromSerializedData=function(t,e){if(void 0===e&&(e={}),t[0]<=127){var r=void 0;switch(t[0]){case 1:r=2930;break;case 2:r=1559;break;default:throw new Error("TypedTransaction with ID "+t[0]+" unknown")}return 1559===r?i.FeeMarketEIP1559Transaction.fromSerializedTx(t,e):i.AccessListEIP2930Transaction.fromSerializedTx(t,e)}return i.Transaction.fromSerializedTx(t,e)},t.fromBlockBodyData=function(t,r){if(void 0===r&&(r={}),e.isBuffer(t))return this.fromSerializedData(t,r);if(Array.isArray(t))return i.Transaction.fromValuesArray(t,r);throw new Error("Cannot decode transaction: unknown type input")},t.getTransactionClass=function(t,e){if(void 0===t&&(t=0),0==t||t>=128&&t<=255)return i.Transaction;switch(t){case 1:return i.AccessListEIP2930Transaction;case 2:return i.FeeMarketEIP1559Transaction;default:throw new Error("TypedTransaction with ID "+t+" unknown")}},t}();r.default=o}).call(this)}).call(this,{isBuffer:t("../../../../../is-buffer/index.js")})}}},{package:"eth-lattice-keyring>@ethereumjs/tx"}],[2807,{"ethereumjs-util":2896},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.N_DIV_2=r.isAccessList=r.isAccessListBuffer=r.Capability=void 0;var n=t("ethereumjs-util");function i(t){if(0===t.length)return!0;var e=t[0];return!!Array.isArray(e)}!function(t){t[t.EIP155ReplayProtection=155]="EIP155ReplayProtection",t[t.EIP1559FeeMarket=1559]="EIP1559FeeMarket",t[t.EIP2718TypedTransaction=2718]="EIP2718TypedTransaction",t[t.EIP2930AccessLists=2930]="EIP2930AccessLists"}(r.Capability||(r.Capability={})),r.isAccessListBuffer=i,r.isAccessList=function(t){return!i(t)},r.N_DIV_2=new n.BN("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16)}}},{package:"eth-lattice-keyring>@ethereumjs/tx"}],[2808,{"./types":2807,"ethereumjs-util":2896},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.AccessLists=void 0;var n=t("ethereumjs-util"),i=t("./types"),o=function(){function t(){}return t.getAccessListData=function(t){var e,r;if(t&&i.isAccessList(t)){e=t;for(var o=[],s=0;s<t.length;s++){for(var a=t[s],u=n.toBuffer(a.address),c=[],h=0;h<a.storageKeys.length;h++)c.push(n.toBuffer(a.storageKeys[h]));o.push([u,c])}r=o}else{r=null!=t?t:[];var f=[];for(s=0;s<r.length;s++){var l=r[s],d=n.bufferToHex(l[0]),p=[];for(a=0;a<l[1].length;a++)p.push(n.bufferToHex(l[1][a]));var m={address:d,storageKeys:p};f.push(m)}e=f}return{AccessListJSON:e,accessList:r}},t.verifyAccessList=function(t){for(var e=0;e<t.length;e++){var r=t[e],n=r[0],i=r[1];if(r[2]!==undefined)throw new Error("Access list item cannot have 3 elements. It can only have an address, and an array of storage slots.");if(20!=n.length)throw new Error("Invalid EIP-2930 transaction: address length should be 20 bytes");for(var o=0;o<i.length;o++)if(32!=i[o].length)throw new Error("Invalid EIP-2930 transaction: storage slot length should be 32 bytes")}},t.getAccessListJSON=function(t){for(var e=[],r=0;r<t.length;r++){for(var i=t[r],o={address:"0x"+n.setLengthLeft(i[0],20).toString("hex"),storageKeys:[]},s=i[1],a=0;a<s.length;a++){var u=s[a];o.storageKeys.push("0x"+n.setLengthLeft(u,32).toString("hex"))}e.push(o)}return e},t.getDataFeeEIP2930=function(t,e){for(var r=e.param("gasPrices","accessListStorageKeyCost"),n=e.param("gasPrices","accessListAddressCost"),i=0,o=0;o<t.length;o++){i+=t[o][1].length}return t.length*n+i*r},t}();r.AccessLists=o}}},{package:"eth-lattice-keyring>@ethereumjs/tx"}],[2809,{buffer:2437},function(){with(this)return function(){"use strict";return function(t,e,r){!function(e,r){function n(t,e){if(!t)throw new Error(e||"Assertion failed")}function i(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}function o(t,e,r){if(o.isBN(t))return t;this.negative=0,this.words=null,this.length=0,this.red=null,null!==t&&("le"!==e&&"be"!==e||(r=e,e=10),this._init(t||0,e||10,r||"be"))}var s;"object"==typeof e?e.exports=o:r.BN=o,o.BN=o,o.wordSize=26;try{s="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:t("buffer").Buffer}catch(t){}function a(t,e){var r=t.charCodeAt(e);return r>=48&&r<=57?r-48:r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:void n(!1,"Invalid character in "+t)}function u(t,e,r){var n=a(t,r);return r-1>=e&&(n|=a(t,r-1)<<4),n}function c(t,e,r,i){for(var o=0,s=0,a=Math.min(t.length,r),u=e;u<a;u++){var c=t.charCodeAt(u)-48;o*=i,s=c>=49?c-49+10:c>=17?c-17+10:c,n(c>=0&&s<i,"Invalid character"),o+=s}return o}function h(t,e){t.words=e.words,t.length=e.length,t.negative=e.negative,t.red=e.red}if(o.isBN=function(t){return t instanceof o||null!==t&&"object"==typeof t&&t.constructor.wordSize===o.wordSize&&Array.isArray(t.words)},o.max=function(t,e){return t.cmp(e)>0?t:e},o.min=function(t,e){return t.cmp(e)<0?t:e},o.prototype._init=function(t,e,r){if("number"==typeof t)return this._initNumber(t,e,r);if("object"==typeof t)return this._initArray(t,e,r);"hex"===e&&(e=16),n(e===(0|e)&&e>=2&&e<=36);var i=0;"-"===(t=t.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<t.length&&(16===e?this._parseHex(t,i,r):(this._parseBase(t,e,i),"le"===r&&this._initArray(this.toArray(),e,r)))},o.prototype._initNumber=function(t,e,r){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(n(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),e,r)},o.prototype._initArray=function(t,e,r){if(n("number"==typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var o,s,a=0;if("be"===r)for(i=t.length-1,o=0;i>=0;i-=3)s=t[i]|t[i-1]<<8|t[i-2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);else if("le"===r)for(i=0,o=0;i<t.length;i+=3)s=t[i]|t[i+1]<<8|t[i+2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);return this._strip()},o.prototype._parseHex=function(t,e,r){this.length=Math.ceil((t.length-e)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,o=0,s=0;if("be"===r)for(n=t.length-1;n>=e;n-=2)i=u(t,e,n)<<o,this.words[s]|=67108863&i,o>=18?(o-=18,s+=1,this.words[s]|=i>>>26):o+=8;else for(n=(t.length-e)%2==0?e+1:e;n<t.length;n+=2)i=u(t,e,n)<<o,this.words[s]|=67108863&i,o>=18?(o-=18,s+=1,this.words[s]|=i>>>26):o+=8;this._strip()},o.prototype._parseBase=function(t,e,r){this.words=[0],this.length=1;for(var n=0,i=1;i<=67108863;i*=e)n++;n--,i=i/e|0;for(var o=t.length-r,s=o%n,a=Math.min(o,o-s)+r,u=0,h=r;h<a;h+=n)u=c(t,h,h+n,e),this.imuln(i),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u);if(0!==s){var f=1;for(u=c(t,h,t.length,e),h=0;h<s;h++)f*=e;this.imuln(f),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u)}this._strip()},o.prototype.copy=function(t){t.words=new Array(this.length);for(var e=0;e<this.length;e++)t.words[e]=this.words[e];t.length=this.length,t.negative=this.negative,t.red=this.red},o.prototype._move=function(t){h(t,this)},o.prototype.clone=function(){var t=new o(null);return this.copy(t),t},o.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},o.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},o.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{o.prototype[Symbol.for("nodejs.util.inspect.custom")]=f}catch(t){o.prototype.inspect=f}else o.prototype.inspect=f;function f(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],d=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];o.prototype.toString=function(t,e){var r;if(e=0|e||1,16===(t=t||10)||"hex"===t){r="";for(var i=0,o=0,s=0;s<this.length;s++){var a=this.words[s],u=(16777215&(a<<i|o)).toString(16);o=a>>>24-i&16777215,(i+=2)>=26&&(i-=26,s--),r=0!==o||s!==this.length-1?l[6-u.length]+u+r:u+r}for(0!==o&&(r=o.toString(16)+r);r.length%e!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(t===(0|t)&&t>=2&&t<=36){var c=d[t],h=p[t];r="";var f=this.clone();for(f.negative=0;!f.isZero();){var m=f.modrn(h).toString(t);r=(f=f.idivn(h)).isZero()?m+r:l[c-m.length]+m+r}for(this.isZero()&&(r="0"+r);r.length%e!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},o.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},o.prototype.toJSON=function(){return this.toString(16,2)},s&&(o.prototype.toBuffer=function(t,e){return this.toArrayLike(s,t,e)}),o.prototype.toArray=function(t,e){return this.toArrayLike(Array,t,e)};function m(t,e,r){r.negative=e.negative^t.negative;var n=t.length+e.length|0;r.length=n,n=n-1|0;var i=0|t.words[0],o=0|e.words[0],s=i*o,a=67108863&s,u=s/67108864|0;r.words[0]=a;for(var c=1;c<n;c++){for(var h=u>>>26,f=67108863&u,l=Math.min(c,e.length-1),d=Math.max(0,c-t.length+1);d<=l;d++){var p=c-d|0;h+=(s=(i=0|t.words[p])*(o=0|e.words[d])+f)/67108864|0,f=67108863&s}r.words[c]=0|f,u=0|h}return 0!==u?r.words[c]=0|u:r.length--,r._strip()}o.prototype.toArrayLike=function(t,e,r){this._strip();var i=this.byteLength(),o=r||Math.max(1,i);n(i<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0");var s=function(t,e){return t.allocUnsafe?t.allocUnsafe(e):new t(e)}(t,o);return this["_toArrayLike"+("le"===e?"LE":"BE")](s,i),s},o.prototype._toArrayLikeLE=function(t,e){for(var r=0,n=0,i=0,o=0;i<this.length;i++){var s=this.words[i]<<o|n;t[r++]=255&s,r<t.length&&(t[r++]=s>>8&255),r<t.length&&(t[r++]=s>>16&255),6===o?(r<t.length&&(t[r++]=s>>24&255),n=0,o=0):(n=s>>>24,o+=2)}if(r<t.length)for(t[r++]=n;r<t.length;)t[r++]=0},o.prototype._toArrayLikeBE=function(t,e){for(var r=t.length-1,n=0,i=0,o=0;i<this.length;i++){var s=this.words[i]<<o|n;t[r--]=255&s,r>=0&&(t[r--]=s>>8&255),r>=0&&(t[r--]=s>>16&255),6===o?(r>=0&&(t[r--]=s>>24&255),n=0,o=0):(n=s>>>24,o+=2)}if(r>=0)for(t[r--]=n;r>=0;)t[r--]=0},Math.clz32?o.prototype._countBits=function(t){return 32-Math.clz32(t)}:o.prototype._countBits=function(t){var e=t,r=0;return e>=4096&&(r+=13,e>>>=13),e>=64&&(r+=7,e>>>=7),e>=8&&(r+=4,e>>>=4),e>=2&&(r+=2,e>>>=2),r+e},o.prototype._zeroBits=function(t){if(0===t)return 26;var e=t,r=0;return 0==(8191&e)&&(r+=13,e>>>=13),0==(127&e)&&(r+=7,e>>>=7),0==(15&e)&&(r+=4,e>>>=4),0==(3&e)&&(r+=2,e>>>=2),0==(1&e)&&r++,r},o.prototype.bitLength=function(){var t=this.words[this.length-1],e=this._countBits(t);return 26*(this.length-1)+e},o.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,e=0;e<this.length;e++){var r=this._zeroBits(this.words[e]);if(t+=r,26!==r)break}return t},o.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},o.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},o.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},o.prototype.isNeg=function(){return 0!==this.negative},o.prototype.neg=function(){return this.clone().ineg()},o.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},o.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var e=0;e<t.length;e++)this.words[e]=this.words[e]|t.words[e];return this._strip()},o.prototype.ior=function(t){return n(0==(this.negative|t.negative)),this.iuor(t)},o.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},o.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},o.prototype.iuand=function(t){var e;e=this.length>t.length?t:this;for(var r=0;r<e.length;r++)this.words[r]=this.words[r]&t.words[r];return this.length=e.length,this._strip()},o.prototype.iand=function(t){return n(0==(this.negative|t.negative)),this.iuand(t)},o.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},o.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},o.prototype.iuxor=function(t){var e,r;this.length>t.length?(e=this,r=t):(e=t,r=this);for(var n=0;n<r.length;n++)this.words[n]=e.words[n]^r.words[n];if(this!==e)for(;n<e.length;n++)this.words[n]=e.words[n];return this.length=e.length,this._strip()},o.prototype.ixor=function(t){return n(0==(this.negative|t.negative)),this.iuxor(t)},o.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},o.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},o.prototype.inotn=function(t){n("number"==typeof t&&t>=0);var e=0|Math.ceil(t/26),r=t%26;this._expand(e),r>0&&e--;for(var i=0;i<e;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this._strip()},o.prototype.notn=function(t){return this.clone().inotn(t)},o.prototype.setn=function(t,e){n("number"==typeof t&&t>=0);var r=t/26|0,i=t%26;return this._expand(r+1),this.words[r]=e?this.words[r]|1<<i:this.words[r]&~(1<<i),this._strip()},o.prototype.iadd=function(t){var e,r,n;if(0!==this.negative&&0===t.negative)return this.negative=0,e=this.isub(t),this.negative^=1,this._normSign();if(0===this.negative&&0!==t.negative)return t.negative=0,e=this.isub(t),t.negative=1,e._normSign();this.length>t.length?(r=this,n=t):(r=t,n=this);for(var i=0,o=0;o<n.length;o++)e=(0|r.words[o])+(0|n.words[o])+i,this.words[o]=67108863&e,i=e>>>26;for(;0!==i&&o<r.length;o++)e=(0|r.words[o])+i,this.words[o]=67108863&e,i=e>>>26;if(this.length=r.length,0!==i)this.words[this.length]=i,this.length++;else if(r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this},o.prototype.add=function(t){var e;return 0!==t.negative&&0===this.negative?(t.negative=0,e=this.sub(t),t.negative^=1,e):0===t.negative&&0!==this.negative?(this.negative=0,e=t.sub(this),this.negative=1,e):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},o.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var e=this.iadd(t);return t.negative=1,e._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var r,n,i=this.cmp(t);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(r=this,n=t):(r=t,n=this);for(var o=0,s=0;s<n.length;s++)o=(e=(0|r.words[s])-(0|n.words[s])+o)>>26,this.words[s]=67108863&e;for(;0!==o&&s<r.length;s++)o=(e=(0|r.words[s])+o)>>26,this.words[s]=67108863&e;if(0===o&&s<r.length&&r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this.length=Math.max(this.length,s),r!==this&&(this.negative=1),this._strip()},o.prototype.sub=function(t){return this.clone().isub(t)};var g=function(t,e,r){var n,i,o,s=t.words,a=e.words,u=r.words,c=0,h=0|s[0],f=8191&h,l=h>>>13,d=0|s[1],p=8191&d,m=d>>>13,g=0|s[2],y=8191&g,v=g>>>13,w=0|s[3],b=8191&w,_=w>>>13,E=0|s[4],x=8191&E,T=E>>>13,k=0|s[5],S=8191&k,A=k>>>13,M=0|s[6],P=8191&M,I=M>>>13,B=0|s[7],C=8191&B,O=B>>>13,R=0|s[8],N=8191&R,L=R>>>13,j=0|s[9],F=8191&j,D=j>>>13,U=0|a[0],K=8191&U,H=U>>>13,G=0|a[1],q=8191&G,V=G>>>13,z=0|a[2],W=8191&z,$=z>>>13,Y=0|a[3],Z=8191&Y,J=Y>>>13,X=0|a[4],Q=8191&X,tt=X>>>13,et=0|a[5],rt=8191&et,nt=et>>>13,it=0|a[6],ot=8191&it,st=it>>>13,at=0|a[7],ut=8191&at,ct=at>>>13,ht=0|a[8],ft=8191&ht,lt=ht>>>13,dt=0|a[9],pt=8191&dt,mt=dt>>>13;r.negative=t.negative^e.negative,r.length=19;var gt=(c+(n=Math.imul(f,K))|0)+((8191&(i=(i=Math.imul(f,H))+Math.imul(l,K)|0))<<13)|0;c=((o=Math.imul(l,H))+(i>>>13)|0)+(gt>>>26)|0,gt&=67108863,n=Math.imul(p,K),i=(i=Math.imul(p,H))+Math.imul(m,K)|0,o=Math.imul(m,H);var yt=(c+(n=n+Math.imul(f,q)|0)|0)+((8191&(i=(i=i+Math.imul(f,V)|0)+Math.imul(l,q)|0))<<13)|0;c=((o=o+Math.imul(l,V)|0)+(i>>>13)|0)+(yt>>>26)|0,yt&=67108863,n=Math.imul(y,K),i=(i=Math.imul(y,H))+Math.imul(v,K)|0,o=Math.imul(v,H),n=n+Math.imul(p,q)|0,i=(i=i+Math.imul(p,V)|0)+Math.imul(m,q)|0,o=o+Math.imul(m,V)|0;var vt=(c+(n=n+Math.imul(f,W)|0)|0)+((8191&(i=(i=i+Math.imul(f,$)|0)+Math.imul(l,W)|0))<<13)|0;c=((o=o+Math.imul(l,$)|0)+(i>>>13)|0)+(vt>>>26)|0,vt&=67108863,n=Math.imul(b,K),i=(i=Math.imul(b,H))+Math.imul(_,K)|0,o=Math.imul(_,H),n=n+Math.imul(y,q)|0,i=(i=i+Math.imul(y,V)|0)+Math.imul(v,q)|0,o=o+Math.imul(v,V)|0,n=n+Math.imul(p,W)|0,i=(i=i+Math.imul(p,$)|0)+Math.imul(m,W)|0,o=o+Math.imul(m,$)|0;var wt=(c+(n=n+Math.imul(f,Z)|0)|0)+((8191&(i=(i=i+Math.imul(f,J)|0)+Math.imul(l,Z)|0))<<13)|0;c=((o=o+Math.imul(l,J)|0)+(i>>>13)|0)+(wt>>>26)|0,wt&=67108863,n=Math.imul(x,K),i=(i=Math.imul(x,H))+Math.imul(T,K)|0,o=Math.imul(T,H),n=n+Math.imul(b,q)|0,i=(i=i+Math.imul(b,V)|0)+Math.imul(_,q)|0,o=o+Math.imul(_,V)|0,n=n+Math.imul(y,W)|0,i=(i=i+Math.imul(y,$)|0)+Math.imul(v,W)|0,o=o+Math.imul(v,$)|0,n=n+Math.imul(p,Z)|0,i=(i=i+Math.imul(p,J)|0)+Math.imul(m,Z)|0,o=o+Math.imul(m,J)|0;var bt=(c+(n=n+Math.imul(f,Q)|0)|0)+((8191&(i=(i=i+Math.imul(f,tt)|0)+Math.imul(l,Q)|0))<<13)|0;c=((o=o+Math.imul(l,tt)|0)+(i>>>13)|0)+(bt>>>26)|0,bt&=67108863,n=Math.imul(S,K),i=(i=Math.imul(S,H))+Math.imul(A,K)|0,o=Math.imul(A,H),n=n+Math.imul(x,q)|0,i=(i=i+Math.imul(x,V)|0)+Math.imul(T,q)|0,o=o+Math.imul(T,V)|0,n=n+Math.imul(b,W)|0,i=(i=i+Math.imul(b,$)|0)+Math.imul(_,W)|0,o=o+Math.imul(_,$)|0,n=n+Math.imul(y,Z)|0,i=(i=i+Math.imul(y,J)|0)+Math.imul(v,Z)|0,o=o+Math.imul(v,J)|0,n=n+Math.imul(p,Q)|0,i=(i=i+Math.imul(p,tt)|0)+Math.imul(m,Q)|0,o=o+Math.imul(m,tt)|0;var _t=(c+(n=n+Math.imul(f,rt)|0)|0)+((8191&(i=(i=i+Math.imul(f,nt)|0)+Math.imul(l,rt)|0))<<13)|0;c=((o=o+Math.imul(l,nt)|0)+(i>>>13)|0)+(_t>>>26)|0,_t&=67108863,n=Math.imul(P,K),i=(i=Math.imul(P,H))+Math.imul(I,K)|0,o=Math.imul(I,H),n=n+Math.imul(S,q)|0,i=(i=i+Math.imul(S,V)|0)+Math.imul(A,q)|0,o=o+Math.imul(A,V)|0,n=n+Math.imul(x,W)|0,i=(i=i+Math.imul(x,$)|0)+Math.imul(T,W)|0,o=o+Math.imul(T,$)|0,n=n+Math.imul(b,Z)|0,i=(i=i+Math.imul(b,J)|0)+Math.imul(_,Z)|0,o=o+Math.imul(_,J)|0,n=n+Math.imul(y,Q)|0,i=(i=i+Math.imul(y,tt)|0)+Math.imul(v,Q)|0,o=o+Math.imul(v,tt)|0,n=n+Math.imul(p,rt)|0,i=(i=i+Math.imul(p,nt)|0)+Math.imul(m,rt)|0,o=o+Math.imul(m,nt)|0;var Et=(c+(n=n+Math.imul(f,ot)|0)|0)+((8191&(i=(i=i+Math.imul(f,st)|0)+Math.imul(l,ot)|0))<<13)|0;c=((o=o+Math.imul(l,st)|0)+(i>>>13)|0)+(Et>>>26)|0,Et&=67108863,n=Math.imul(C,K),i=(i=Math.imul(C,H))+Math.imul(O,K)|0,o=Math.imul(O,H),n=n+Math.imul(P,q)|0,i=(i=i+Math.imul(P,V)|0)+Math.imul(I,q)|0,o=o+Math.imul(I,V)|0,n=n+Math.imul(S,W)|0,i=(i=i+Math.imul(S,$)|0)+Math.imul(A,W)|0,o=o+Math.imul(A,$)|0,n=n+Math.imul(x,Z)|0,i=(i=i+Math.imul(x,J)|0)+Math.imul(T,Z)|0,o=o+Math.imul(T,J)|0,n=n+Math.imul(b,Q)|0,i=(i=i+Math.imul(b,tt)|0)+Math.imul(_,Q)|0,o=o+Math.imul(_,tt)|0,n=n+Math.imul(y,rt)|0,i=(i=i+Math.imul(y,nt)|0)+Math.imul(v,rt)|0,o=o+Math.imul(v,nt)|0,n=n+Math.imul(p,ot)|0,i=(i=i+Math.imul(p,st)|0)+Math.imul(m,ot)|0,o=o+Math.imul(m,st)|0;var xt=(c+(n=n+Math.imul(f,ut)|0)|0)+((8191&(i=(i=i+Math.imul(f,ct)|0)+Math.imul(l,ut)|0))<<13)|0;c=((o=o+Math.imul(l,ct)|0)+(i>>>13)|0)+(xt>>>26)|0,xt&=67108863,n=Math.imul(N,K),i=(i=Math.imul(N,H))+Math.imul(L,K)|0,o=Math.imul(L,H),n=n+Math.imul(C,q)|0,i=(i=i+Math.imul(C,V)|0)+Math.imul(O,q)|0,o=o+Math.imul(O,V)|0,n=n+Math.imul(P,W)|0,i=(i=i+Math.imul(P,$)|0)+Math.imul(I,W)|0,o=o+Math.imul(I,$)|0,n=n+Math.imul(S,Z)|0,i=(i=i+Math.imul(S,J)|0)+Math.imul(A,Z)|0,o=o+Math.imul(A,J)|0,n=n+Math.imul(x,Q)|0,i=(i=i+Math.imul(x,tt)|0)+Math.imul(T,Q)|0,o=o+Math.imul(T,tt)|0,n=n+Math.imul(b,rt)|0,i=(i=i+Math.imul(b,nt)|0)+Math.imul(_,rt)|0,o=o+Math.imul(_,nt)|0,n=n+Math.imul(y,ot)|0,i=(i=i+Math.imul(y,st)|0)+Math.imul(v,ot)|0,o=o+Math.imul(v,st)|0,n=n+Math.imul(p,ut)|0,i=(i=i+Math.imul(p,ct)|0)+Math.imul(m,ut)|0,o=o+Math.imul(m,ct)|0;var Tt=(c+(n=n+Math.imul(f,ft)|0)|0)+((8191&(i=(i=i+Math.imul(f,lt)|0)+Math.imul(l,ft)|0))<<13)|0;c=((o=o+Math.imul(l,lt)|0)+(i>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,n=Math.imul(F,K),i=(i=Math.imul(F,H))+Math.imul(D,K)|0,o=Math.imul(D,H),n=n+Math.imul(N,q)|0,i=(i=i+Math.imul(N,V)|0)+Math.imul(L,q)|0,o=o+Math.imul(L,V)|0,n=n+Math.imul(C,W)|0,i=(i=i+Math.imul(C,$)|0)+Math.imul(O,W)|0,o=o+Math.imul(O,$)|0,n=n+Math.imul(P,Z)|0,i=(i=i+Math.imul(P,J)|0)+Math.imul(I,Z)|0,o=o+Math.imul(I,J)|0,n=n+Math.imul(S,Q)|0,i=(i=i+Math.imul(S,tt)|0)+Math.imul(A,Q)|0,o=o+Math.imul(A,tt)|0,n=n+Math.imul(x,rt)|0,i=(i=i+Math.imul(x,nt)|0)+Math.imul(T,rt)|0,o=o+Math.imul(T,nt)|0,n=n+Math.imul(b,ot)|0,i=(i=i+Math.imul(b,st)|0)+Math.imul(_,ot)|0,o=o+Math.imul(_,st)|0,n=n+Math.imul(y,ut)|0,i=(i=i+Math.imul(y,ct)|0)+Math.imul(v,ut)|0,o=o+Math.imul(v,ct)|0,n=n+Math.imul(p,ft)|0,i=(i=i+Math.imul(p,lt)|0)+Math.imul(m,ft)|0,o=o+Math.imul(m,lt)|0;var kt=(c+(n=n+Math.imul(f,pt)|0)|0)+((8191&(i=(i=i+Math.imul(f,mt)|0)+Math.imul(l,pt)|0))<<13)|0;c=((o=o+Math.imul(l,mt)|0)+(i>>>13)|0)+(kt>>>26)|0,kt&=67108863,n=Math.imul(F,q),i=(i=Math.imul(F,V))+Math.imul(D,q)|0,o=Math.imul(D,V),n=n+Math.imul(N,W)|0,i=(i=i+Math.imul(N,$)|0)+Math.imul(L,W)|0,o=o+Math.imul(L,$)|0,n=n+Math.imul(C,Z)|0,i=(i=i+Math.imul(C,J)|0)+Math.imul(O,Z)|0,o=o+Math.imul(O,J)|0,n=n+Math.imul(P,Q)|0,i=(i=i+Math.imul(P,tt)|0)+Math.imul(I,Q)|0,o=o+Math.imul(I,tt)|0,n=n+Math.imul(S,rt)|0,i=(i=i+Math.imul(S,nt)|0)+Math.imul(A,rt)|0,o=o+Math.imul(A,nt)|0,n=n+Math.imul(x,ot)|0,i=(i=i+Math.imul(x,st)|0)+Math.imul(T,ot)|0,o=o+Math.imul(T,st)|0,n=n+Math.imul(b,ut)|0,i=(i=i+Math.imul(b,ct)|0)+Math.imul(_,ut)|0,o=o+Math.imul(_,ct)|0,n=n+Math.imul(y,ft)|0,i=(i=i+Math.imul(y,lt)|0)+Math.imul(v,ft)|0,o=o+Math.imul(v,lt)|0;var St=(c+(n=n+Math.imul(p,pt)|0)|0)+((8191&(i=(i=i+Math.imul(p,mt)|0)+Math.imul(m,pt)|0))<<13)|0;c=((o=o+Math.imul(m,mt)|0)+(i>>>13)|0)+(St>>>26)|0,St&=67108863,n=Math.imul(F,W),i=(i=Math.imul(F,$))+Math.imul(D,W)|0,o=Math.imul(D,$),n=n+Math.imul(N,Z)|0,i=(i=i+Math.imul(N,J)|0)+Math.imul(L,Z)|0,o=o+Math.imul(L,J)|0,n=n+Math.imul(C,Q)|0,i=(i=i+Math.imul(C,tt)|0)+Math.imul(O,Q)|0,o=o+Math.imul(O,tt)|0,n=n+Math.imul(P,rt)|0,i=(i=i+Math.imul(P,nt)|0)+Math.imul(I,rt)|0,o=o+Math.imul(I,nt)|0,n=n+Math.imul(S,ot)|0,i=(i=i+Math.imul(S,st)|0)+Math.imul(A,ot)|0,o=o+Math.imul(A,st)|0,n=n+Math.imul(x,ut)|0,i=(i=i+Math.imul(x,ct)|0)+Math.imul(T,ut)|0,o=o+Math.imul(T,ct)|0,n=n+Math.imul(b,ft)|0,i=(i=i+Math.imul(b,lt)|0)+Math.imul(_,ft)|0,o=o+Math.imul(_,lt)|0;var At=(c+(n=n+Math.imul(y,pt)|0)|0)+((8191&(i=(i=i+Math.imul(y,mt)|0)+Math.imul(v,pt)|0))<<13)|0;c=((o=o+Math.imul(v,mt)|0)+(i>>>13)|0)+(At>>>26)|0,At&=67108863,n=Math.imul(F,Z),i=(i=Math.imul(F,J))+Math.imul(D,Z)|0,o=Math.imul(D,J),n=n+Math.imul(N,Q)|0,i=(i=i+Math.imul(N,tt)|0)+Math.imul(L,Q)|0,o=o+Math.imul(L,tt)|0,n=n+Math.imul(C,rt)|0,i=(i=i+Math.imul(C,nt)|0)+Math.imul(O,rt)|0,o=o+Math.imul(O,nt)|0,n=n+Math.imul(P,ot)|0,i=(i=i+Math.imul(P,st)|0)+Math.imul(I,ot)|0,o=o+Math.imul(I,st)|0,n=n+Math.imul(S,ut)|0,i=(i=i+Math.imul(S,ct)|0)+Math.imul(A,ut)|0,o=o+Math.imul(A,ct)|0,n=n+Math.imul(x,ft)|0,i=(i=i+Math.imul(x,lt)|0)+Math.imul(T,ft)|0,o=o+Math.imul(T,lt)|0;var Mt=(c+(n=n+Math.imul(b,pt)|0)|0)+((8191&(i=(i=i+Math.imul(b,mt)|0)+Math.imul(_,pt)|0))<<13)|0;c=((o=o+Math.imul(_,mt)|0)+(i>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,n=Math.imul(F,Q),i=(i=Math.imul(F,tt))+Math.imul(D,Q)|0,o=Math.imul(D,tt),n=n+Math.imul(N,rt)|0,i=(i=i+Math.imul(N,nt)|0)+Math.imul(L,rt)|0,o=o+Math.imul(L,nt)|0,n=n+Math.imul(C,ot)|0,i=(i=i+Math.imul(C,st)|0)+Math.imul(O,ot)|0,o=o+Math.imul(O,st)|0,n=n+Math.imul(P,ut)|0,i=(i=i+Math.imul(P,ct)|0)+Math.imul(I,ut)|0,o=o+Math.imul(I,ct)|0,n=n+Math.imul(S,ft)|0,i=(i=i+Math.imul(S,lt)|0)+Math.imul(A,ft)|0,o=o+Math.imul(A,lt)|0;var Pt=(c+(n=n+Math.imul(x,pt)|0)|0)+((8191&(i=(i=i+Math.imul(x,mt)|0)+Math.imul(T,pt)|0))<<13)|0;c=((o=o+Math.imul(T,mt)|0)+(i>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,n=Math.imul(F,rt),i=(i=Math.imul(F,nt))+Math.imul(D,rt)|0,o=Math.imul(D,nt),n=n+Math.imul(N,ot)|0,i=(i=i+Math.imul(N,st)|0)+Math.imul(L,ot)|0,o=o+Math.imul(L,st)|0,n=n+Math.imul(C,ut)|0,i=(i=i+Math.imul(C,ct)|0)+Math.imul(O,ut)|0,o=o+Math.imul(O,ct)|0,n=n+Math.imul(P,ft)|0,i=(i=i+Math.imul(P,lt)|0)+Math.imul(I,ft)|0,o=o+Math.imul(I,lt)|0;var It=(c+(n=n+Math.imul(S,pt)|0)|0)+((8191&(i=(i=i+Math.imul(S,mt)|0)+Math.imul(A,pt)|0))<<13)|0;c=((o=o+Math.imul(A,mt)|0)+(i>>>13)|0)+(It>>>26)|0,It&=67108863,n=Math.imul(F,ot),i=(i=Math.imul(F,st))+Math.imul(D,ot)|0,o=Math.imul(D,st),n=n+Math.imul(N,ut)|0,i=(i=i+Math.imul(N,ct)|0)+Math.imul(L,ut)|0,o=o+Math.imul(L,ct)|0,n=n+Math.imul(C,ft)|0,i=(i=i+Math.imul(C,lt)|0)+Math.imul(O,ft)|0,o=o+Math.imul(O,lt)|0;var Bt=(c+(n=n+Math.imul(P,pt)|0)|0)+((8191&(i=(i=i+Math.imul(P,mt)|0)+Math.imul(I,pt)|0))<<13)|0;c=((o=o+Math.imul(I,mt)|0)+(i>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,n=Math.imul(F,ut),i=(i=Math.imul(F,ct))+Math.imul(D,ut)|0,o=Math.imul(D,ct),n=n+Math.imul(N,ft)|0,i=(i=i+Math.imul(N,lt)|0)+Math.imul(L,ft)|0,o=o+Math.imul(L,lt)|0;var Ct=(c+(n=n+Math.imul(C,pt)|0)|0)+((8191&(i=(i=i+Math.imul(C,mt)|0)+Math.imul(O,pt)|0))<<13)|0;c=((o=o+Math.imul(O,mt)|0)+(i>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,n=Math.imul(F,ft),i=(i=Math.imul(F,lt))+Math.imul(D,ft)|0,o=Math.imul(D,lt);var Ot=(c+(n=n+Math.imul(N,pt)|0)|0)+((8191&(i=(i=i+Math.imul(N,mt)|0)+Math.imul(L,pt)|0))<<13)|0;c=((o=o+Math.imul(L,mt)|0)+(i>>>13)|0)+(Ot>>>26)|0,Ot&=67108863;var Rt=(c+(n=Math.imul(F,pt))|0)+((8191&(i=(i=Math.imul(F,mt))+Math.imul(D,pt)|0))<<13)|0;return c=((o=Math.imul(D,mt))+(i>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,u[0]=gt,u[1]=yt,u[2]=vt,u[3]=wt,u[4]=bt,u[5]=_t,u[6]=Et,u[7]=xt,u[8]=Tt,u[9]=kt,u[10]=St,u[11]=At,u[12]=Mt,u[13]=Pt,u[14]=It,u[15]=Bt,u[16]=Ct,u[17]=Ot,u[18]=Rt,0!==c&&(u[19]=c,r.length++),r};function y(t,e,r){r.negative=e.negative^t.negative,r.length=t.length+e.length;for(var n=0,i=0,o=0;o<r.length-1;o++){var s=i;i=0;for(var a=67108863&n,u=Math.min(o,e.length-1),c=Math.max(0,o-t.length+1);c<=u;c++){var h=o-c,f=(0|t.words[h])*(0|e.words[c]),l=67108863&f;a=67108863&(l=l+a|0),i+=(s=(s=s+(f/67108864|0)|0)+(l>>>26)|0)>>>26,s&=67108863}r.words[o]=a,n=s,s=i}return 0!==n?r.words[o]=n:r.length--,r._strip()}function v(t,e,r){return y(t,e,r)}function w(t,e){this.x=t,this.y=e}Math.imul||(g=m),o.prototype.mulTo=function(t,e){var r=this.length+t.length;return 10===this.length&&10===t.length?g(this,t,e):r<63?m(this,t,e):r<1024?y(this,t,e):v(this,t,e)},w.prototype.makeRBT=function(t){for(var e=new Array(t),r=o.prototype._countBits(t)-1,n=0;n<t;n++)e[n]=this.revBin(n,r,t);return e},w.prototype.revBin=function(t,e,r){if(0===t||t===r-1)return t;for(var n=0,i=0;i<e;i++)n|=(1&t)<<e-i-1,t>>=1;return n},w.prototype.permute=function(t,e,r,n,i,o){for(var s=0;s<o;s++)n[s]=e[t[s]],i[s]=r[t[s]]},w.prototype.transform=function(t,e,r,n,i,o){this.permute(o,t,e,r,n,i);for(var s=1;s<i;s<<=1)for(var a=s<<1,u=Math.cos(2*Math.PI/a),c=Math.sin(2*Math.PI/a),h=0;h<i;h+=a)for(var f=u,l=c,d=0;d<s;d++){var p=r[h+d],m=n[h+d],g=r[h+d+s],y=n[h+d+s],v=f*g-l*y;y=f*y+l*g,g=v,r[h+d]=p+g,n[h+d]=m+y,r[h+d+s]=p-g,n[h+d+s]=m-y,d!==a&&(v=u*f-c*l,l=u*l+c*f,f=v)}},w.prototype.guessLen13b=function(t,e){var r=1|Math.max(e,t),n=1&r,i=0;for(r=r/2|0;r;r>>>=1)i++;return 1<<i+1+n},w.prototype.conjugate=function(t,e,r){if(!(r<=1))for(var n=0;n<r/2;n++){var i=t[n];t[n]=t[r-n-1],t[r-n-1]=i,i=e[n],e[n]=-e[r-n-1],e[r-n-1]=-i}},w.prototype.normalize13b=function(t,e){for(var r=0,n=0;n<e/2;n++){var i=8192*Math.round(t[2*n+1]/e)+Math.round(t[2*n]/e)+r;t[n]=67108863&i,r=i<67108864?0:i/67108864|0}return t},w.prototype.convert13b=function(t,e,r,i){for(var o=0,s=0;s<e;s++)o+=0|t[s],r[2*s]=8191&o,o>>>=13,r[2*s+1]=8191&o,o>>>=13;for(s=2*e;s<i;++s)r[s]=0;n(0===o),n(0==(-8192&o))},w.prototype.stub=function(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=0;return e},w.prototype.mulp=function(t,e,r){var n=2*this.guessLen13b(t.length,e.length),i=this.makeRBT(n),o=this.stub(n),s=new Array(n),a=new Array(n),u=new Array(n),c=new Array(n),h=new Array(n),f=new Array(n),l=r.words;l.length=n,this.convert13b(t.words,t.length,s,n),this.convert13b(e.words,e.length,c,n),this.transform(s,o,a,u,n,i),this.transform(c,o,h,f,n,i);for(var d=0;d<n;d++){var p=a[d]*h[d]-u[d]*f[d];u[d]=a[d]*f[d]+u[d]*h[d],a[d]=p}return this.conjugate(a,u,n),this.transform(a,u,l,o,n,i),this.conjugate(l,o,n),this.normalize13b(l,n),r.negative=t.negative^e.negative,r.length=t.length+e.length,r._strip()},o.prototype.mul=function(t){var e=new o(null);return e.words=new Array(this.length+t.length),this.mulTo(t,e)},o.prototype.mulf=function(t){var e=new o(null);return e.words=new Array(this.length+t.length),v(this,t,e)},o.prototype.imul=function(t){return this.clone().mulTo(t,this)},o.prototype.imuln=function(t){var e=t<0;e&&(t=-t),n("number"==typeof t),n(t<67108864);for(var r=0,i=0;i<this.length;i++){var o=(0|this.words[i])*t,s=(67108863&o)+(67108863&r);r>>=26,r+=o/67108864|0,r+=s>>>26,this.words[i]=67108863&s}return 0!==r&&(this.words[i]=r,this.length++),e?this.ineg():this},o.prototype.muln=function(t){return this.clone().imuln(t)},o.prototype.sqr=function(){return this.mul(this)},o.prototype.isqr=function(){return this.imul(this.clone())},o.prototype.pow=function(t){var e=function(t){for(var e=new Array(t.bitLength()),r=0;r<e.length;r++){var n=r/26|0,i=r%26;e[r]=t.words[n]>>>i&1}return e}(t);if(0===e.length)return new o(1);for(var r=this,n=0;n<e.length&&0===e[n];n++,r=r.sqr());if(++n<e.length)for(var i=r.sqr();n<e.length;n++,i=i.sqr())0!==e[n]&&(r=r.mul(i));return r},o.prototype.iushln=function(t){n("number"==typeof t&&t>=0);var e,r=t%26,i=(t-r)/26,o=67108863>>>26-r<<26-r;if(0!==r){var s=0;for(e=0;e<this.length;e++){var a=this.words[e]&o,u=(0|this.words[e])-a<<r;this.words[e]=u|s,s=a>>>26-r}s&&(this.words[e]=s,this.length++)}if(0!==i){for(e=this.length-1;e>=0;e--)this.words[e+i]=this.words[e];for(e=0;e<i;e++)this.words[e]=0;this.length+=i}return this._strip()},o.prototype.ishln=function(t){return n(0===this.negative),this.iushln(t)},o.prototype.iushrn=function(t,e,r){var i;n("number"==typeof t&&t>=0),i=e?(e-e%26)/26:0;var o=t%26,s=Math.min((t-o)/26,this.length),a=67108863^67108863>>>o<<o,u=r;if(i-=s,i=Math.max(0,i),u){for(var c=0;c<s;c++)u.words[c]=this.words[c];u.length=s}if(0===s);else if(this.length>s)for(this.length-=s,c=0;c<this.length;c++)this.words[c]=this.words[c+s];else this.words[0]=0,this.length=1;var h=0;for(c=this.length-1;c>=0&&(0!==h||c>=i);c--){var f=0|this.words[c];this.words[c]=h<<26-o|f>>>o,h=f&a}return u&&0!==h&&(u.words[u.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},o.prototype.ishrn=function(t,e,r){return n(0===this.negative),this.iushrn(t,e,r)},o.prototype.shln=function(t){return this.clone().ishln(t)},o.prototype.ushln=function(t){return this.clone().iushln(t)},o.prototype.shrn=function(t){return this.clone().ishrn(t)},o.prototype.ushrn=function(t){return this.clone().iushrn(t)},o.prototype.testn=function(t){n("number"==typeof t&&t>=0);var e=t%26,r=(t-e)/26,i=1<<e;return!(this.length<=r)&&!!(this.words[r]&i)},o.prototype.imaskn=function(t){n("number"==typeof t&&t>=0);var e=t%26,r=(t-e)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==e&&r++,this.length=Math.min(r,this.length),0!==e){var i=67108863^67108863>>>e<<e;this.words[this.length-1]&=i}return this._strip()},o.prototype.maskn=function(t){return this.clone().imaskn(t)},o.prototype.iaddn=function(t){return n("number"==typeof t),n(t<67108864),t<0?this.isubn(-t):0!==this.negative?1===this.length&&(0|this.words[0])<=t?(this.words[0]=t-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},o.prototype._iaddn=function(t){this.words[0]+=t;for(var e=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,e===this.length-1?this.words[e+1]=1:this.words[e+1]++;return this.length=Math.max(this.length,e+1),this},o.prototype.isubn=function(t){if(n("number"==typeof t),n(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var e=0;e<this.length&&this.words[e]<0;e++)this.words[e]+=67108864,this.words[e+1]-=1;return this._strip()},o.prototype.addn=function(t){return this.clone().iaddn(t)},o.prototype.subn=function(t){return this.clone().isubn(t)},o.prototype.iabs=function(){return this.negative=0,this},o.prototype.abs=function(){return this.clone().iabs()},o.prototype._ishlnsubmul=function(t,e,r){var i,o,s=t.length+r;this._expand(s);var a=0;for(i=0;i<t.length;i++){o=(0|this.words[i+r])+a;var u=(0|t.words[i])*e;a=((o-=67108863&u)>>26)-(u/67108864|0),this.words[i+r]=67108863&o}for(;i<this.length-r;i++)a=(o=(0|this.words[i+r])+a)>>26,this.words[i+r]=67108863&o;if(0===a)return this._strip();for(n(-1===a),a=0,i=0;i<this.length;i++)a=(o=-(0|this.words[i])+a)>>26,this.words[i]=67108863&o;return this.negative=1,this._strip()},o.prototype._wordDiv=function(t,e){var r=(this.length,t.length),n=this.clone(),i=t,s=0|i.words[i.length-1];0!==(r=26-this._countBits(s))&&(i=i.ushln(r),n.iushln(r),s=0|i.words[i.length-1]);var a,u=n.length-i.length;if("mod"!==e){(a=new o(null)).length=u+1,a.words=new Array(a.length);for(var c=0;c<a.length;c++)a.words[c]=0}var h=n.clone()._ishlnsubmul(i,1,u);0===h.negative&&(n=h,a&&(a.words[u]=1));for(var f=u-1;f>=0;f--){var l=67108864*(0|n.words[i.length+f])+(0|n.words[i.length+f-1]);for(l=Math.min(l/s|0,67108863),n._ishlnsubmul(i,l,f);0!==n.negative;)l--,n.negative=0,n._ishlnsubmul(i,1,f),n.isZero()||(n.negative^=1);a&&(a.words[f]=l)}return a&&a._strip(),n._strip(),"div"!==e&&0!==r&&n.iushrn(r),{div:a||null,mod:n}},o.prototype.divmod=function(t,e,r){return n(!t.isZero()),this.isZero()?{div:new o(0),mod:new o(0)}:0!==this.negative&&0===t.negative?(a=this.neg().divmod(t,e),"mod"!==e&&(i=a.div.neg()),"div"!==e&&(s=a.mod.neg(),r&&0!==s.negative&&s.iadd(t)),{div:i,mod:s}):0===this.negative&&0!==t.negative?(a=this.divmod(t.neg(),e),"mod"!==e&&(i=a.div.neg()),{div:i,mod:a.mod}):0!=(this.negative&t.negative)?(a=this.neg().divmod(t.neg(),e),"div"!==e&&(s=a.mod.neg(),r&&0!==s.negative&&s.isub(t)),{div:a.div,mod:s}):t.length>this.length||this.cmp(t)<0?{div:new o(0),mod:this}:1===t.length?"div"===e?{div:this.divn(t.words[0]),mod:null}:"mod"===e?{div:null,mod:new o(this.modrn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new o(this.modrn(t.words[0]))}:this._wordDiv(t,e);var i,s,a},o.prototype.div=function(t){return this.divmod(t,"div",!1).div},o.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},o.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},o.prototype.divRound=function(t){var e=this.divmod(t);if(e.mod.isZero())return e.div;var r=0!==e.div.negative?e.mod.isub(t):e.mod,n=t.ushrn(1),i=t.andln(1),o=r.cmp(n);return o<0||1===i&&0===o?e.div:0!==e.div.negative?e.div.isubn(1):e.div.iaddn(1)},o.prototype.modrn=function(t){var e=t<0;e&&(t=-t),n(t<=67108863);for(var r=(1<<26)%t,i=0,o=this.length-1;o>=0;o--)i=(r*i+(0|this.words[o]))%t;return e?-i:i},o.prototype.modn=function(t){return this.modrn(t)},o.prototype.idivn=function(t){var e=t<0;e&&(t=-t),n(t<=67108863);for(var r=0,i=this.length-1;i>=0;i--){var o=(0|this.words[i])+67108864*r;this.words[i]=o/t|0,r=o%t}return this._strip(),e?this.ineg():this},o.prototype.divn=function(t){return this.clone().idivn(t)},o.prototype.egcd=function(t){n(0===t.negative),n(!t.isZero());var e=this,r=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var i=new o(1),s=new o(0),a=new o(0),u=new o(1),c=0;e.isEven()&&r.isEven();)e.iushrn(1),r.iushrn(1),++c;for(var h=r.clone(),f=e.clone();!e.isZero();){for(var l=0,d=1;0==(e.words[0]&d)&&l<26;++l,d<<=1);if(l>0)for(e.iushrn(l);l-- >0;)(i.isOdd()||s.isOdd())&&(i.iadd(h),s.isub(f)),i.iushrn(1),s.iushrn(1);for(var p=0,m=1;0==(r.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(a.isOdd()||u.isOdd())&&(a.iadd(h),u.isub(f)),a.iushrn(1),u.iushrn(1);e.cmp(r)>=0?(e.isub(r),i.isub(a),s.isub(u)):(r.isub(e),a.isub(i),u.isub(s))}return{a:a,b:u,gcd:r.iushln(c)}},o.prototype._invmp=function(t){n(0===t.negative),n(!t.isZero());var e=this,r=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var i,s=new o(1),a=new o(0),u=r.clone();e.cmpn(1)>0&&r.cmpn(1)>0;){for(var c=0,h=1;0==(e.words[0]&h)&&c<26;++c,h<<=1);if(c>0)for(e.iushrn(c);c-- >0;)s.isOdd()&&s.iadd(u),s.iushrn(1);for(var f=0,l=1;0==(r.words[0]&l)&&f<26;++f,l<<=1);if(f>0)for(r.iushrn(f);f-- >0;)a.isOdd()&&a.iadd(u),a.iushrn(1);e.cmp(r)>=0?(e.isub(r),s.isub(a)):(r.isub(e),a.isub(s))}return(i=0===e.cmpn(1)?s:a).cmpn(0)<0&&i.iadd(t),i},o.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var e=this.clone(),r=t.clone();e.negative=0,r.negative=0;for(var n=0;e.isEven()&&r.isEven();n++)e.iushrn(1),r.iushrn(1);for(;;){for(;e.isEven();)e.iushrn(1);for(;r.isEven();)r.iushrn(1);var i=e.cmp(r);if(i<0){var o=e;e=r,r=o}else if(0===i||0===r.cmpn(1))break;e.isub(r)}return r.iushln(n)},o.prototype.invm=function(t){return this.egcd(t).a.umod(t)},o.prototype.isEven=function(){return 0==(1&this.words[0])},o.prototype.isOdd=function(){return 1==(1&this.words[0])},o.prototype.andln=function(t){return this.words[0]&t},o.prototype.bincn=function(t){n("number"==typeof t);var e=t%26,r=(t-e)/26,i=1<<e;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var o=i,s=r;0!==o&&s<this.length;s++){var a=0|this.words[s];o=(a+=o)>>>26,a&=67108863,this.words[s]=a}return 0!==o&&(this.words[s]=o,this.length++),this},o.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},o.prototype.cmpn=function(t){var e,r=t<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this._strip(),this.length>1)e=1;else{r&&(t=-t),n(t<=67108863,"Number is too big");var i=0|this.words[0];e=i===t?0:i<t?-1:1}return 0!==this.negative?0|-e:e},o.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return-1;if(0===this.negative&&0!==t.negative)return 1;var e=this.ucmp(t);return 0!==this.negative?0|-e:e},o.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var e=0,r=this.length-1;r>=0;r--){var n=0|this.words[r],i=0|t.words[r];if(n!==i){n<i?e=-1:n>i&&(e=1);break}}return e},o.prototype.gtn=function(t){return 1===this.cmpn(t)},o.prototype.gt=function(t){return 1===this.cmp(t)},o.prototype.gten=function(t){return this.cmpn(t)>=0},o.prototype.gte=function(t){return this.cmp(t)>=0},o.prototype.ltn=function(t){return-1===this.cmpn(t)},o.prototype.lt=function(t){return-1===this.cmp(t)},o.prototype.lten=function(t){return this.cmpn(t)<=0},o.prototype.lte=function(t){return this.cmp(t)<=0},o.prototype.eqn=function(t){return 0===this.cmpn(t)},o.prototype.eq=function(t){return 0===this.cmp(t)},o.red=function(t){return new S(t)},o.prototype.toRed=function(t){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),t.convertTo(this)._forceRed(t)},o.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},o.prototype._forceRed=function(t){return this.red=t,this},o.prototype.forceRed=function(t){return n(!this.red,"Already a number in reduction context"),this._forceRed(t)},o.prototype.redAdd=function(t){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},o.prototype.redIAdd=function(t){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},o.prototype.redSub=function(t){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},o.prototype.redISub=function(t){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},o.prototype.redShl=function(t){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},o.prototype.redMul=function(t){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},o.prototype.redIMul=function(t){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},o.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},o.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},o.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},o.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},o.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},o.prototype.redPow=function(t){return n(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var b={k256:null,p224:null,p192:null,p25519:null};function _(t,e){this.name=t,this.p=new o(e,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function E(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function x(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function T(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function k(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(t){if("string"==typeof t){var e=o._prime(t);this.m=e.p,this.prime=e}else n(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function A(t){S.call(this,t),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var t=new o(null);return t.words=new Array(Math.ceil(this.n/13)),t},_.prototype.ireduce=function(t){var e,r=t;do{this.split(r,this.tmp),e=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(e>this.n);var n=e<this.n?-1:r.ucmp(this.p);return 0===n?(r.words[0]=0,r.length=1):n>0?r.isub(this.p):r.strip!==undefined?r.strip():r._strip(),r},_.prototype.split=function(t,e){t.iushrn(this.n,0,e)},_.prototype.imulK=function(t){return t.imul(this.k)},i(E,_),E.prototype.split=function(t,e){for(var r=4194303,n=Math.min(t.length,9),i=0;i<n;i++)e.words[i]=t.words[i];if(e.length=n,t.length<=9)return t.words[0]=0,void(t.length=1);var o=t.words[9];for(e.words[e.length++]=o&r,i=10;i<t.length;i++){var s=0|t.words[i];t.words[i-10]=(s&r)<<4|o>>>22,o=s}o>>>=22,t.words[i-10]=o,0===o&&t.length>10?t.length-=10:t.length-=9},E.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var e=0,r=0;r<t.length;r++){var n=0|t.words[r];e+=977*n,t.words[r]=67108863&e,e=64*n+(e/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},i(x,_),i(T,_),i(k,_),k.prototype.imulK=function(t){for(var e=0,r=0;r<t.length;r++){var n=19*(0|t.words[r])+e,i=67108863&n;n>>>=26,t.words[r]=i,e=n}return 0!==e&&(t.words[t.length++]=e),t},o._prime=function(t){if(b[t])return b[t];var e;if("k256"===t)e=new E;else if("p224"===t)e=new x;else if("p192"===t)e=new T;else{if("p25519"!==t)throw new Error("Unknown prime "+t);e=new k}return b[t]=e,e},S.prototype._verify1=function(t){n(0===t.negative,"red works only with positives"),n(t.red,"red works only with red numbers")},S.prototype._verify2=function(t,e){n(0==(t.negative|e.negative),"red works only with positives"),n(t.red&&t.red===e.red,"red works only with red numbers")},S.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):(h(t,t.umod(this.m)._forceRed(this)),t)},S.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},S.prototype.add=function(t,e){this._verify2(t,e);var r=t.add(e);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},S.prototype.iadd=function(t,e){this._verify2(t,e);var r=t.iadd(e);return r.cmp(this.m)>=0&&r.isub(this.m),r},S.prototype.sub=function(t,e){this._verify2(t,e);var r=t.sub(e);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},S.prototype.isub=function(t,e){this._verify2(t,e);var r=t.isub(e);return r.cmpn(0)<0&&r.iadd(this.m),r},S.prototype.shl=function(t,e){return this._verify1(t),this.imod(t.ushln(e))},S.prototype.imul=function(t,e){return this._verify2(t,e),this.imod(t.imul(e))},S.prototype.mul=function(t,e){return this._verify2(t,e),this.imod(t.mul(e))},S.prototype.isqr=function(t){return this.imul(t,t.clone())},S.prototype.sqr=function(t){return this.mul(t,t)},S.prototype.sqrt=function(t){if(t.isZero())return t.clone();var e=this.m.andln(3);if(n(e%2==1),3===e){var r=this.m.add(new o(1)).iushrn(2);return this.pow(t,r)}for(var i=this.m.subn(1),s=0;!i.isZero()&&0===i.andln(1);)s++,i.iushrn(1);n(!i.isZero());var a=new o(1).toRed(this),u=a.redNeg(),c=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new o(2*h*h).toRed(this);0!==this.pow(h,c).cmp(u);)h.redIAdd(u);for(var f=this.pow(h,i),l=this.pow(t,i.addn(1).iushrn(1)),d=this.pow(t,i),p=s;0!==d.cmp(a);){for(var m=d,g=0;0!==m.cmp(a);g++)m=m.redSqr();n(g<p);var y=this.pow(f,new o(1).iushln(p-g-1));l=l.redMul(y),f=y.redSqr(),d=d.redMul(f),p=g}return l},S.prototype.invm=function(t){var e=t._invmp(this.m);return 0!==e.negative?(e.negative=0,this.imod(e).redNeg()):this.imod(e)},S.prototype.pow=function(t,e){if(e.isZero())return new o(1).toRed(this);if(0===e.cmpn(1))return t.clone();var r=new Array(16);r[0]=new o(1).toRed(this),r[1]=t;for(var n=2;n<r.length;n++)r[n]=this.mul(r[n-1],t);var i=r[0],s=0,a=0,u=e.bitLength()%26;for(0===u&&(u=26),n=e.length-1;n>=0;n--){for(var c=e.words[n],h=u-1;h>=0;h--){var f=c>>h&1;i!==r[0]&&(i=this.sqr(i)),0!==f||0!==s?(s<<=1,s|=f,(4===++a||0===n&&0===h)&&(i=this.mul(i,r[s]),a=0,s=0)):a=0}u=26}return i},S.prototype.convertTo=function(t){var e=t.umod(this.m);return e===t?e.clone():e},S.prototype.convertFrom=function(t){var e=t.clone();return e.red=null,e},o.mont=function(t){return new A(t)},i(A,S),A.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},A.prototype.convertFrom=function(t){var e=this.imod(t.mul(this.rinv));return e.red=null,e},A.prototype.imul=function(t,e){if(t.isZero()||e.isZero())return t.words[0]=0,t.length=1,t;var r=t.imul(e),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},A.prototype.mul=function(t,e){if(t.isZero()||e.isZero())return new o(0)._forceRed(this);var r=t.mul(e),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),s=i;return i.cmp(this.m)>=0?s=i.isub(this.m):i.cmpn(0)<0&&(s=i.iadd(this.m)),s._forceRed(this)},A.prototype.invm=function(t){return this.imod(t._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===e||e,this)}}},{package:"eth-lattice-keyring>bn.js"}],[2810,{},function(){with(this)return function(){"use strict";return function(t,e,r){function n(t){if(Array.isArray(t)){const e=[];for(let r=0;r<t.length;r++)e.push(n(t[r]));const r=d(...e);return d(s(r.length,192),r)}const e=y(t);return 1===e.length&&e[0]<128?e:d(s(e.length,128),e)}function i(t,e,r){if(r>t.length)throw new Error("invalid RLP (safeSlice): end slice of Uint8Array out-of-bounds");return t.slice(e,r)}function o(t){if(0===t[0])throw new Error("invalid RLP: extra zeros");return f(h(t))}function s(t,e){if(t<56)return Uint8Array.from([t+e]);const r=m(t),n=m(e+55+r.length/2);return Uint8Array.from(l(n+r))}function a(t,e=!1){if(!t||0===t.length)return Uint8Array.from([]);const r=u(y(t));if(e)return r;if(0!==r.remainder.length)throw new Error("invalid RLP: remainder must be zero");return r.data}function u(t){let e,r,n,s,a;const c=[],h=t[0];if(h<=127)return{data:t.slice(0,1),remainder:t.slice(1)};if(h<=183){if(e=h-127,n=128===h?Uint8Array.from([]):i(t,1,e),2===e&&n[0]<128)throw new Error("invalid RLP encoding: invalid prefix, single byte < 0x80 are not prefixed");return{data:n,remainder:t.slice(e)}}if(h<=191){if(r=h-182,t.length-1<r)throw new Error("invalid RLP: not enough bytes for string length");if(e=o(i(t,1,r)),e<=55)throw new Error("invalid RLP: expected string length to be greater than 55");return n=i(t,r,e+r),{data:n,remainder:t.slice(e+r)}}if(h<=247){for(e=h-191,s=i(t,1,e);s.length;)a=u(s),c.push(a.data),s=a.remainder;return{data:c,remainder:t.slice(e)}}{if(r=h-246,e=o(i(t,1,r)),e<56)throw new Error("invalid RLP: encoded list too short");const n=r+e;if(n>t.length)throw new Error("invalid RLP: total length is larger than the data");for(s=i(t,r,n);s.length;)a=u(s),c.push(a.data),s=a.remainder;return{data:c,remainder:t.slice(n)}}}Object.defineProperty(r,"__esModule",{value:!0}),r.utils=r.decode=r.encode=void 0,r.encode=n,r.decode=a;const c=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function h(t){let e="";for(let r=0;r<t.length;r++)e+=c[t[r]];return e}function f(t){const e=Number.parseInt(t,16);if(Number.isNaN(e))throw new Error("Invalid byte sequence");return e}function l(t){if("string"!=typeof t)throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){const n=2*r;e[r]=f(t.slice(n,n+2))}return e}function d(...t){if(1===t.length)return t[0];const e=t.reduce(((t,e)=>t+e.length),0),r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){const i=t[e];r.set(i,n),n+=i.length}return r}function p(t){return(new TextEncoder).encode(t)}function m(t){if(t<0)throw new Error("Invalid integer as argument, must be unsigned!");const e=t.toString(16);return e.length%2?`0${e}`:e}function g(t){return t.length>=2&&"0"===t[0]&&"x"===t[1]}function y(t){if(t instanceof Uint8Array)return t;if("string"==typeof t)return g(t)?l((e="string"!=typeof(r=t)?r:g(r)?r.slice(2):r).length%2?`0${e}`:e):p(t);var e,r;if("number"==typeof t||"bigint"==typeof t)return t?l(m(t)):Uint8Array.from([]);if(null===t||t===undefined)return Uint8Array.from([]);throw new Error("toBytes: received unsupported type "+typeof t)}r.utils={bytesToHex:h,concatBytes:d,hexToBytes:l,utf8ToBytes:p};const v={encode:n,decode:a};r.default=v}}},{package:"eth-lattice-keyring>rlp"}],[2836,{"@ethereumjs/tx":626,buffer:2438,"ethereumjs-util":2896,events:2439,hdkey:2837,"trezor-connect":6838,"trezor-connect/lib/plugins/ethereum/typedData":6841},function(){with(this)return function(){"use strict";return function(t,e,r){(function(r){(function(){const{EventEmitter:n}=t("events"),i=t("ethereumjs-util"),o=t("hdkey"),s=t("trezor-connect").default,{TransactionFactory:a}=t("@ethereumjs/tx"),u=t("trezor-connect/lib/plugins/ethereum/typedData"),c="m/44'/60'/0'/0",h={[c]:!0,"m/44'/1'/0'/0":!0},f="Trezor Hardware",l=1e3,d={email:"support@metamask.io",appUrl:"https://metamask.io"};function p(t){return new Promise((e=>setTimeout(e,t)))}function m(t){return"function"==typeof t.getChainId}class g extends n{constructor(t={}){super(),this.type=f,this.accounts=[],this.hdk=new o,this.page=0,this.perPage=5,this.unlockedAccount=0,this.paths={},this.deserialize(t),s.on("DEVICE_EVENT",(t=>{t&&t.payload&&t.payload.features&&(this.model=t.payload.features.model)})),s.init({manifest:d})}getModel(){return this.model}dispose(){s.dispose()}serialize(){return Promise.resolve({hdPath:this.hdPath,accounts:this.accounts,page:this.page,paths:this.paths,perPage:this.perPage,unlockedAccount:this.unlockedAccount})}deserialize(t={}){return this.hdPath=t.hdPath||c,this.accounts=t.accounts||[],this.page=t.page||0,this.perPage=t.perPage||5,Promise.resolve()}isUnlocked(){return Boolean(this.hdk&&this.hdk.publicKey)}unlock(){return this.isUnlocked()?Promise.resolve("already unlocked"):new Promise(((t,e)=>{s.getPublicKey({path:this.hdPath,coin:"ETH"}).then((n=>{n.success?(this.hdk.publicKey=r.from(n.payload.publicKey,"hex"),this.hdk.chainCode=r.from(n.payload.chainCode,"hex"),t("just unlocked")):e(new Error(n.payload&&n.payload.error||"Unknown error"))})).catch((t=>{e(new Error(t&&t.toString()||"Unknown error"))}))}))}setAccountToUnlock(t){this.unlockedAccount=parseInt(t,10)}addAccounts(t=1){return new Promise(((e,r)=>{this.unlock().then((r=>{const n=this.unlockedAccount,i=n+t;for(let t=n;t<i;t++){const e=this._addressFromIndex("m",t);this.accounts.includes(e)||this.accounts.push(e),this.page=0}e(this.accounts)})).catch((t=>{r(t)}))}))}getFirstPage(){return this.page=0,this.__getPage(1)}getNextPage(){return this.__getPage(1)}getPreviousPage(){return this.__getPage(-1)}__getPage(t){return this.page+=t,this.page<=0&&(this.page=1),new Promise(((t,e)=>{this.unlock().then((e=>{const r=(this.page-1)*this.perPage,n=r+this.perPage,o=[];for(let t=r;t<n;t++){const e=this._addressFromIndex("m",t);o.push({address:e,balance:null,index:t}),this.paths[i.toChecksumAddress(e)]=t}t(o)})).catch((t=>{e(t)}))}))}getAccounts(){return Promise.resolve(this.accounts.slice())}removeAccount(t){if(!this.accounts.map((t=>t.toLowerCase())).includes(t.toLowerCase()))throw new Error(`Address ${t} not found in this keyring`);this.accounts=this.accounts.filter((e=>e.toLowerCase()!==t.toLowerCase()))}signTransaction(t,e){return m(e)?this._signTransaction(t,e.getChainId(),e,(t=>(e.v=r.from(t.v,"hex"),e.r=r.from(t.r,"hex"),e.s=r.from(t.s,"hex"),e))):this._signTransaction(t,e.common.chainIdBN().toNumber(),e,(t=>{const r=e.toJSON();return r.type=e.type,r.v=i.addHexPrefix(t.v),r.r=i.addHexPrefix(t.r),r.s=i.addHexPrefix(t.s),a.fromTxData(r,{common:e.common,freeze:Object.isFrozen(e)})}))}async _signTransaction(t,e,r,n){let o;o=m(r)?{to:this._normalize(r.to),value:this._normalize(r.value),data:this._normalize(r.data),chainId:e,nonce:this._normalize(r.nonce),gasLimit:this._normalize(r.gasLimit),gasPrice:this._normalize(r.gasPrice)}:{...r.toJSON(),chainId:e,to:this._normalize(r.to)};try{const e=await this.unlock();await p("just unlocked"===e?l:0);const r=await s.ethereumSignTransaction({path:this._pathFromAddress(t),transaction:o});if(r.success){const e=n(r.payload),o=i.toChecksumAddress(i.addHexPrefix(e.getSenderAddress().toString("hex")));if(o!==i.toChecksumAddress(t))throw new Error("signature doesn't match the right address");return e}throw new Error(r.payload&&r.payload.error||"Unknown error")}catch(t){throw new Error(t&&t.toString()||"Unknown error")}}signMessage(t,e){return this.signPersonalMessage(t,e)}signPersonalMessage(t,e){return new Promise(((r,n)=>{this.unlock().then((o=>{setTimeout((o=>{s.ethereumSignMessage({path:this._pathFromAddress(t),message:i.stripHexPrefix(e),hex:!0}).then((e=>{if(e.success){e.payload.address!==i.toChecksumAddress(t)&&n(new Error("signature doesnt match the right address"));const o=`0x${e.payload.signature}`;r(o)}else n(new Error(e.payload&&e.payload.error||"Unknown error"))})).catch((t=>{n(new Error(t&&t.toString()||"Unknown error"))}))}),"just unlocked"===o?l:0)})).catch((t=>{n(new Error(t&&t.toString()||"Unknown error"))}))}))}async signTypedData(t,e,{version:r}){const n=u(e,"V4"===r),{types:{EIP712Domain:o=[],...a}={},message:c={},domain:h={},primaryType:f,domain_separator_hash:d,message_hash:m}=n,g=await this.unlock();await p("just unlocked"===g?l:0);const y=await s.ethereumSignTypedData({path:this._pathFromAddress(t),data:{types:{EIP712Domain:o,...a},message:c,domain:h,primaryType:f},metamask_v4_compat:!0,domain_separator_hash:d,message_hash:m});if(y.success){if(i.toChecksumAddress(t)!==y.payload.address)throw new Error("signature doesnt match the right address");return y.payload.signature}throw new Error(y.payload&&y.payload.error||"Unknown error")}exportAccount(){return Promise.reject(new Error("Not supported on this device"))}forgetDevice(){this.accounts=[],this.hdk=new o,this.page=0,this.unlockedAccount=0,this.paths={}}setHdPath(t){if(!h[t])throw new Error(`The setHdPath method does not support setting HD Path to ${t}`);this.hdPath!==t&&(this.hdk=new o,this.accounts=[],this.page=0,this.perPage=5,this.unlockedAccount=0,this.paths={}),this.hdPath=t}_normalize(t){return i.bufferToHex(t).toString()}_addressFromIndex(t,e){const r=this.hdk.derive(`${t}/${e}`),n=i.publicToAddress(r.publicKey,!0).toString("hex");return i.toChecksumAddress(`0x${n}`)}_pathFromAddress(t){const e=i.toChecksumAddress(t);let r=this.paths[e];if(void 0===r)for(let t=0;t<1e3;t++)if(e===this._addressFromIndex("m",t)){r=t;break}if(void 0===r)throw new Error("Unknown address");return`${this.hdPath}/${r}`}}g.type=f,e.exports=g}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"eth-trezor-keyring"}],[2837,{assert:2066,coinstring:2491,crypto:2560,"safe-buffer":6615,secp256k1:6626},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("assert"),i=t("safe-buffer").Buffer,o=t("crypto"),s=t("coinstring"),a=t("secp256k1"),u=i.from("Bitcoin seed","utf8"),c=2147483648,h={private:76066276,public:76067358};function f(t){this.versions=t||h,this.depth=0,this.index=0,this._privateKey=null,this._publicKey=null,this.chainCode=null,this._fingerprint=0,this.parentFingerprint=0}function l(t,e,r){var n=i.allocUnsafe(78);n.writeUInt32BE(e,0),n.writeUInt8(t.depth,4);var o=t.depth?t.parentFingerprint:0;return n.writeUInt32BE(o,5),n.writeUInt32BE(t.index,9),t.chainCode.copy(n,13),r.copy(n,45),n}function d(t){var e=o.createHash("sha256").update(t).digest();return o.createHash("rmd160").update(e).digest()}Object.defineProperty(f.prototype,"fingerprint",{get:function(){return this._fingerprint}}),Object.defineProperty(f.prototype,"identifier",{get:function(){return this._identifier}}),Object.defineProperty(f.prototype,"pubKeyHash",{get:function(){return this.identifier}}),Object.defineProperty(f.prototype,"privateKey",{get:function(){return this._privateKey},set:function(t){n.equal(t.length,32,"Private key must be 32 bytes."),n(!0===a.privateKeyVerify(t),"Invalid private key"),this._privateKey=t,this._publicKey=a.publicKeyCreate(t,!0),this._identifier=d(this.publicKey),this._fingerprint=this._identifier.slice(0,4).readUInt32BE(0)}}),Object.defineProperty(f.prototype,"publicKey",{get:function(){return this._publicKey},set:function(t){n(33===t.length||65===t.length,"Public key must be 33 or 65 bytes."),n(!0===a.publicKeyVerify(t),"Invalid public key"),this._publicKey=a.publicKeyConvert(t,!0),this._identifier=d(this.publicKey),this._fingerprint=this._identifier.slice(0,4).readUInt32BE(0),this._privateKey=null}}),Object.defineProperty(f.prototype,"privateExtendedKey",{get:function(){return this._privateKey?s.encode(l(this,this.versions.private,i.concat([i.alloc(1,0),this.privateKey]))):null}}),Object.defineProperty(f.prototype,"publicExtendedKey",{get:function(){return s.encode(l(this,this.versions.public,this.publicKey))}}),f.prototype.derive=function(t){if("m"===t||"M"===t||"m'"===t||"M'"===t)return this;var e=t.split("/"),r=this;return e.forEach((function(t,e){if(0!==e){var i=t.length>1&&"'"===t[t.length-1],o=parseInt(t,10);n(o<c,"Invalid index"),i&&(o+=c),r=r.deriveChild(o)}else n(t,"m","Invalid path")})),r},f.prototype.deriveChild=function(t){var e,r=t>=c,s=i.allocUnsafe(4);if(s.writeUInt32BE(t,0),r){n(this.privateKey,"Could not derive hardened child key");var u=this.privateKey,h=i.alloc(1,0);u=i.concat([h,u]),e=i.concat([u,s])}else e=i.concat([this.publicKey,s]);var l=o.createHmac("sha512",this.chainCode).update(e).digest(),d=l.slice(0,32),p=l.slice(32),m=new f(this.versions);if(this.privateKey)try{m.privateKey=a.privateKeyTweakAdd(this.privateKey,d)}catch(e){return this.derive(t+1)}else try{m.publicKey=a.publicKeyTweakAdd(this.publicKey,d,!0)}catch(e){return this.derive(t+1,r)}return m.chainCode=p,m.depth=this.depth+1,m.parentFingerprint=this.fingerprint,m.index=t,m},f.prototype.sign=function(t){return a.sign(t,this.privateKey).signature},f.prototype.verify=function(t,e){return a.verify(t,e,this.publicKey)},f.prototype.toJSON=function(){return{xpriv:this.privateExtendedKey,xpub:this.publicExtendedKey}},f.fromMasterSeed=function(t,e){var r=o.createHmac("sha512",u).update(t).digest(),n=r.slice(0,32),i=r.slice(32),s=new f(e);return s.chainCode=i,s.privateKey=n,s},f.fromExtendedKey=function(t,e){var r=new f(e=e||h),i=s.decode(t),o=i.readUInt32BE(0);n(o===e.private||o===e.public,"Version mismatch: does not match private or public"),r.depth=i.readUInt8(4),r.parentFingerprint=i.readUInt32BE(5),r.index=i.readUInt32BE(9),r.chainCode=i.slice(13,45);var a=i.slice(45);return 0===a.readUInt8(0)?(n(o===e.private,"Version mismatch: version does not match private"),r.privateKey=a.slice(1)):(n(o===e.public,"Version mismatch: version does not match public"),r.publicKey=a),r},f.fromJSON=function(t){return f.fromExtendedKey(t.xpriv)},f.HARDENED_OFFSET=c,e.exports=f}}},{package:"eth-trezor-keyring>hdkey"}],[29,{"./background-api":25,"./caveat-mutators":26,"./enums":27,"./flask/snap-permissions":28,"./permission-log":30,"./selectors":31,"./specifications":32},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0});var n=t("./caveat-mutators");Object.keys(n).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in r&&r[t]===n[t]||Object.defineProperty(r,t,{enumerable:!0,get:function(){return n[t]}}))}));var i=t("./background-api");Object.keys(i).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in r&&r[t]===i[t]||Object.defineProperty(r,t,{enumerable:!0,get:function(){return i[t]}}))}));var o=t("./enums");Object.keys(o).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in r&&r[t]===o[t]||Object.defineProperty(r,t,{enumerable:!0,get:function(){return o[t]}}))}));var s=t("./permission-log");Object.keys(s).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in r&&r[t]===s[t]||Object.defineProperty(r,t,{enumerable:!0,get:function(){return s[t]}}))}));var a=t("./specifications");Object.keys(a).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in r&&r[t]===a[t]||Object.defineProperty(r,t,{enumerable:!0,get:function(){return a[t]}}))}));var u=t("./selectors");Object.keys(u).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in r&&r[t]===u[t]||Object.defineProperty(r,t,{enumerable:!0,get:function(){return u[t]}}))}));var c=t("./flask/snap-permissions");Object.keys(c).forEach((function(t){"default"!==t&&"__esModule"!==t&&(t in r&&r[t]===c[t]||Object.defineProperty(r,t,{enumerable:!0,get:function(){return c[t]}}))}))}}},{package:"$root$"}],[2902,{bs58check:2451,crypto:2560,"ethereumjs-util":2907,randombytes:6430,"safe-buffer":6615,scryptsy:6625,"uuid/v4":2916},function(){with(this)return function(){"use strict";return function(t,e,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=t("safe-buffer").Buffer,o=t("ethereumjs-util"),s=t("crypto"),a=t("randombytes"),u=t("scryptsy"),c=t("uuid/v4"),h=t("bs58check");function f(t,e){if(!t)throw new Error(e||"Assertion failed")}function l(t,e){return i.concat([t.update(e),t.final()])}var d=function(t,e){if(t&&e)throw new Error("Cannot supply both a private and a public key to the constructor");if(t&&!o.isValidPrivate(t))throw new Error("Private key does not satisfy the curve requirements (ie. it is invalid)");if(e&&!o.isValidPublic(e))throw new Error("Invalid public key");this._privKey=t,this._pubKey=e};Object.defineProperty(d.prototype,"privKey",{get:function(){return f(this._privKey,"This is a public key only wallet"),this._privKey}}),Object.defineProperty(d.prototype,"pubKey",{get:function(){return this._pubKey||(this._pubKey=o.privateToPublic(this.privKey)),this._pubKey}}),d.generate=function(t){if(!t)return new d(a(32));for(var e=new o.BN("088f924eeceeda7fe92e1f5b0fffffffffffffff",16);;){var r=a(32);if(new o.BN(o.privateToAddress(r)).lte(e))return new d(r)}},d.generateVanityAddress=function(t){for("object"!==(void 0===t?"undefined":n(t))&&(t=new RegExp(t));;){var e=a(32),r=o.privateToAddress(e);if(t.test(r.toString("hex")))return new d(e)}},d.prototype.getPrivateKey=function(){return this.privKey},d.prototype.getPrivateKeyString=function(){return o.bufferToHex(this.getPrivateKey())},d.prototype.getPublicKey=function(){return this.pubKey},d.prototype.getPublicKeyString=function(){return o.bufferToHex(this.getPublicKey())},d.prototype.getAddress=function(){return o.publicToAddress(this.pubKey)},d.prototype.getAddressString=function(){return o.bufferToHex(this.getAddress())},d.prototype.getChecksumAddressString=function(){return o.toChecksumAddress(this.getAddressString())},d.prototype.toV3=function(t,e){f(this._privKey,"This is a public key only wallet");var r,n=(e=e||{}).salt||a(32),h=e.iv||a(16),d=e.kdf||"scrypt",p={dklen:e.dklen||32,salt:n.toString("hex")};if("pbkdf2"===d)p.c=e.c||262144,p.prf="hmac-sha256",r=s.pbkdf2Sync(i.from(t),n,p.c,p.dklen,"sha256");else{if("scrypt"!==d)throw new Error("Unsupported kdf");p.n=e.n||262144,p.r=e.r||8,p.p=e.p||1,r=u(i.from(t),n,p.n,p.r,p.p,p.dklen)}var m=s.createCipheriv(e.cipher||"aes-128-ctr",r.slice(0,16),h);if(!m)throw new Error("Unsupported cipher");var g=l(m,this.privKey),y=o.keccak256(i.concat([r.slice(16,32),i.from(g,"hex")]));return{version:3,id:c({random:e.uuid||a(16)}),address:this.getAddress().toString("hex"),crypto:{ciphertext:g.toString("hex"),cipherparams:{iv:h.toString("hex")},cipher:e.cipher||"aes-128-ctr",kdf:d,kdfparams:p,mac:y.toString("hex")}}},d.prototype.getV3Filename=function(t){return["UTC--",(t?new Date(t):new Date).toJSON().replace(/:/g,"-"),"--",this.getAddress().toString("hex")].join("")},d.prototype.toV3String=function(t,e){return JSON.stringify(this.toV3(t,e))},d.fromPublicKey=function(t,e){return e&&(t=o.importPublic(t)),new d(null,t)},d.fromExtendedPublicKey=function(t){return f("xpub"===t.slice(0,4),"Not an extended public key"),t=h.decode(t).slice(45),d.fromPublicKey(t,!0)},d.fromPrivateKey=function(t){return new d(t)},d.fromExtendedPrivateKey=function(t){f("xprv"===t.slice(0,4),"Not an extended private key");var e=h.decode(t);return f(0===e[45],"Invalid extended private key"),d.fromPrivateKey(e.slice(46))},d.fromV1=function(t,e){f("string"==typeof e);var r="object"===(void 0===t?"undefined":n(t))?t:JSON.parse(t);if("1"!==r.Version)throw new Error("Not a V1 wallet");if("scrypt"!==r.Crypto.KeyHeader.Kdf)throw new Error("Unsupported key derivation scheme");var a=r.Crypto.KeyHeader.KdfParams,c=u(i.from(e),i.from(r.Crypto.Salt,"hex"),a.N,a.R,a.P,a.DkLen),h=i.from(r.Crypto.CipherText,"hex");if(o.keccak256(i.concat([c.slice(16,32),h])).toString("hex")!==r.Crypto.MAC)throw new Error("Key derivation failed - possibly wrong passphrase");var p=l(s.createDecipheriv("aes-128-cbc",o.keccak256(c.slice(0,16)).slice(0,16),i.from(r.Crypto.IV,"hex")),h);return new d(p)},d.fromV3=function(t,e,r){f("string"==typeof e);var a,c,h="object"===(void 0===t?"undefined":n(t))?t:JSON.parse(r?t.toLowerCase():t);if(3!==h.version)throw new Error("Not a V3 wallet");if("scrypt"===h.crypto.kdf)c=h.crypto.kdfparams,a=u(i.from(e),i.from(c.salt,"hex"),c.n,c.r,c.p,c.dklen);else{if("pbkdf2"!==h.crypto.kdf)throw new Error("Unsupported key derivation scheme");if("hmac-sha256"!==(c=h.crypto.kdfparams).prf)throw new Error("Unsupported parameters to PBKDF2");a=s.pbkdf2Sync(i.from(e),i.from(c.salt,"hex"),c.c,c.dklen,"sha256")}var p=i.from(h.crypto.ciphertext,"hex");if(o.keccak256(i.concat([a.slice(16,32),p])).toString("hex")!==h.crypto.mac)throw new Error("Key derivation failed - possibly wrong passphrase");var m=l(s.createDecipheriv(h.crypto.cipher,a.slice(0,16),i.from(h.crypto.cipherparams.iv,"hex")),p);return new d(m)},d.fromEthSale=function(t,e){f("string"==typeof e);var r="object"===(void 0===t?"undefined":n(t))?t:JSON.parse(t),a=i.from(r.encseed,"hex"),u=s.pbkdf2Sync(e,e,2e3,32,"sha256").slice(0,16),c=l(s.createDecipheriv("aes-128-cbc",u,a.slice(0,16)),a.slice(16)),h=new d(o.keccak256(c));if(h.getAddress().toString("hex")!==r.ethaddr)throw new Error("Decoded key mismatch - possibly wrong passphrase");return h},e.exports=d}}},{package:"ethereumjs-wallet"}],[2903,{"./bytes":2904,"./hash":2906,"./secp256k1v3-adapter":2909,assert:2066,"bn.js":2394,buffer:2438,"ethjs-util":2913},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.importPublic=r.privateToPublic=r.privateToAddress=r.publicToAddress=r.pubToAddress=r.isValidPublic=r.isValidPrivate=r.isPrecompiled=r.generateAddress2=r.generateAddress=r.isValidChecksumAddress=r.toChecksumAddress=r.isZeroAddress=r.isValidAddress=r.zeroAddress=void 0;var n=t("assert"),i=t("ethjs-util"),o=t("./secp256k1v3-adapter"),s=t("bn.js"),a=t("./bytes"),u=t("./hash");r.zeroAddress=function(){var t=a.zeros(20);return a.bufferToHex(t)},r.isValidAddress=function(t){return/^0x[0-9a-fA-F]{40}$/.test(t)},r.isZeroAddress=function(t){return r.zeroAddress()===a.addHexPrefix(t)},r.toChecksumAddress=function(t,e){t=i.stripHexPrefix(t).toLowerCase();for(var r=e!==undefined?e.toString()+"0x":"",n=u.keccak(r+t).toString("hex"),o="0x",s=0;s<t.length;s++)parseInt(n[s],16)>=8?o+=t[s].toUpperCase():o+=t[s];return o},r.isValidChecksumAddress=function(t,e){return r.isValidAddress(t)&&r.toChecksumAddress(t,e)===t},r.generateAddress=function(t,r){t=a.toBuffer(t);var n=new s(r);return n.isZero()?u.rlphash([t,null]).slice(-20):u.rlphash([t,e.from(n.toArray())]).slice(-20)},r.generateAddress2=function(t,r,i){var o=a.toBuffer(t),s=a.toBuffer(r),c=a.toBuffer(i);return n(20===o.length),n(32===s.length),u.keccak256(e.concat([e.from("ff","hex"),o,s,u.keccak256(c)])).slice(-20)},r.isPrecompiled=function(t){var e=a.unpad(t);return 1===e.length&&e[0]>=1&&e[0]<=8},r.isValidPrivate=function(t){return o.privateKeyVerify(t)},r.isValidPublic=function(t,r){return void 0===r&&(r=!1),64===t.length?o.publicKeyVerify(e.concat([e.from([4]),t])):!!r&&o.publicKeyVerify(t)},r.pubToAddress=function(t,e){return void 0===e&&(e=!1),t=a.toBuffer(t),e&&64!==t.length&&(t=o.publicKeyConvert(t,!1).slice(1)),n(64===t.length),u.keccak(t).slice(-20)},r.publicToAddress=r.pubToAddress,r.privateToAddress=function(t){return r.publicToAddress(r.privateToPublic(t))},r.privateToPublic=function(t){return t=a.toBuffer(t),o.publicKeyCreate(t,!1).slice(1)},r.importPublic=function(t){return 64!==(t=a.toBuffer(t)).length&&(t=o.publicKeyConvert(t,!1).slice(1)),t}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2904,{"bn.js":2394,buffer:2438,"ethjs-util":2913},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.baToJSON=r.addHexPrefix=r.toUnsigned=r.fromSigned=r.bufferToHex=r.bufferToInt=r.toBuffer=r.stripZeros=r.unpad=r.setLengthRight=r.setLength=r.setLengthLeft=r.zeros=void 0;var n=t("ethjs-util"),i=t("bn.js");r.zeros=function(t){return e.allocUnsafe(t).fill(0)},r.setLengthLeft=function(t,e,n){void 0===n&&(n=!1);var i=r.zeros(e);return t=r.toBuffer(t),n?t.length<e?(t.copy(i),i):t.slice(0,e):t.length<e?(t.copy(i,e-t.length),i):t.slice(-e)},r.setLength=r.setLengthLeft,r.setLengthRight=function(t,e){return r.setLength(t,e,!0)},r.unpad=function(t){for(var e=(t=n.stripHexPrefix(t))[0];t.length>0&&"0"===e.toString();)e=(t=t.slice(1))[0];return t},r.stripZeros=r.unpad,r.toBuffer=function(t){if(!e.isBuffer(t))if(Array.isArray(t))t=e.from(t);else if("string"==typeof t){if(!n.isHexString(t))throw new Error("Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: "+t);t=e.from(n.padToEven(n.stripHexPrefix(t)),"hex")}else if("number"==typeof t)t=n.intToBuffer(t);else if(null===t||t===undefined)t=e.allocUnsafe(0);else if(i.isBN(t))t=t.toArrayLike(e);else{if(!t.toArray)throw new Error("invalid type");t=e.from(t.toArray())}return t},r.bufferToInt=function(t){return new i(r.toBuffer(t)).toNumber()},r.bufferToHex=function(t){return"0x"+(t=r.toBuffer(t)).toString("hex")},r.fromSigned=function(t){return new i(t).fromTwos(256)},r.toUnsigned=function(t){return e.from(t.toTwos(256).toArray())},r.addHexPrefix=function(t){return"string"!=typeof t||n.isHexPrefixed(t)?t:"0x"+t},r.baToJSON=function(t){if(e.isBuffer(t))return"0x"+t.toString("hex");if(t instanceof Array){for(var n=[],i=0;i<t.length;i++)n.push(r.baToJSON(t[i]));return n}}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2905,{"bn.js":2394,buffer:2438},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.KECCAK256_RLP=r.KECCAK256_RLP_S=r.KECCAK256_RLP_ARRAY=r.KECCAK256_RLP_ARRAY_S=r.KECCAK256_NULL=r.KECCAK256_NULL_S=r.TWO_POW256=r.MAX_INTEGER=void 0;var n=t("bn.js");r.MAX_INTEGER=new n("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16),r.TWO_POW256=new n("10000000000000000000000000000000000000000000000000000000000000000",16),r.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",r.KECCAK256_NULL=e.from(r.KECCAK256_NULL_S,"hex"),r.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",r.KECCAK256_RLP_ARRAY=e.from(r.KECCAK256_RLP_ARRAY_S,"hex"),r.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",r.KECCAK256_RLP=e.from(r.KECCAK256_RLP_S,"hex")}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2906,{"./bytes":2904,buffer:2438,"create-hash":2553,"ethereum-cryptography/keccak":2841,"ethjs-util":2913,rlp:6613},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.rlphash=r.ripemd160=r.sha256=r.keccak256=r.keccak=void 0;var n=t("ethereum-cryptography/keccak"),i=n.keccak224,o=n.keccak384,s=n.keccak256,a=n.keccak512,u=t("create-hash"),c=t("ethjs-util"),h=t("rlp"),f=t("./bytes");r.keccak=function(t,r){switch(void 0===r&&(r=256),t="string"!=typeof t||c.isHexString(t)?f.toBuffer(t):e.from(t,"utf8"),r||(r=256),r){case 224:return i(t);case 256:return s(t);case 384:return o(t);case 512:return a(t);default:throw new Error("Invald algorithm: keccak"+r)}},r.keccak256=function(t){return r.keccak(t)},r.sha256=function(t){return t=f.toBuffer(t),u("sha256").update(t).digest()},r.ripemd160=function(t,e){t=f.toBuffer(t);var r=u("rmd160").update(t).digest();return!0===e?f.setLength(r,32):r},r.rlphash=function(t){return r.keccak(h.encode(t))}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2907,{"./account":2903,"./bytes":2904,"./constants":2905,"./hash":2906,"./object":2908,"./secp256k1v3-adapter":2909,"./signature":2912,"bn.js":2394,"ethjs-util":2913,rlp:6613},function(){with(this)return function(){"use strict";return function(t,e,r){var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){n===undefined&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===undefined&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.secp256k1=r.rlp=r.BN=void 0;var o=t("./secp256k1v3-adapter");r.secp256k1=o;var s=t("ethjs-util"),a=t("bn.js");r.BN=a;var u=t("rlp");r.rlp=u,Object.assign(r,s),i(t("./constants"),r),i(t("./account"),r),i(t("./hash"),r),i(t("./signature"),r),i(t("./bytes"),r),i(t("./object"),r)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2908,{"./bytes":2904,assert:2066,buffer:2438,"ethjs-util":2913,rlp:6613},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.defineProperties=void 0;var n=t("assert"),i=t("ethjs-util"),o=t("rlp"),s=t("./bytes");r.defineProperties=function(t,r,a){if(t.raw=[],t._fields=[],t.toJSON=function(e){if(void 0===e&&(e=!1),e){var r={};return t._fields.forEach((function(e){r[e]="0x"+t[e].toString("hex")})),r}return s.baToJSON(t.raw)},t.serialize=function(){return o.encode(t.raw)},r.forEach((function(r,i){function o(){return t.raw[i]}function a(o){"00"!==(o=s.toBuffer(o)).toString("hex")||r.allowZero||(o=e.allocUnsafe(0)),r.allowLess&&r.length?(o=s.stripZeros(o),n(r.length>=o.length,"The field "+r.name+" must not have more "+r.length+" bytes")):r.allowZero&&0===o.length||!r.length||n(r.length===o.length,"The field "+r.name+" must have byte length of "+r.length),t.raw[i]=o}t._fields.push(r.name),Object.defineProperty(t,r.name,{enumerable:!0,configurable:!0,get:o,set:a}),r.default&&(t[r.name]=r.default),r.alias&&Object.defineProperty(t,r.alias,{enumerable:!1,configurable:!0,set:a,get:o})})),a)if("string"==typeof a&&(a=e.from(i.stripHexPrefix(a),"hex")),e.isBuffer(a)&&(a=o.decode(a)),Array.isArray(a)){if(a.length>t._fields.length)throw new Error("wrong number of fields in data");a.forEach((function(e,r){t[t._fields[r]]=s.toBuffer(e)}))}else{if("object"!=typeof a)throw new Error("invalid data");var u=Object.keys(a);r.forEach((function(e){-1!==u.indexOf(e.name)&&(t[e.name]=a[e.name]),-1!==u.indexOf(e.alias)&&(t[e.alias]=a[e.alias])}))}}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2909,{"./secp256k1v3-lib/der":2910,"./secp256k1v3-lib/index":2911,buffer:2438,"ethereum-cryptography/secp256k1":2873},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.ecdhUnsafe=r.ecdh=r.recover=r.verify=r.sign=r.signatureImportLax=r.signatureImport=r.signatureExport=r.signatureNormalize=r.publicKeyCombine=r.publicKeyTweakMul=r.publicKeyTweakAdd=r.publicKeyVerify=r.publicKeyConvert=r.publicKeyCreate=r.privateKeyTweakMul=r.privateKeyTweakAdd=r.privateKeyModInverse=r.privateKeyNegate=r.privateKeyImport=r.privateKeyExport=r.privateKeyVerify=void 0;var n=t("ethereum-cryptography/secp256k1"),i=t("./secp256k1v3-lib/index"),o=t("./secp256k1v3-lib/der");r.privateKeyVerify=function(t){return 32===t.length&&n.privateKeyVerify(Uint8Array.from(t))},r.privateKeyExport=function(t,e){if(32!==t.length)throw new RangeError("private key length is invalid");var r=i.privateKeyExport(t,e);return o.privateKeyExport(t,r,e)},r.privateKeyImport=function(t){if(null!==(t=o.privateKeyImport(t))&&32===t.length&&r.privateKeyVerify(t))return t;throw new Error("couldn't import from DER format")},r.privateKeyNegate=function(t){return e.from(n.privateKeyNegate(Uint8Array.from(t)))},r.privateKeyModInverse=function(t){if(32!==t.length)throw new Error("private key length is invalid");return e.from(i.privateKeyModInverse(Uint8Array.from(t)))},r.privateKeyTweakAdd=function(t,r){return e.from(n.privateKeyTweakAdd(Uint8Array.from(t),r))},r.privateKeyTweakMul=function(t,r){return e.from(n.privateKeyTweakMul(Uint8Array.from(t),Uint8Array.from(r)))},r.publicKeyCreate=function(t,r){return e.from(n.publicKeyCreate(Uint8Array.from(t),r))},r.publicKeyConvert=function(t,r){return e.from(n.publicKeyConvert(Uint8Array.from(t),r))},r.publicKeyVerify=function(t){return(33===t.length||65===t.length)&&n.publicKeyVerify(Uint8Array.from(t))},r.publicKeyTweakAdd=function(t,r,i){return e.from(n.publicKeyTweakAdd(Uint8Array.from(t),Uint8Array.from(r),i))},r.publicKeyTweakMul=function(t,r,i){return e.from(n.publicKeyTweakMul(Uint8Array.from(t),Uint8Array.from(r),i))},r.publicKeyCombine=function(t,r){var i=[];return t.forEach((function(t){i.push(Uint8Array.from(t))})),e.from(n.publicKeyCombine(i,r))},r.signatureNormalize=function(t){return e.from(n.signatureNormalize(Uint8Array.from(t)))},r.signatureExport=function(t){return e.from(n.signatureExport(Uint8Array.from(t)))},r.signatureImport=function(t){return e.from(n.signatureImport(Uint8Array.from(t)))},r.signatureImportLax=function(t){if(0===t.length)throw new RangeError("signature length is invalid");var e=o.signatureImportLax(t);if(null===e)throw new Error("couldn't parse DER signature");return i.signatureImport(e)},r.sign=function(t,r,i){if(null===i)throw new TypeError("options should be an Object");var o=undefined;if(i){if(o={},null===i.data)throw new TypeError("options.data should be a Buffer");if(i.data){if(32!=i.data.length)throw new RangeError("options.data length is invalid");o.data=new Uint8Array(i.data)}if(null===i.noncefn)throw new TypeError("options.noncefn should be a Function");i.noncefn&&(o.noncefn=function(t,r,n,o,s){var a=null!=n?e.from(n):null,u=null!=o?e.from(o):null,c=e.from("");return i.noncefn&&(c=i.noncefn(e.from(t),e.from(r),a,u,s)),new Uint8Array(c)})}var s=n.ecdsaSign(Uint8Array.from(t),Uint8Array.from(r),o);return{signature:e.from(s.signature),recovery:s.recid}},r.verify=function(t,e,r){return n.ecdsaVerify(Uint8Array.from(e),Uint8Array.from(t),r)},r.recover=function(t,r,i,o){return e.from(n.ecdsaRecover(Uint8Array.from(r),i,Uint8Array.from(t),o))},r.ecdh=function(t,r){return e.from(n.ecdh(Uint8Array.from(t),Uint8Array.from(r),{}))},r.ecdhUnsafe=function(t,r,n){if(33!==t.length&&65!==t.length)throw new RangeError("public key length is invalid");if(32!==r.length)throw new RangeError("private key length is invalid");return e.from(i.ecdhUnsafe(Uint8Array.from(t),Uint8Array.from(r),n))}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2910,{buffer:2438},function(){with(this)return function(){"use strict";return function(t,e,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0});var e=t.from([48,129,211,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,133,48,129,130,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,33,2,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,36,3,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),n=t.from([48,130,1,19,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,165,48,129,162,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,65,4,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,72,58,218,119,38,163,196,101,93,164,251,252,14,17,8,168,253,23,180,72,166,133,84,25,156,71,208,143,251,16,212,184,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,68,3,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);r.privateKeyExport=function(r,i,o){void 0===o&&(o=!0);var s=t.from(o?e:n);return r.copy(s,o?8:9),i.copy(s,o?181:214),s},r.privateKeyImport=function(t){var e=t.length,r=0;if(e<r+1||48!==t[r])return null;if(e<(r+=1)+1||!(128&t[r]))return null;var n=127&t[r];if(n<1||n>2)return null;if(e<(r+=1)+n)return null;var i=t[r+n-1]|(n>1?t[r+n-2]<<8:0);return e<(r+=n)+i||e<r+3||2!==t[r]||1!==t[r+1]||1!==t[r+2]||e<(r+=3)+2||4!==t[r]||t[r+1]>32||e<r+2+t[r+1]?null:t.slice(r+2,r+2+t[r+1])},r.signatureImportLax=function(e){var r=t.alloc(32,0),n=t.alloc(32,0),i=e.length,o=0;if(48!==e[o++])return null;var s=e[o++];if(128&s&&(o+=s-128)>i)return null;if(2!==e[o++])return null;var a=e[o++];if(128&a){if(o+(s=a-128)>i)return null;for(;s>0&&0===e[o];o+=1,s-=1);for(a=0;s>0;o+=1,s-=1)a=(a<<8)+e[o]}if(a>i-o)return null;var u=o;if(o+=a,2!==e[o++])return null;var c=e[o++];if(128&c){if(o+(s=c-128)>i)return null;for(;s>0&&0===e[o];o+=1,s-=1);for(c=0;s>0;o+=1,s-=1)c=(c<<8)+e[o]}if(c>i-o)return null;var h=o;for(o+=c;a>0&&0===e[u];a-=1,u+=1);if(a>32)return null;var f=e.slice(u,u+a);for(f.copy(r,32-f.length);c>0&&0===e[h];c-=1,h+=1);if(c>32)return null;var l=e.slice(h,h+c);return l.copy(n,32-l.length),{r:r,s:n}}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2911,{"bn.js":2394,buffer:2438,elliptic:2685},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0});var n=t("bn.js"),i=new(0,t("elliptic").ec)("secp256k1"),o=i.curve;r.privateKeyExport=function(t,e){void 0===e&&(e=!0);var r=new n(t);if(r.ucmp(o.n)>=0)throw new Error("couldn't export to DER format");var a=i.g.mul(r);return s(a.getX(),a.getY(),e)},r.privateKeyModInverse=function(t){var r=new n(t);if(r.ucmp(o.n)>=0||r.isZero())throw new Error("private key range is invalid");return r.invm(o.n).toArrayLike(e,"be",32)},r.signatureImport=function(t){var r=new n(t.r);r.ucmp(o.n)>=0&&(r=new n(0));var i=new n(t.s);return i.ucmp(o.n)>=0&&(i=new n(0)),e.concat([r.toArrayLike(e,"be",32),i.toArrayLike(e,"be",32)])},r.ecdhUnsafe=function(t,e,r){void 0===r&&(r=!0);var a=i.keyFromPublic(t),u=new n(e);if(u.ucmp(o.n)>=0||u.isZero())throw new Error("scalar was invalid (zero or overflow)");var c=a.pub.mul(u);return s(c.getX(),c.getY(),r)};var s=function(t,r,n){var i;return n?((i=e.alloc(33))[0]=r.isOdd()?3:2,t.toArrayLike(e,"be",32).copy(i,1)):((i=e.alloc(65))[0]=4,t.toArrayLike(e,"be",32).copy(i,1),r.toArrayLike(e,"be",32).copy(i,33)),i}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2912,{"./bytes":2904,"./hash":2906,"./secp256k1v3-adapter":2909,"bn.js":2394,buffer:2438},function(){with(this)return function(){"use strict";return function(t,e,r){(function(e){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.hashPersonalMessage=r.isValidSignature=r.fromRpcSig=r.toRpcSig=r.ecrecover=r.ecsign=void 0;var n=t("./secp256k1v3-adapter"),i=t("bn.js"),o=t("./bytes"),s=t("./hash");function a(t,e){return e?t-(2*e+35):t-27}function u(t){return 0===t||1===t}r.ecsign=function(t,e,r){var i=n.sign(t,e),o=i.recovery;return{r:i.signature.slice(0,32),s:i.signature.slice(32,64),v:r?o+(2*r+35):o+27}},r.ecrecover=function(t,r,i,s,c){var h=e.concat([o.setLength(i,32),o.setLength(s,32)],64),f=a(r,c);if(!u(f))throw new Error("Invalid signature v value");var l=n.recover(t,h,f);return n.publicKeyConvert(l,!1).slice(1)},r.toRpcSig=function(t,r,n,i){if(!u(a(t,i)))throw new Error("Invalid signature v value");return o.bufferToHex(e.concat([o.setLengthLeft(r,32),o.setLengthLeft(n,32),o.toBuffer(t)]))},r.fromRpcSig=function(t){var e=o.toBuffer(t);if(65!==e.length)throw new Error("Invalid signature length");var r=e[64];return r<27&&(r+=27),{v:r,r:e.slice(0,32),s:e.slice(32,64)}},r.isValidSignature=function(t,e,r,n,o){void 0===n&&(n=!0);var s=new i("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),c=new i("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16);if(32!==e.length||32!==r.length)return!1;if(!u(a(t,o)))return!1;var h=new i(e),f=new i(r);return!(h.isZero()||h.gt(c)||f.isZero()||f.gt(c))&&(!n||1!==f.cmp(s))},r.hashPersonalMessage=function(t){var r=e.from("Ethereum Signed Message:\n"+t.length.toString(),"utf-8");return s.keccak(e.concat([r,t]))}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util"}],[2913,{buffer:2438,"is-hex-prefixed":5592,"strip-hex-prefix":6784},function(){with(this)return function(){"use strict";return function(t,e,r){(function(r){(function(){var n=t("is-hex-prefixed"),i=t("strip-hex-prefix");function o(t){var e=t;if("string"!=typeof e)throw new Error("[ethjs-util] while padding to even, value must be string, is currently "+typeof e+", while padToEven.");return e.length%2&&(e="0"+e),e}function s(t){return"0x"+t.toString(16)}e.exports={arrayContainsArray:function(t,e,r){if(!0!==Array.isArray(t))throw new Error("[ethjs-util] method arrayContainsArray requires input 'superset' to be an array got type '"+typeof t+"'");if(!0!==Array.isArray(e))throw new Error("[ethjs-util] method arrayContainsArray requires input 'subset' to be an array got type '"+typeof e+"'");return e[Boolean(r)?"some":"every"]((function(e){return t.indexOf(e)>=0}))},intToBuffer:function(t){var e=s(t);return new r(o(e.slice(2)),"hex")},getBinarySize:function(t){if("string"!=typeof t)throw new Error("[ethjs-util] while getting binary size, method getBinarySize requires input 'str' to be type String, got '"+typeof t+"'.");return r.byteLength(t,"utf8")},isHexPrefixed:n,stripHexPrefix:i,padToEven:o,intToHex:s,fromAscii:function(t){for(var e="",r=0;r<t.length;r++){var n=t.charCodeAt(r).toString(16);e+=n.length<2?"0"+n:n}return"0x"+e},fromUtf8:function(t){return"0x"+o(new r(t,"utf8").toString("hex")).replace(/^0+|0+$/g,"")},toAscii:function(t){var e="",r=0,n=t.length;for("0x"===t.substring(0,2)&&(r=2);r<n;r+=2){var i=parseInt(t.substr(r,2),16);e+=String.fromCharCode(i)}return e},toUtf8:function(t){return new r(o(i(t).replace(/^0+|0+$/g,"")),"hex").toString("utf8")},getKeys:function(t,e,r){if(!Array.isArray(t))throw new Error("[ethjs-util] method getKeys expecting type Array as 'params' input, got '"+typeof t+"'");if("string"!=typeof e)throw new Error("[ethjs-util] method getKeys expecting type String for input 'key' got '"+typeof e+"'.");for(var n=[],i=0;i<t.length;i++){var o=t[i][e];if(r&&!o)o="";else if("string"!=typeof o)throw new Error("invalid abi");n.push(o)}return n},isHexString:function(t,e){return!("string"!=typeof t||!t.match(/^0x[0-9A-Fa-f]*$/))&&(!e||t.length===2+2*e)}}}).call(this)}).call(this,t("buffer").Buffer)}}},{package:"ethereumjs-wallet>ethereumjs-util>ethjs-util"}],[2914,{},function(){with(this)return function(){"use strict";return function(t,e,r){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);e.exports=function(t,e){var r=e||0,i=n;return[i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],"-",i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]],i[t[r++]]].join("")}}}},{package:"ethereumjs-wallet>uuid"}],[2915,{},function(){with(this)return function(){"use strict";return function(t,e,r){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);e.exports=function(){return n(i),i}}else{var o=new Array(16);e.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),o[e]=t>>>((3&e)<<3)&255;return o}}}}},{package:"ethereumjs-wallet>uuid"}],[2916,{"./lib/bytesToUuid":2914,"./lib/rng":2915},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("./lib/rng"),i=t("./lib/bytesToUuid");e.exports=function(t,e,r){var o=e&&r||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.rng||n)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var a=0;a<16;++a)e[o+a]=s[a];return e||i(s)}}}},{package:"ethereumjs-wallet>uuid"}],[2917,{"./index.js":2902,"aes-js":2017,crypto:2560,"ethereumjs-util":2907,"safe-buffer":6615,scryptsy:6625,utf8:6886},function(){with(this)return function(){"use strict";return function(t,e,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=t("./index.js"),o=t("ethereumjs-util"),s=t("crypto"),a=t("scryptsy"),u=t("utf8"),c=t("aes-js"),h=t("safe-buffer").Buffer;function f(t,e){if(!t)throw new Error(e||"Assertion failed")}var l={};l.fromEtherWallet=function(t,e){var r,o="object"===(void 0===t?"undefined":n(t))?t:JSON.parse(t);if(o.locked){if("string"!=typeof e)throw new Error("Password required");if(e.length<7)throw new Error("Password must be at least 7 characters");var a=o.encrypted?o.private.slice(0,128):o.private;if(a=function(t){var e=h.from(t,"base64");return"Salted__"===e.slice(0,8).toString()?{salt:e.slice(8,16),ciphertext:e.slice(16)}:{ciphertext:e}}(a),!a.salt)throw new Error("Unsupported EtherWallet key format");var c=function(t,e,r){function n(n){var i=s.createHash(r.digest||"md5");i.update(n),i.update(t),i.update(e),n=i.digest();for(var o=1;o<(r.count||1);o++)(i=s.createHash(r.digest||"md5")).update(n),n=i.digest();return n}for(var i=r.keysize||16,o=r.ivsize||16,a=[],u=0;h.concat(a).length<i+o;)a[u]=n(0===u?h.alloc(0):a[u-1]),u++;var c=h.concat(a);return{key:c.slice(0,i),iv:c.slice(i,i+o)}}(h.from(e),a.salt,{keysize:32,ivsize:16});r=function(t,e){return h.concat([t.update(e),t.final()])}(s.createDecipheriv("aes-256-cbc",c.key,c.iv),h.from(a.ciphertext)),r=h.from(u.decode(r.toString()),"hex")}else{if(64!==o.private.length)throw new Error("Invalid private key length");r=h.from(o.private,"hex")}var f=new i(r);if(f.getAddressString()!==o.address)throw new Error("Invalid private key or address");return f},l.fromEtherCamp=function(t){return new i(o.keccak256(h.from(t)))},l.fromKryptoKit=function(t,e){"#"===t[0]&&(t=t.slice(1));var r,n=t[0];if(t=t.slice(1),"d"===n)r=o.sha256(h.from(t));else{if("q"!==n)throw new Error("Unsupported or invalid entropy type");if("string"!=typeof e)throw new Error("Password required");var s=o.sha256(h.from(t.slice(0,30))),u=t.slice(30,46),f=function(t){function e(t){try{return decodeURIComponent(t)}catch(t){return String.fromCharCode(65533)}}for(var r="",n="",i=0;i<t.length;i++)t[i]<=127?(r+=e(n)+String.fromCharCode(t[i]),n=""):n+="%"+t[i].toString(16);return h.from(r+e(n))}(s),l=a(h.from(e,"utf8"),f,16384,8,1,32),d=new c.ModeOfOperation.ecb(l);if(r=h.concat([h.from(d.decrypt(s.slice(0,16))),h.from(d.decrypt(s.slice(16,32)))]),u.length>0&&u!==o.sha256(o.sha256(r)).slice(0,8).toString("hex"))throw new Error("Failed to decrypt input - possibly invalid passphrase")}return new i(r)},l.fromQuorumWallet=function(t,e){f(t.length>=10),f(e.length>=10);var r=t+e;return r=s.pbkdf2Sync(r,r,2e3,32,"sha256"),new i(r)},e.exports=l}}},{package:"ethereumjs-wallet"}],[30,{"../../../../shared/constants/permissions":7061,"./enums":27,"@metamask/obs-store":1471},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.PermissionLogController=void 0;var n=t("@metamask/obs-store"),i=t("../../../../shared/constants/permissions"),o=t("./enums");function s(t,e){return t.reduce(((t,r)=>({...t,[r]:e})),{})}r.PermissionLogController=class{constructor({restrictedMethods:t,initState:e}){this.restrictedMethods=t,this.store=new n.ObservableStore({permissionHistory:{},permissionActivityLog:[],...e})}getActivityLog(){return this.store.getState().permissionActivityLog}updateActivityLog(t){this.store.updateState({permissionActivityLog:t})}getHistory(){return this.store.getState().permissionHistory}updateHistory(t){this.store.updateState({permissionHistory:t})}updateAccountsHistory(t,e){if(0===e.length)return;const r=s(e,Date.now());this.commitNewHistory(t,{eth_accounts:{accounts:r}})}createMiddleware(){return(t,e,r,n)=>{let i,s;const{origin:a,method:u}=t,c=u.startsWith(o.WALLET_PREFIX);if(o.LOG_IGNORE_METHODS.includes(u)||!c&&!this.restrictedMethods.has(u)){if("eth_requestAccounts"!==u)return void r();i=this.logRequest(t,c),s=["eth_accounts"]}else i=this.logRequest(t,c),u===`${o.WALLET_PREFIX}requestPermissions`&&(s=this.getRequestedMethods(t));r((t=>{const r=Date.now();this.logResponse(i,e,r),s&&!e.error&&e.result&&this.logPermissionsHistory(s,a,e.result,r,"eth_requestAccounts"===u),t()}))}}logRequest(t,e){const r={id:t.id,method:t.method,methodType:e?o.LOG_METHOD_TYPES.internal:o.LOG_METHOD_TYPES.restricted,origin:t.origin,requestTime:Date.now(),responseTime:null,success:null};return this.commitNewActivity(r),r}logResponse(t,e,r){t&&e&&(t.success=Object.hasOwnProperty.call(e,"result"),t.responseTime=r)}commitNewActivity(t){const e=this.getActivityLog();e.push(t),e.length>o.LOG_LIMIT&&e.shift(),this.updateActivityLog(e)}logPermissionsHistory(t,e,r,n,i){let o,a;if(i){o=r;a={eth_accounts:{accounts:s(o,n),lastApproved:n}}}else a=r.map((t=>("eth_accounts"===t.parentCapability&&(o=this.getAccountsFromPermission(t)),t.parentCapability))).reduce(((e,r)=>{if(t.includes(r))if("eth_accounts"===r){const t=s(o,n);e[r]={lastApproved:n,accounts:t}}else e[r]={lastApproved:n};return e}),{});Object.keys(a).length>0&&this.commitNewHistory(e,a)}commitNewHistory(t,e){const r=this.getHistory(),n={...r[t],...e},i=r[t]&&r[t].eth_accounts,o=e.eth_accounts;if(i&&o){const t=o.lastApproved||i.lastApproved;n.eth_accounts={lastApproved:t,accounts:{...i.accounts,...o.accounts}}}r[t]=n,this.updateHistory(r)}getRequestedMethods(t){return t.params&&t.params[0]&&"object"==typeof t.params[0]&&!Array.isArray(t.params[0])?Object.keys(t.params[0]):null}getAccountsFromPermission(t){if("eth_accounts"!==t.parentCapability||!t.caveats)return[];const e=new Set;for(const r of t.caveats)if(r.type===i.CaveatTypes.restrictReturnedAccounts&&Array.isArray(r.value))for(const t of r.value)e.add(t);return[...e]}}}}},{package:"$root$"}],[305,{},function(){with(this)return function(){"use strict";return function(t,e,r){const n=new Proxy(Reflect.construct,{get:function(t,e){return"default"===e?t:"__esModule"===e||Reflect.get(...arguments)}});e.exports=n}}},{package:"@babel/runtime"}],[309,{"./superPropBase.js":328},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("./superPropBase.js");function i(){return"undefined"!=typeof Reflect&&Reflect.get?(e.exports=i=Reflect.get.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=i=function(t,e,r){var i=n(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},e.exports.__esModule=!0,e.exports.default=e.exports),i.apply(this,arguments)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports}}},{package:"@babel/runtime"}],[31,{"../../../../shared/constants/permissions":7061,reselect:6605},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getPermittedAccountsByOrigin=r.getChangedAccounts=void 0;var n=t("reselect"),i=t("../../../../shared/constants/permissions");const o=(0,n.createSelector)((t=>t.subjects),(t=>Object.values(t).reduce(((t,e)=>{var r,n;const o=null===(r=e.permissions)||void 0===r||null===(n=r.eth_accounts)||void 0===n?void 0:n.caveats.find((({type:t})=>t===i.CaveatTypes.restrictReturnedAccounts));return o&&t.set(e.origin,o.value),t}),new Map)));r.getPermittedAccountsByOrigin=o;r.getChangedAccounts=(t,e)=>{if(e===undefined)return t;const r=new Map;if(t===e)return r;const n=new Set([...t.keys()]);for(const o of e.keys()){var i;const s=null!==(i=t.get(o))&&void 0!==i?i:[];e.get(o)!==s&&r.set(o,s),n.delete(o)}for(const e of n.keys())r.set(e,t.get(e));return r}}}},{package:"$root$"}],[315,{},function(){with(this)return function(){"use strict";return function(t,e,r){e.exports=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")},e.exports.__esModule=!0,e.exports.default=e.exports}}},{package:"@babel/runtime"}],[32,{"../../../../shared/constants/permissions":7061,"@metamask/controllers":1294,"@metamask/rpc-methods":1474,"@metamask/snap-controllers":1587},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.unrestrictedMethods=r.getPermissionSpecifications=r.getCaveatSpecifications=void 0;var n=t("@metamask/controllers"),i=t("@metamask/snap-controllers"),o=t("@metamask/rpc-methods"),s=t("../../../../shared/constants/permissions");const a=Object.freeze({...s.RestrictedMethods}),u=Object.freeze({[s.CaveatTypes.restrictReturnedAccounts]:t=>({type:s.CaveatTypes.restrictReturnedAccounts,value:t})});r.getCaveatSpecifications=({getIdentities:t})=>({[s.CaveatTypes.restrictReturnedAccounts]:{type:s.CaveatTypes.restrictReturnedAccounts,decorator:(t,e)=>async r=>(await t(r)).filter((t=>e.value.includes(t))).slice(0,1),validator:(e,r,n)=>function(t,e){if(!Array.isArray(t)||0===t.length)throw new Error(`${a.eth_accounts} error: Expected non-empty array of Ethereum addresses.`);const r=e();t.forEach((t=>{if(!t||"string"!=typeof t)throw new Error(`${a.eth_accounts} error: Expected an array of Ethereum addresses. Received: "${t}".`);if(!r[t])throw new Error(`${a.eth_accounts} error: Received unrecognized address: "${t}".`)}))}(e.value,t)},...o.caveatSpecifications,...i.endowmentCaveatSpecifications});r.getPermissionSpecifications=({getAllAccounts:t,getIdentities:e,captureKeyringTypesWithMissingIdentities:r})=>({[a.eth_accounts]:{permissionType:n.PermissionType.RestrictedMethod,targetKey:a.eth_accounts,allowedCaveats:[s.CaveatTypes.restrictReturnedAccounts],factory:(t,e)=>{if(Array.isArray(t.caveats))throw new Error(`${a.eth_accounts} error: Received unexpected caveats. Any permitted caveats will be added automatically.`);if(!e.approvedAccounts)throw new Error(`${a.eth_accounts} error: No approved accounts specified.`);return(0,n.constructPermission)({...t,caveats:[u[s.CaveatTypes.restrictReturnedAccounts](e.approvedAccounts)]})},methodImplementation:async n=>{const i=await t(),o=e();return i.sort(((t,e)=>{if(!o[t])throw r(o,i),new Error(`Missing identity for address: "${t}".`);if(!o[e])throw r(o,i),new Error(`Missing identity for address: "${e}".`);return o[t].lastSelected===o[e].lastSelected?0:o[t].lastSelected===undefined?1:o[e].lastSelected===undefined?-1:o[e].lastSelected-o[t].lastSelected}))},validator:(t,e,r)=>{const{caveats:n}=t;if(!n||1!==n.length||n[0].type!==s.CaveatTypes.restrictReturnedAccounts)throw new Error(`${a.eth_accounts} error: Invalid caveats. There must be a single caveat of type "${s.CaveatTypes.restrictReturnedAccounts}".`)}}});const c=Object.freeze(["eth_blockNumber","eth_call","eth_chainId","eth_coinbase","eth_decrypt","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getEncryptionPublicKey","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleByBlockHashAndIndex","eth_getUncleByBlockNumberAndIndex","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_getWork","eth_hashrate","eth_mining","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_protocolVersion","eth_sendRawTransaction","eth_sendTransaction","eth_sign","eth_signTypedData","eth_signTypedData_v1","eth_signTypedData_v3","eth_signTypedData_v4","eth_submitHashrate","eth_submitWork","eth_syncing","eth_uninstallFilter","metamask_getProviderState","metamask_watchAsset","net_listening","net_peerCount","net_version","personal_ecRecover","personal_sign","wallet_watchAsset","web3_clientVersion","web3_sha3"]);r.unrestrictedMethods=c}}},{package:"$root$"}],[320,{"./defineProperty.js":307},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("./defineProperty.js");e.exports=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?Object(arguments[e]):{},i=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&i.push.apply(i,Object.getOwnPropertySymbols(r).filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),i.forEach((function(e){n(t,e,r[e])}))}return t},e.exports.__esModule=!0,e.exports.default=e.exports}}},{package:"@babel/runtime"}],[328,{"./getPrototypeOf.js":310},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("./getPrototypeOf.js");e.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=n(t)););return t},e.exports.__esModule=!0,e.exports.default=e.exports}}},{package:"@babel/runtime"}],[33,{"../../../shared/constants/hardware-wallets":7057,"../../../shared/constants/network":7060,"../../../shared/modules/network.utils":7083,"./network":20,"@metamask/obs-store":1471,assert:2066,"eth-sig-util":2823,ethers:2920,loglevel:6059},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,i=t("assert"),o=t("@metamask/obs-store"),s=t("eth-sig-util"),a=t("ethers"),u=(n=t("loglevel"))&&n.__esModule?n:{default:n},c=t("../../../shared/constants/network"),h=t("../../../shared/modules/network.utils"),f=t("../../../shared/constants/hardware-wallets"),l=t("./network");r.default=class{constructor(t={}){const e={frequentRpcListDetail:[],useBlockie:!1,useNonceField:!1,usePhishDetect:!0,dismissSeedBackUpReminder:!1,useTokenDetection:!1,useCollectibleDetection:!1,openSeaEnabled:!1,advancedGasFee:null,featureFlags:{showIncomingTransactions:!0},knownMethodData:{},currentLocale:t.initLangCode,identities:{},lostIdentities:{},forgottenPassword:!1,preferences:{autoLockTimeLimit:undefined,showFiatInTestnets:!1,showTestNetworks:!1,useNativeCurrencyAsPrimaryCurrency:!0,hideZeroBalanceTokens:!1},ipfsGateway:c.IPFS_DEFAULT_GATEWAY_URL,infuraBlocked:null,ledgerTransportType:window.navigator.hid?f.LEDGER_TRANSPORT_TYPES.WEBHID:f.LEDGER_TRANSPORT_TYPES.U2F,theme:"light",customNetworkListEnabled:!1,...t.initState};this.network=t.network,this.ethersProvider=new a.ethers.providers.Web3Provider(t.provider),this.store=new o.ObservableStore(e),this.store.setMaxListeners(12),this.openPopup=t.openPopup,this.migrateAddressBookState=t.migrateAddressBookState,this.tokenListController=t.tokenListController,this._subscribeToInfuraAvailability(),global.setPreference=(t,e)=>this.setFeatureFlag(t,e)}setPasswordForgotten(t){this.store.updateState({forgottenPassword:t})}setUseBlockie(t){this.store.updateState({useBlockie:t})}setUseNonceField(t){this.store.updateState({useNonceField:t})}setUsePhishDetect(t){this.store.updateState({usePhishDetect:t})}setUseTokenDetection(t){this.store.updateState({useTokenDetection:t}),this.tokenListController.updatePreventPollingOnNetworkRestart(!t),t?this.tokenListController.start():(this.tokenListController.clearingTokenListData(),this.tokenListController.stop())}setUseCollectibleDetection(t){this.store.updateState({useCollectibleDetection:t})}setOpenSeaEnabled(t){this.store.updateState({openSeaEnabled:t})}setAdvancedGasFee(t){this.store.updateState({advancedGasFee:t})}setEIP1559V2Enabled(t){this.store.updateState({eip1559V2Enabled:t})}setTheme(t){this.store.updateState({theme:t})}setCustomNetworkListEnabled(t){this.store.updateState({customNetworkListEnabled:t})}addKnownMethodData(t,e){const{knownMethodData:r}=this.store.getState();r[t]=e,this.store.updateState({knownMethodData:r})}setCurrentLocale(t){const e=["ar","dv","fa","he","ku"].includes(t)?"rtl":"auto";return this.store.updateState({currentLocale:t,textDirection:e}),e}setAddresses(t){const e=this.store.getState().identities,r=t.reduce(((t,r,n)=>{const i=e[r]||{};return t[r]={name:`Account ${n+1}`,address:r,...i},t}),{});this.store.updateState({identities:r})}removeAddress(t){const{identities:e}=this.store.getState();if(!e[t])throw new Error(`${t} can't be deleted cause it was not found`);if(delete e[t],this.store.updateState({identities:e}),t===this.getSelectedAddress()){const[t]=Object.keys(e);this.setSelectedAddress(t)}return t}addAddresses(t){const{identities:e}=this.store.getState();t.forEach((t=>{if(e[t])return;const r=Object.keys(e).length;e[t]={name:`Account ${r+1}`,address:t}})),this.store.updateState({identities:e})}syncAddresses(t){if(!Array.isArray(t)||0===t.length)throw new Error("Expected non-empty array of addresses. Error #11201");const{identities:e,lostIdentities:r}=this.store.getState(),n={};Object.keys(e).forEach((r=>{t.includes(r)||(n[r]=e[r],delete e[r])})),Object.keys(n).length>0&&Object.keys(n).forEach((t=>{r[t]=n[t]})),this.store.updateState({identities:e,lostIdentities:r}),this.addAddresses(t);let i=this.getSelectedAddress();return t.includes(i)||([i]=t,this.setSelectedAddress(i)),i}setSelectedAddress(t){const e=(0,s.normalize)(t),{identities:r}=this.store.getState(),n=r[e];if(!n)throw new Error(`Identity for '${e} not found`);n.lastSelected=Date.now(),this.store.updateState({identities:r,selectedAddress:e})}getSelectedAddress(){return this.store.getState().selectedAddress}setAccountLabel(t,e){if(!t)throw new Error(`setAccountLabel requires a valid address, got ${String(t)}`);const r=(0,s.normalize)(t),{identities:n}=this.store.getState();return n[r]=n[r]||{},n[r].name=e,this.store.updateState({identities:n}),Promise.resolve(e)}async updateRpc(t){const e=this.getFrequentRpcListDetail(),r=e.findIndex((e=>e.rpcUrl===t.rpcUrl));if(r>-1){const n=e[r],o={...n,...t};if(n.chainId!==o.chainId){let r=n.chainId;if(!r)try{r=await this.ethersProvider.send("net_version"),(0,i.strict)("string"==typeof r)}catch(t){u.default.debug(t),u.default.warn(`Failed to get networkId from ${n.rpcUrl}; skipping address book migration`)}let s=!1;const a=Object.values(c.BUILT_IN_NETWORKS).map((t=>t.networkId)),h=e.filter((e=>e.rpcUrl!==t.rpcUrl));(a.includes(r)||h.some((t=>t.chainId===r)))&&(s=!0),this.migrateAddressBookState(r,o.chainId,s)}e[r]=o,this.store.updateState({frequentRpcListDetail:e})}else{const{rpcUrl:e,chainId:r,ticker:n,nickname:i,rpcPrefs:o={}}=t;this.addToFrequentRpcList(e,r,n,i,o)}}addToFrequentRpcList(t,e,r="ETH",n="",i={}){const o=this.getFrequentRpcListDetail(),s=o.findIndex((e=>e.rpcUrl===t));if(-1!==s&&o.splice(s,1),!(0,h.isPrefixedFormattedHexString)(e))throw new Error(`Invalid chainId: "${e}"`);o.push({rpcUrl:t,chainId:e,ticker:r,nickname:n,rpcPrefs:i}),this.store.updateState({frequentRpcListDetail:o})}removeFromFrequentRpcList(t){const e=this.getFrequentRpcListDetail(),r=e.findIndex((e=>e.rpcUrl===t));return-1!==r&&e.splice(r,1),this.store.updateState({frequentRpcListDetail:e}),Promise.resolve(e)}getFrequentRpcListDetail(){return this.store.getState().frequentRpcListDetail}setFeatureFlag(t,e){const r={...this.store.getState().featureFlags,[t]:e};return this.store.updateState({featureFlags:r}),Promise.resolve(r)}setPreference(t,e){const r={...this.getPreferences(),[t]:e};return this.store.updateState({preferences:r}),Promise.resolve(r)}getPreferences(){return this.store.getState().preferences}getIpfsGateway(){return this.store.getState().ipfsGateway}setIpfsGateway(t){return this.store.updateState({ipfsGateway:t}),Promise.resolve(t)}setLedgerTransportPreference(t){return this.store.updateState({ledgerTransportType:t}),t}getLedgerTransportPreference(){return this.store.getState().ledgerTransportType}async setDismissSeedBackUpReminder(t){await this.store.updateState({dismissSeedBackUpReminder:t})}_subscribeToInfuraAvailability(){this.network.on(l.NETWORK_EVENTS.INFURA_IS_BLOCKED,(()=>{this._setInfuraBlocked(!0)})),this.network.on(l.NETWORK_EVENTS.INFURA_IS_UNBLOCKED,(()=>{this._setInfuraBlocked(!1)}))}_setInfuraBlocked(t){const{infuraBlocked:e}=this.store.getState();e!==t&&this.store.updateState({infuraBlocked:t})}}}}},{package:"$root$"}],[333,{"./construct.js":305,"./getPrototypeOf.js":310,"./isNativeFunction.js":315,"./setPrototypeOf.js":326},function(){with(this)return function(){"use strict";return function(t,e,r){var n=t("./getPrototypeOf.js"),i=t("./setPrototypeOf.js"),o=t("./isNativeFunction.js"),s=t("./construct.js");function a(t){var r="function"==typeof Map?new Map:undefined;return e.exports=a=function(t){if(null===t||!o(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,e)}function e(){return s(t,arguments,n(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),i(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports,a(t)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports}}},{package:"@babel/runtime"}],[3345,{},function(){with(this)return function(){"use strict";return function(t,e,r){var n=Object.prototype.hasOwnProperty,i="~";function o(){}function s(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function a(t,e,r,n,o){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new s(r,n||t,o),u=i?i+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],a]:t._events[u].push(a):(t._events[u]=a,t._eventsCount++),t}function u(t,e){0==--t._eventsCount?t._events=new o:delete t._events[e]}function c(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(i=!1)),c.prototype.eventNames=function(){var t,e,r=[];if(0===this._eventsCount)return r;for(e in t=this._events)n.call(t,e)&&r.push(i?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},c.prototype.listeners=function(t){var e=i?i+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,o=r.length,s=new Array(o);n<o;n++)s[n]=r[n].fn;return s},c.prototype.listenerCount=function(t){var e=i?i+t:t,r=this._events[e];return r?r.fn?1:r.length:0},c.prototype.emit=function(t,e,r,n,o,s){var a=i?i+t:t;if(!this._events[a])return!1;var u,c,h=this._events[a],f=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,undefined,!0),f){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,r),!0;case 4:return h.fn.call(h.context,e,r,n),!0;case 5:return h.fn.call(h.context,e,r,n,o),!0;case 6:return h.fn.call(h.context,e,r,n,o,s),!0}for(c=1,u=new Array(f-1);c<f;c++)u[c-1]=arguments[c];h.fn.apply(h.context,u)}else{var l,d=h.length;for(c=0;c<d;c++)switch(h[c].once&&this.removeListener(t,h[c].fn,undefined,!0),f){case 1:h[c].fn.call(h[c].context);break;case 2:h[c].fn.call(h[c].context,e);break;case 3:h[c].fn.call(h[c].context,e,r);break;case 4:h[c].fn.call(h[c].context,e,r,n);break;default:if(!u)for(l=1,u=new Array(f-1);l<f;l++)u[l-1]=arguments[l];h[c].fn.apply(h[c].context,u)}}return!0},c.prototype.on=function(t,e,r){return a(this,t,e,r,!1)},c.prototype.once=function(t,e,r){return a(this,t,e,r,!0)},c.prototype.removeListener=function(t,e,r,n){var o=i?i+t:t;if(!this._events[o])return this;if(!e)return u(this,o),this;var s=this._events[o];if(s.fn)s.fn!==e||n&&!s.once||r&&s.context!==r||u(this,o);else{for(var a=0,c=[],h=s.length;a<h;a++)(s[a].fn!==e||n&&!s[a].once||r&&s[a].context!==r)&&c.push(s[a]);c.length?this._events[o]=1===c.length?c[0]:c:u(this,o)}return this},c.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&u(this,e)):(this._events=new o,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=i,c.EventEmitter=c,void 0!==e&&(e.exports=c)}}},{package:"mockttp>@httptoolkit/subscriptions-transport-ws>eventemitter3"}],[34,{"../../../shared/constants/gas":7056,"../../../shared/constants/smartTransactions":7063,"../../../shared/constants/swaps":7064,"../../../shared/constants/time":7065,"../../../shared/lib/fetch-with-cache":7069,"../../../shared/lib/swaps-utils":7072,"../../../shared/lib/transactions-controller-utils":7074,"../../../shared/modules/conversion.utils":7078,"../../../shared/modules/string-utils":7088,"../../../shared/modules/swaps.utils":7089,"./network":20,"@metamask/obs-store":1471,"bignumber.js":2326,ethers:2920,"human-standard-token-abi":5282,lodash:6046,loglevel:6059},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.utils=r.default=void 0;var n=t("ethers"),i=b(t("loglevel")),o=b(t("bignumber.js")),s=t("@metamask/obs-store"),a=t("lodash"),u=b(t("human-standard-token-abi")),c=t("../../../shared/modules/conversion.utils"),h=t("../../../shared/constants/swaps"),f=t("../../../shared/constants/gas"),l=t("../../../shared/constants/smartTransactions"),d=t("../../../shared/modules/swaps.utils"),p=t("../../../shared/lib/swaps-utils"),m=b(t("../../../shared/lib/fetch-with-cache")),g=t("../../../shared/constants/time"),y=t("../../../shared/modules/string-utils"),v=t("../../../shared/lib/transactions-controller-utils"),w=t("./network");function b(t){return t&&t.__esModule?t:{default:t}}const _=25e5,E=g.MINUTE;function x(t=25e5,e=0,r=0){const n=new o.default(t,10).minus(e,10);return!n.lt(0)&&n.lt(r,16)?`0x${n.toString(16)}`:r}const T={quotes:{},quotesPollingLimitEnabled:!1,fetchParams:null,tokens:null,tradeTxId:null,approveTxId:null,quotesLastFetched:null,customMaxGas:"",customGasPrice:null,customMaxFeePerGas:null,customMaxPriorityFeePerGas:null,swapsUserFeeLevel:"",selectedAggId:null,customApproveTxData:"",errorKey:"",topAggId:null,routeState:"",swapsFeatureIsLive:!0,saveFetchedQuotes:!1,swapsQuoteRefreshTime:E,swapsQuotePrefetchingRefreshTime:E,swapsStxBatchStatusRefreshTime:l.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,swapsStxGetTransactionsRefreshTime:l.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,swapsStxMaxFeeMultiplier:l.FALLBACK_SMART_TRANSACTIONS_MAX_FEE_MULTIPLIER,swapsFeatureFlags:{}};function k(t){if(!Array.isArray(t)||0===t.length)throw new Error("Expected non-empty array param.");const e=[...t];if(e.sort(((t,e)=>{const r=new o.default(t.overallValueOfQuote,10),n=new o.default(e.overallValueOfQuote,10);return r.equals(n)?0:r.lessThan(n)?-1:1})),e.length%2==1){const t=e[(e.length-1)/2].overallValueOfQuote;return S(e.filter((e=>t===e.overallValueOfQuote)))}const r=e.length/2,n=r-1,i=e[r].overallValueOfQuote,s=e[n].overallValueOfQuote,a=e.filter((t=>i===t.overallValueOfQuote)),u=e.filter((t=>s===t.overallValueOfQuote)),c=S(a),h=S(u);return{ethFee:new o.default(c.ethFee,10).plus(h.ethFee,10).dividedBy(2).toString(10),metaMaskFeeInEth:new o.default(c.metaMaskFeeInEth,10).plus(h.metaMaskFeeInEth,10).dividedBy(2).toString(10),ethValueOfTokens:new o.default(c.ethValueOfTokens,10).plus(h.ethValueOfTokens,10).dividedBy(2).toString(10)}}function S(t){const e=t.reduce(((t,e)=>({ethFee:t.ethFee.plus(e.ethFee,10),metaMaskFeeInEth:t.metaMaskFeeInEth.plus(e.metaMaskFeeInEth,10),ethValueOfTokens:t.ethValueOfTokens.plus(e.ethValueOfTokens,10)})),{ethFee:new o.default(0,10),metaMaskFeeInEth:new o.default(0,10),ethValueOfTokens:new o.default(0,10)});return{ethFee:e.ethFee.div(t.length,10).toString(10),metaMaskFeeInEth:e.metaMaskFeeInEth.div(t.length,10).toString(10),ethValueOfTokens:e.ethValueOfTokens.div(t.length,10).toString(10)}}r.default=class{constructor({getBufferedGasLimit:t,networkController:e,provider:r,getProviderConfig:i,getTokenRatesState:o,fetchTradesInfo:a=p.fetchTradesInfo,getCurrentChainId:u,getEIP1559GasFeeEstimates:c}){this.store=new s.ObservableStore({swapsState:{...T}}),this._fetchTradesInfo=a,this._getCurrentChainId=u,this._getEIP1559GasFeeEstimates=c,this.getBufferedGasLimit=t,this.getTokenRatesState=o,this.pollCount=0,this.getProviderConfig=i,this.indexOfNewestCallInFlight=0,this.ethersProvider=new n.ethers.providers.Web3Provider(r),this._currentNetwork=e.store.getState().network,e.on(w.NETWORK_EVENTS.NETWORK_DID_CHANGE,(t=>{"loading"!==t&&t!==this._currentNetwork&&(this._currentNetwork=t,this.ethersProvider=new n.ethers.providers.Web3Provider(r))}))}async fetchSwapsNetworkConfig(t){const e=await(0,m.default)((0,p.getBaseApi)("network",t),{method:"GET"},{cacheRefreshTime:6e5}),{refreshRates:r,parameters:n={}}=e||{};if(!r||"number"!=typeof r.quotes||"number"!=typeof r.quotesPrefetching)throw new Error(`MetaMask - invalid response for refreshRates: ${e}`);return{quotes:1e3*r.quotes,quotesPrefetching:1e3*r.quotesPrefetching,stxGetTransactions:1e3*r.stxGetTransactions,stxBatchStatus:1e3*r.stxBatchStatus,stxStatusDeadline:r.stxStatusDeadline,stxMaxFeeMultiplier:n.stxMaxFeeMultiplier}}async _setSwapsNetworkConfig(){var t,e,r,n,i,o;const s=this._getCurrentChainId();let a;try{a=await this.fetchSwapsNetworkConfig(s)}catch(t){console.error("Request for Swaps network config failed: ",t)}const{swapsState:u}=this.store.getState();this.store.updateState({swapsState:{...u,swapsQuoteRefreshTime:(null===(t=a)||void 0===t?void 0:t.quotes)||E,swapsQuotePrefetchingRefreshTime:(null===(e=a)||void 0===e?void 0:e.quotesPrefetching)||E,swapsStxGetTransactionsRefreshTime:(null===(r=a)||void 0===r?void 0:r.stxGetTransactions)||l.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,swapsStxBatchStatusRefreshTime:(null===(n=a)||void 0===n?void 0:n.stxBatchStatus)||l.FALLBACK_SMART_TRANSACTIONS_REFRESH_TIME,swapsStxStatusDeadline:(null===(i=a)||void 0===i?void 0:i.stxStatusDeadline)||l.FALLBACK_SMART_TRANSACTIONS_DEADLINE,swapsStxMaxFeeMultiplier:(null===(o=a)||void 0===o?void 0:o.stxMaxFeeMultiplier)||l.FALLBACK_SMART_TRANSACTIONS_MAX_FEE_MULTIPLIER}})}pollForNewQuotes(){const{swapsState:{swapsQuoteRefreshTime:t,swapsQuotePrefetchingRefreshTime:e,quotesPollingLimitEnabled:r}}=this.store.getState(),n=r?t:e;this.pollingTimeout=setTimeout((()=>{var t;const{swapsState:e}=this.store.getState();this.fetchAndSetQuotes(e.fetchParams,null===(t=e.fetchParams)||void 0===t?void 0:t.metaData,!0)}),n)}stopPollingForQuotes(){this.pollingTimeout&&clearTimeout(this.pollingTimeout)}async fetchAndSetQuotes(t,e={},r){const{chainId:n}=e,{swapsState:{quotesPollingLimitEnabled:i,saveFetchedQuotes:o}}=this.store.getState();if(!t)return null;r||(this.pollCount=0),clearTimeout(this.pollingTimeout),r||this.setSwapsErrorKey("");const s=this.indexOfNewestCallInFlight+1;this.indexOfNewestCallInFlight=s,o||this.setSaveFetchedQuotes(!0);let[u]=await Promise.all([this._fetchTradesInfo(t,{...e}),this._setSwapsNetworkConfig()]);const{swapsState:{saveFetchedQuotes:c}}=this.store.getState();if(!c)return[{},null];u=(0,a.mapValues)(u,(t=>({...t,sourceTokenInfo:e.sourceTokenInfo,destinationTokenInfo:e.destinationTokenInfo})));const f=Date.now();let l=!1;if(!(0,d.isSwapsDefaultTokenAddress)(t.sourceToken,n)&&Object.values(u).length){const e=await this._getERC20Allowance(t.sourceToken,t.fromAddress,n),[i]=Object.values(u);if(l=i.approvalNeeded&&e.eq(0)&&"wrappedNative"!==i.aggregator,l){if(!r){const{gasLimit:t}=await this.timedoutGasReturn(i.approvalNeeded);u=(0,a.mapValues)(u,(e=>({...e,approvalNeeded:{...e.approvalNeeded,gas:t||h.DEFAULT_ERC20_APPROVE_GAS}})))}}else u=(0,a.mapValues)(u,(t=>({...t,approvalNeeded:null})))}let p=null;if(l||null!=t&&t.balanceError||(u=await this.getAllQuotesWithGasEstimates(u)),0===Object.values(u).length)this.setSwapsErrorKey(h.QUOTES_NOT_AVAILABLE_ERROR);else{const[t,e]=await this._findTopQuoteAndCalculateSavings(u);p=t,u=e}if(this.indexOfNewestCallInFlight!==s)throw new Error(h.SWAPS_FETCH_ORDER_CONFLICT);const{swapsState:m}=this.store.getState();let{selectedAggId:g}=m;return u[g]||(g=null),this.store.updateState({swapsState:{...m,quotes:u,fetchParams:{...t,metaData:e},quotesLastFetched:f,selectedAggId:g,topAggId:p}}),i&&(this.pollCount+=1),!i||this.pollCount<4?(this.pollForNewQuotes(),[u,p]):(this.resetPostFetchState(),this.setSwapsErrorKey(h.QUOTES_EXPIRED_ERROR),null)}safeRefetchQuotes(){const{swapsState:t}=this.store.getState();!this.pollingTimeout&&t.fetchParams&&this.fetchAndSetQuotes(t.fetchParams)}setSelectedQuoteAggId(t){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...e,selectedAggId:t}})}setSwapsTokens(t){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...e,tokens:t}})}clearSwapsQuotes(){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...t,quotes:{}}})}setSwapsErrorKey(t){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...e,errorKey:t}})}async getAllQuotesWithGasEstimates(t){const e=await Promise.all(Object.values(t).map((async t=>{const{gasLimit:e,simulationFails:r}=await this.timedoutGasReturn(t.trade);return[e,r,t.aggregator]}))),r={};return e.forEach((([e,n,i])=>{if(e&&!n){const n=x(t[i].maxGas,t[i].estimatedRefund,e);r[i]={...t[i],gasEstimate:e,gasEstimateWithRefund:n}}else t[i].approvalNeeded&&(r[i]=t[i])})),r}timedoutGasReturn(t){return new Promise((e=>{let r=!1;const n=setTimeout((()=>{r=!0,e({gasLimit:null,simulationFails:!0})}),5*g.SECOND),o={data:t.data,from:t.from,to:t.to,value:t.value};this.getBufferedGasLimit({txParams:o},1).then((({gasLimit:t,simulationFails:i})=>{r||(clearTimeout(n),e({gasLimit:t,simulationFails:i}))})).catch((t=>{i.default.error(t),r||(clearTimeout(n),e({gasLimit:null,simulationFails:!0}))}))}))}async setInitialGasEstimate(t){const{swapsState:e}=this.store.getState(),r={...e.quotes[t]},{gasLimit:n,simulationFails:i}=await this.timedoutGasReturn(r.trade);if(n&&!i){const t=x(r.maxGas,r.estimatedRefund,n);r.gasEstimate=n,r.gasEstimateWithRefund=t}this.store.updateState({swapsState:{...e,quotes:{...e.quotes,[t]:r}}})}setApproveTxId(t){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...e,approveTxId:t}})}setTradeTxId(t){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...e,tradeTxId:t}})}setQuotesLastFetched(t){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...e,quotesLastFetched:t}})}setSwapsTxGasPrice(t){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...e,customGasPrice:t}})}setSwapsTxMaxFeePerGas(t){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...e,customMaxFeePerGas:t}})}setSwapsUserFeeLevel(t){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...e,swapsUserFeeLevel:t}})}setSwapsQuotesPollingLimitEnabled(t){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...e,quotesPollingLimitEnabled:t}})}setSwapsTxMaxFeePriorityPerGas(t){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...e,customMaxPriorityFeePerGas:t}})}setSwapsTxGasLimit(t){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...e,customMaxGas:t}})}setCustomApproveTxData(t){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...e,customApproveTxData:t}})}setBackgroundSwapRouteState(t){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...e,routeState:t}})}setSaveFetchedQuotes(t){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...e,saveFetchedQuotes:t}})}setSwapsLiveness(t){const{swapsState:e}=this.store.getState(),{swapsFeatureIsLive:r}=t;this.store.updateState({swapsState:{...e,swapsFeatureIsLive:r}})}setSwapsFeatureFlags(t){const{swapsState:e}=this.store.getState();this.store.updateState({swapsState:{...e,swapsFeatureFlags:t}})}resetPostFetchState(){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...T,tokens:t.tokens,fetchParams:t.fetchParams,swapsFeatureIsLive:t.swapsFeatureIsLive,swapsQuoteRefreshTime:t.swapsQuoteRefreshTime,swapsQuotePrefetchingRefreshTime:t.swapsQuotePrefetchingRefreshTime,swapsFeatureFlags:t.swapsFeatureFlags}}),clearTimeout(this.pollingTimeout)}resetSwapsState(){const{swapsState:t}=this.store.getState();this.store.updateState({swapsState:{...T,swapsQuoteRefreshTime:t.swapsQuoteRefreshTime,swapsQuotePrefetchingRefreshTime:t.swapsQuotePrefetchingRefreshTime}}),clearTimeout(this.pollingTimeout)}async _findTopQuoteAndCalculateSavings(t={}){const{contractExchangeRates:e}=this.getTokenRatesState(),{swapsState:{customGasPrice:r,customMaxPriorityFeePerGas:n}}=this.store.getState(),i=this._getCurrentChainId();if(!Object.keys(t).length)return{};const s=(0,a.cloneDeep)(t),{gasFeeEstimates:u,gasEstimateType:h}=await this._getEIP1559GasFeeEstimates();let l="0x0";if(h===f.GAS_ESTIMATE_TYPES.FEE_MARKET){const{high:{suggestedMaxPriorityFeePerGas:t},estimatedBaseFee:e}=u;l=(0,c.addCurrencies)(n||(0,c.decGWEIToHexWEI)(t),(0,c.decGWEIToHexWEI)(e),{aBase:16,bBase:16,toNumericBase:"hex",numberOfDecimals:6})}else h===f.GAS_ESTIMATE_TYPES.LEGACY?l=r||(0,c.decGWEIToHexWEI)(u.high):h===f.GAS_ESTIMATE_TYPES.ETH_GASPRICE&&(l=r||(0,c.decGWEIToHexWEI)(u.gasPrice));let p=null,m=null;Object.values(s).forEach((t=>{const{aggregator:r,approvalNeeded:n,averageGas:s,destinationAmount:a=0,destinationToken:u,destinationTokenInfo:h,gasEstimateWithRefund:f,sourceAmount:g,sourceToken:w,trade:b,fee:E}=t,x=(f?new o.default(f,16):new o.default(s||_,10)).plus((null==n?void 0:n.gas)||"0x0",16).toString(16),T=(0,v.calcGasTotal)(x,l),k=new o.default(T,16).plus(b.value,16),S=(0,c.conversionUtil)(k,{fromCurrency:"ETH",fromDenomination:"WEI",toDenomination:"ETH",fromNumericBase:"BN",numberOfDecimals:6}),A=(0,d.isSwapsDefaultTokenAddress)(w,i)?(0,c.conversionUtil)(k.minus(g,10),{fromCurrency:"ETH",fromDenomination:"WEI",toDenomination:"ETH",fromNumericBase:"BN",numberOfDecimals:6}):S,M=(0,v.calcTokenAmount)(a,h.decimals),P=new o.default(100,10).minus(E,10).div(100),I=M.div(P).minus(M),B=e[Object.keys(e).find((t=>(0,y.isEqualCaseInsensitive)(t,u)))],C=B||1,O=M.times(C.toString(10),10),R=(0,d.isSwapsDefaultTokenAddress)(u,i)?1:B,N=R===undefined?O:O.minus(A,10);t.ethFee=A.toString(10),R!==undefined&&(t.ethValueOfTokens=O.toString(10),t.overallValueOfQuote=N.toString(10),t.metaMaskFeeInEth=I.times(R.toString(10)).toString(10)),(null===m||N.gt(m))&&(p=r,m=N)}));let g=null;if((0,d.isSwapsDefaultTokenAddress)(s[p].destinationToken,i)||Boolean(e[Object.keys(e).find((t=>{var e;return(0,y.isEqualCaseInsensitive)(t,null===(e=s[p])||void 0===e?void 0:e.destinationToken)}))])){const t=s[p];g={};const{ethFee:e,metaMaskFeeInEth:r,ethValueOfTokens:n}=k(Object.values(s));g.performance=new o.default(t.ethValueOfTokens,10).minus(n,10),g.fee=new o.default(e).minus(t.ethFee,10),g.metaMaskFee=t.metaMaskFeeInEth,g.total=g.performance.plus(g.fee).minus(g.metaMaskFee).toString(10),g.performance=g.performance.toString(10),g.fee=g.fee.toString(10),g.medianMetaMaskFee=r,s[p].isBestQuote=!0,s[p].savings=g}return[p,s]}async _getERC20Allowance(t,e,r){const i=new n.ethers.Contract(t,u.default,this.ethersProvider);return await i.allowance(e,h.SWAPS_CHAINID_CONTRACT_ADDRESS_MAP[r])}};const A={getMedianEthValueQuote:k,meansOfQuotesFeesAndValue:S};r.utils=A}}},{package:"$root$"}],[35,{"../../../development/mock-3box":170,"../lib/createOriginMiddleware":53,"../lib/migrator":69,"../migrations":166,"./network/createMetamaskMiddleware":19,"3box":176,"@metamask/obs-store":1471,"eth-json-rpc-middleware":2771,"json-rpc-engine":5626,loglevel:6059},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=t("@metamask/obs-store"),i=f(t("loglevel")),o=t("json-rpc-engine"),s=t("eth-json-rpc-middleware"),a=f(t("../lib/migrator")),u=f(t("../migrations")),c=f(t("../lib/createOriginMiddleware")),h=f(t("./network/createMetamaskMiddleware"));function f(t){return t&&t.__esModule?t:{default:t}}const l=t("3box");r.default=class{constructor(t={}){const{preferencesController:e,keyringController:r,addressBookController:i,version:o,getKeyringControllerState:s,trackMetaMetricsEvent:a}=t;this.preferencesController=e,this.addressBookController=i,this.keyringController=r,this.provider=this._createProvider({version:o,getAccounts:async({origin:t})=>{if("3Box"!==t)return[];const{isUnlocked:e}=s(),r=await this.keyringController.getAccounts();if(e&&r[0]){return[await this.keyringController.getAppKeyAddress(r[0],"wallet://3box.metamask.io")]}return[]},processPersonalMessage:async t=>{const e=await this.keyringController.getAccounts();return r.signPersonalMessage({...t,from:e[0]},{withAppKeyOrigin:"wallet://3box.metamask.io"})}}),this._trackMetaMetricsEvent=a;const c={threeBoxSyncingAllowed:!1,showRestorePrompt:!0,threeBoxLastUpdated:0,...t.initState,threeBoxAddress:null,threeBoxSynced:!1,threeBoxDisabled:!1};this.store=new n.ObservableStore(c),this.registeringUpdates=!1,this.lastMigration=u.default.sort(((t,e)=>t.version-e.version)).slice(-1)[0],c.threeBoxSyncingAllowed&&this.init()}async init(){const t=await this.keyringController.getAccounts();this.address=t[0],this._trackMetaMetricsEvent({event:"3Box Initiated",category:"3Box"}),!this.address||this.box&&this.store.getState().threeBoxSynced||await this.new3Box()}async _update3Box(){try{const{threeBoxSyncingAllowed:t,threeBoxSynced:e}=this.store.getState();if(t&&e){const t={preferences:this.preferencesController.store.getState(),addressBook:this.addressBookController.state,lastUpdated:Date.now(),lastMigration:this.lastMigration};await this.space.private.set("metamaskBackup",JSON.stringify(t)),await this.setShowRestorePromptToFalse()}}catch(t){console.error(t)}}_createProvider(t){const e=(0,h.default)(t),r=new o.JsonRpcEngine;r.push((0,c.default)({origin:"3Box"})),r.push(e);return(0,s.providerFromEngine)(r)}_waitForOnSyncDone(){return new Promise((t=>{this.box.onSyncDone((()=>(i.default.debug("3Box box sync done"),t())))}))}async new3Box(){const t=await this.keyringController.getAccounts();let e;this.address=await this.keyringController.getAppKeyAddress(t[0],"wallet://3box.metamask.io");try{const t=await l.getConfig(this.address);e=t.spaces&&t.spaces.metamask}catch(t){if(!t.message.match(/^Error: Invalid response \(404\)/u))throw this._trackMetaMetricsEvent({event:"3Box Config Error",category:"3Box"}),t;this._trackMetaMetricsEvent({event:"3Box Backup does not exist",category:"3Box"}),e=!1}if(this.getThreeBoxSyncingState()||e){this.store.updateState({threeBoxSynced:!1});let t=!1;const e=setTimeout((()=>{i.default.error("3Box sync timed out after 60000 ms"),t=!0,this.store.updateState({threeBoxDisabled:!0,threeBoxSyncingAllowed:!1})}),6e4);try{this.box=await l.openBox(this.address,this.provider),await this._waitForOnSyncDone(),this.space=await this.box.openSpace("metamask",{onSyncDone:async()=>{const r={threeBoxSynced:!0,threeBoxAddress:this.address};t&&(i.default.info("3Box sync completed after timeout; no longer disabled"),r.threeBoxDisabled=!1),clearTimeout(e),this.store.updateState(r),i.default.debug("3Box space sync done"),this._trackMetaMetricsEvent({event:"3Box Synced",category:"3Box"})}})}catch(t){throw this._trackMetaMetricsEvent({event:"3Box Initiation Error",category:"3Box"}),console.error(t),t}}}async getLastUpdated(){const t=await this.space.private.get("metamaskBackup");return JSON.parse(t||"{}").lastUpdated}async migrateBackedUpState(t){const e=new a.default({migrations:u.default}),{preferences:r,addressBook:n}=JSON.parse(t),i={PreferencesController:r,AddressBookController:n},o=e.generateInitialState(i),s=await e.migrateData(o);return{preferences:s.data.PreferencesController,addressBook:s.data.AddressBookController}}async restoreFromThreeBox(){const t=await this.space.private.get("metamaskBackup"),{preferences:e,addressBook:r}=await this.migrateBackedUpState(t);this.store.updateState({threeBoxLastUpdated:t.lastUpdated}),e&&this.preferencesController.store.updateState(e),r&&this.addressBookController.update(r,!0),this.setShowRestorePromptToFalse(),this._trackMetaMetricsEvent({event:"3Box Restored Data",category:"3Box"})}turnThreeBoxSyncingOn(){this._trackMetaMetricsEvent({event:"3Box Sync Turned On",category:"3Box"}),this._registerUpdates()}turnThreeBoxSyncingOff(){this._trackMetaMetricsEvent({event:"3Box Sync Turned Off",category:"3Box"}),this.box.logout()}setShowRestorePromptToFalse(){this.store.updateState({showRestorePrompt:!1})}setThreeBoxSyncingPermission(t){this.store.getState().threeBoxDisabled||(this.store.updateState({threeBoxSyncingAllowed:t}),t&&this.box&&this.turnThreeBoxSyncingOn(),!t&&this.box&&this.turnThreeBoxSyncingOff())}getThreeBoxSyncingState(){return this.store.getState().threeBoxSyncingAllowed}_registerUpdates(){if(!this.registeringUpdates){const t=this._update3Box.bind(this);this.preferencesController.store.subscribe(t);const e=this._update3Box.bind(this);this.addressBookController.subscribe(e),this.registeringUpdates=!0}}}}}},{package:"$root$"}],[36,{"../../../../shared/constants/app":7055,"../../../../shared/constants/gas":7056,"../../../../shared/constants/metametrics":7059,"../../../../shared/constants/network":7060,"../../../../shared/constants/transaction":7067,"../../../../shared/lib/transactions-controller-utils":7074,"../../../../shared/modules/conversion.utils":7078,"../../../../shared/modules/swaps.utils":7089,"../../../../shared/modules/transaction.utils":7090,"../../lib/cleanErrorStack":49,"../../lib/util":90,"../../metamask-controller":91,"./lib/util":38,"./pending-tx-tracker":39,"./tx-gas-utils":40,"./tx-state-manager":41,"@ethereumjs/common":621,"@ethereumjs/tx":626,"@metamask/obs-store":1471,"bignumber.js":2326,"eth-rpc-errors":2821,"ethereumjs-util":2896,"ethjs-query":3333,lodash:6046,loglevel:6059,"nonce-tracker":6175,"safe-event-emitter":6616},function(){with(this)return function(){"use strict";return function(t,e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=B(t("safe-event-emitter")),i=t("@metamask/obs-store"),o=t("ethereumjs-util"),s=B(t("ethjs-query")),a=t("eth-rpc-errors"),u=B(t("@ethereumjs/common")),c=t("@ethereumjs/tx"),h=B(t("nonce-tracker")),f=B(t("loglevel")),l=B(t("bignumber.js")),d=t("lodash"),p=B(t("../../lib/cleanErrorStack")),m=t("../../lib/util"),g=t("../../../../shared/constants/transaction"),y=t("../../metamask-controller"),v=t("../../../../shared/constants/gas"),w=t("../../../../shared/modules/conversion.utils"),b=t("../../../../shared/modules/swaps.utils"),_=t("../../../../shared/constants/metametrics"),E=t("../../../../shared/constants/network"),x=t("../../../../shared/modules/transaction.utils"),T=t("../../../../shared/constants/app"),k=t("../../../../shared/lib/transactions-controller-utils"),S=B(t("./tx-state-manager")),A=B(t("./tx-gas-utils")),M=B(t("./pending-tx-tracker")),P=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var r=I(e);if(r&&r.has(t))return r.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var s=i?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}n.default=t,r&&r.set(t,n);return n}(t("./lib/util"));function I(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(I=function(t){return t?r:e})(t)}function B(t){return t&&t.__esModule?t:{default:t}}const C=[g.TRANSACTION_TYPES.SWAP,g.TRANSACTION_TYPES.SWAP_APPROVAL],O=[...C,g.TRANSACTION_TYPES.SIMPLE_SEND,g.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER,g.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER_FROM,g.TRANSACTION_TYPES.CONTRACT_INTERACTION],R="failed on-chain";class N extends n.default{constructor(t){super(),this.networkStore=t.networkStore||new i.ObservableStore({}),this._getCurrentChainId=t.getCurrentChainId,this.getProviderConfig=t.getProviderConfig,this._getCurrentNetworkEIP1559Compatibility=t.getCurrentNetworkEIP1559Compatibility,this._getCurrentAccountEIP1559Compatibility=t.getCurrentAccountEIP1559Compatibility,this.preferencesStore=t.preferencesStore||new i.ObservableStore({}),this.provider=t.provider,this.getPermittedAccounts=t.getPermittedAccounts,this.blockTracker=t.blockTracker,this.signEthTx=t.signTransaction,this.inProcessOfSigning=new Set,this._trackMetaMetricsEvent=t.trackMetaMetricsEvent,this._getParticipateInMetrics=t.getParticipateInMetrics,this._getEIP1559GasFeeEstimates=t.getEIP1559GasFeeEstimates,this.createEventFragment=t.createEventFragment,this.updateEventFragment=t.updateEventFragment,this.finalizeEventFragment=t.finalizeEventFragment,this.getEventFragmentById=t.getEventFragmentById,this.getDeviceModel=t.getDeviceModel,this.getAccountType=t.getAccountType,this.getTokenStandardAndDetails=t.getTokenStandardAndDetails,this.memStore=new i.ObservableStore({}),this.query=new s.default(this.provider),this.txGasUtil=new A.default(this.provider),this._mapMethods(),this.txStateManager=new S.default({initState:t.initState,txHistoryLimit:t.txHistoryLimit,getNetwork:this.getNetwork.bind(this),getCurrentChainId:t.getCurrentChainId}),this._onBootCleanUp(),this.store=this.txStateManager.store,this.nonceTracker=new h.default({provider:this.provider,blockTracker:this.blockTracker,getPendingTransactions:(...e)=>[...this.txStateManager.getPendingTransactions(...e),...t.getExternalPendingTransactions(...e)],getConfirmedTransactions:this.txStateManager.getConfirmedTransactions.bind(this.txStateManager)}),this.pendingTxTracker=new M.default({provider:this.provider,nonceTracker:this.nonceTracker,publishTransaction:t=>this.query.sendRawTransaction(t),getPendingTransactions:()=>[...this.txStateManager.getPendingTransactions(),...this.txStateManager.getApprovedTransactions()],approveTransaction:this.approveTransaction.bind(this),getCompletedTransactions:this.txStateManager.getConfirmedTransactions.bind(this.txStateManager)}),this.txStateManager.store.subscribe((()=>this.emit(y.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE))),this._setupListeners(),this._updateMemstore(),this.txStateManager.store.subscribe((()=>this._updateMemstore())),this.networkStore.subscribe((()=>{this._onBootCleanUp(),this._updateMemstore()})),this._updatePendingTxsAfterFirstBlock()}getChainId(){const t=this.networkStore.getState(),e=this._getCurrentChainId(),r=parseInt(e,16);return"loading"===t||Number.isNaN(r)?0:r}async getEIP1559Compatibility(t){const e=await this._getCurrentNetworkEIP1559Compatibility(),r=await this._getCurrentAccountEIP1559Compatibility(t);return e&&r}async getCommonConfiguration(t){const{type:e,nickname:r}=this.getProviderConfig(),n=await this.getEIP1559Compatibility(t)?E.HARDFORKS.LONDON:E.HARDFORKS.BERLIN;if(e!==E.NETWORK_TYPES.RPC&&e!==E.NETWORK_TYPES.SEPOLIA)return new u.default({chain:e,hardfork:n});const i=parseInt(this._getCurrentChainId(),16),o=this.networkStore.getState(),s={name:r,chainId:i,networkId:"loading"===o?0:parseInt(o,10)};return u.default.forCustomChain(E.NETWORK_TYPES.MAINNET,s,n)}addTransaction(t){this.txStateManager.addTransaction(t),this.emit(`${t.id}:unapproved`,t),this._trackTransactionMetricsEvent(t,g.TRANSACTION_EVENTS.ADDED,t.actionId)}wipeTransactions(t){this.txStateManager.wipeTransactions(t)}async newUnapprovedTransaction(t,e={}){f.default.debug(`MetaMaskController newUnapprovedTransaction ${JSON.stringify(t)}`);const r=await this.addUnapprovedTransaction(t,e.origin);return new Promise(((t,e)=>{this.txStateManager.once(`${r.id}:finished`,(r=>{switch(r.status){case g.TRANSACTION_STATUSES.SUBMITTED:return t(r.hash);case g.TRANSACTION_STATUSES.REJECTED:return e((0,p.default)(a.ethErrors.provider.userRejectedRequest("MetaMask Tx Signature: User denied transaction signature.")));case g.TRANSACTION_STATUSES.FAILED:return e((0,p.default)(a.ethErrors.rpc.internal(r.err.message)));default:return e((0,p.default)(a.ethErrors.rpc.internal(`MetaMask Tx Signature: Unknown problem: ${JSON.stringify(r.txParams)}`)))}}))}))}_getTransaction(t){const{transactions:e}=this.store.getState();return e[t]}_isUnapprovedTransaction(t){return this.txStateManager.getTransaction(t).status===g.TRANSACTION_STATUSES.UNAPPROVED}_throwErrorIfNotUnapprovedTx(t,e){if(!this._isUnapprovedTransaction(t))throw new Error(`TransactionsController: Can only call ${e} on an unapproved transaction.\n         Current tx status: ${this.txStateManager.getTransaction(t).status}`)}_updateTransaction(t,e,r){const n=this.txStateManager.getTransaction(t),i=(0,d.merge)(n,e);this.txStateManager.updateTransaction(i,r)}updatePreviousGasParams(t,{maxFeePerGas:e,maxPriorityFeePerGas:r,gasLimit:n}){const i={previousGas:{maxFeePerGas:e,maxPriorityFeePerGas:r,gasLimit:n}};i.previousGas=(0,d.pickBy)(i.previousGas);const o=`Update Previous Gas for ${t}`;return this._updateTransaction(t,i,o),this._getTransaction(t)}async updateEditableParams(t,{data:e,from:r,to:n,value:i,gas:o,gasPrice:s}){this._throwErrorIfNotUnapprovedTx(t,"updateEditableParams");const a={txParams:{data:e,from:r,to:n,value:i,gas:o,gasPrice:s}};a.txParams=(0,d.pickBy)(a.txParams,(t=>t!==undefined));const u=this._getTransaction(t),{type:c}=await(0,x.determineTransactionType)({...u.txParams,...a.txParams},this.query);a.type=c;const h=`Update Editable Params for ${t}`;return this._updateTransaction(t,a,h),this._getTransaction(t)}updateTransactionGasFees(t,{gas:e,gasLimit:r,gasPrice:n,maxPriorityFeePerGas:i,maxFeePerGas:o,estimateUsed:s,estimateSuggested:a,defaultGasEstimates:u,originalGasEstimate:c,userEditedGasLimit:h,userFeeLevel:f}){this._throwErrorIfNotUnapprovedTx(t,"updateTransactionGasFees");let l={txParams:{gas:e,gasLimit:r,gasPrice:n,maxPriorityFeePerGas:i,maxFeePerGas:o},estimateUsed:s,estimateSuggested:a,defaultGasEstimates:u,originalGasEstimate:c,userEditedGasLimit:h,userFeeLevel:f};l.txParams=(0,d.pickBy)(l.txParams),l=(0,d.pickBy)(l);const p=`Update Transaction Gas Fees for ${t}`;return this._updateTransaction(t,l,p),this._getTransaction(t)}updateTransactionEstimatedBaseFee(t,{estimatedBaseFee:e,decEstimatedBaseFee:r}){this._throwErrorIfNotUnapprovedTx(t,"updateTransactionEstimatedBaseFee");let n={estimatedBaseFee:e,decEstimatedBaseFee:r};n=(0,d.pickBy)(n);const i=`Update Transaction Estimated Base Fees for ${t}`;return this._updateTransaction(t,n,i),this._getTransaction(t)}updateSwapApprovalTransaction(t,{type:e,sourceTokenSymbol:r}){this._throwErrorIfNotUnapprovedTx(t,"updateSwapApprovalTransaction");let n={type:e,sourceTokenSymbol:r};n=(0,d.pickBy)(n);const i=`Update Swap Approval Transaction for ${t}`;return this._updateTransaction(t,n,i),this._getTransaction(t)}updateSwapTransaction(t,{sourceTokenSymbol:e,destinationTokenSymbol:r,type:n,destinationTokenDecimals:i,destinationTokenAddress:o,swapMetaData:s,swapTokenValue:a,estimatedBaseFee:u,approvalTxId:c}){this._throwErrorIfNotUnapprovedTx(t,"updateSwapTransaction");let h={sourceTokenSymbol:e,destinationTokenSymbol:r,type:n,destinationTokenDecimals:i,destinationTokenAddress:o,swapMetaData:s,swapTokenValue:a,estimatedBaseFee:u,approvalTxId:c};h=(0,d.pickBy)(h);const f=`Update Swap Transaction for ${t}`;return this._updateTransaction(t,h,f),this._getTransaction(t)}updateTransactionUserSettings(t,{userEditedGasLimit:e,userFeeLevel:r}){this._throwErrorIfNotUnapprovedTx(t,"updateTransactionUserSettings");let n={userEditedGasLimit:e,userFeeLevel:r};n=(0,d.pickBy)(n);const i=`Update User Settings for ${t}`;return this._updateTransaction(t,n,i),this._getTransaction(t)}updateTransactionSendFlowHistory(t,e,r){var n;this._throwErrorIfNotUnapprovedTx(t,"updateTransactionSendFlowHistory");const i=this._getTransaction(t);if(e===((null==i||null===(n=i.sendFlowHistory)||void 0===n?void 0:n.length)||0)){var o;const e=`Update sendFlowHistory for ${t}`;this.txStateManager.updateTransaction({...i,sendFlowHistory:[...null!==(o=null==i?void 0:i.sendFlowHistory)&&void 0!==o?o:[],...r]},e)}return this._getTransaction(t)}async addTransactionGasDefaults(t){const e=await(0,x.determineTransactionContractCode)(t.txParams,this.query);let r=t;try{r=await this.addTxGasDefaults(t,e)}catch(e){throw f.default.warn(e),r=this.txStateManager.getTransaction(t.id),r.loadingDefaults=!1,this.txStateManager.updateTransaction(t,"Failed to calculate gas defaults."),e}return r.loadingDefaults=!1,this.txStateManager.updateTransaction(r,"Added new unapproved transaction."),r}async addUnapprovedTransaction(t,e,r,n=[],i){if(r!==undefined&&!O.includes(r))throw new Error(`TransactionController - invalid transactionType value: ${r}`);if(i){let t=this.txStateManager.getTransactionWithActionId(i);if(t)return this.emit("newUnapprovedTx",t),t=await this.addTransactionGasDefaults(t),t}const o=P.normalizeTxParams(t),s=await this.getEIP1559Compatibility();P.validateTxParams(o,s);let u=this.txStateManager.generateTxMeta({txParams:o,origin:e,sendFlowHistory:n});if(i&&(u.actionId=i),e===T.ORIGIN_METAMASK){if(o.from!==this.getSelectedAddress())throw a.ethErrors.rpc.internal({message:"Internally initiated transaction is using invalid account.",data:{origin:e,fromAddress:o.from,selectedAddress:this.getSelectedAddress()}})}else{if(!(await this.getPermittedAccounts(e)).includes(o.from))throw a.ethErrors.provider.unauthorized({data:{origin:e}})}const{type:c}=await(0,x.determineTransactionType)(t,this.query);return u.type=r||c,u.txParams.value=u.txParams.value?(0,m.addHexPrefix)(u.txParams.value):"0x0",this.addTransaction(u),this.emit("newUnapprovedTx",u),u=await this.addTransactionGasDefaults(u),u}async addTxGasDefaults(t,e){const r=t.txParams.type!==g.TRANSACTION_ENVELOPE_TYPES.LEGACY&&await this.getEIP1559Compatibility(),{gasPrice:n,maxFeePerGas:i,maxPriorityFeePerGas:o}=await this._getDefaultGasFees(t,r),{gasLimit:s,simulationFails:a}=await this._getDefaultGasLimit(t,e);if(t=this.txStateManager.getTransaction(t.id),a&&(t.simulationFails=a),r){const{eip1559V2Enabled:e}=this.preferencesStore.getState(),r=this.getAdvancedGasFee();e&&Boolean(r)&&!C.includes(t.type)?(t.userFeeLevel=v.CUSTOM_GAS_ESTIMATE,t.txParams.maxFeePerGas=(0,w.decGWEIToHexWEI)(r.maxBaseFee),t.txParams.maxPriorityFeePerGas=(0,w.decGWEIToHexWEI)(r.priorityFee)):!t.txParams.gasPrice||t.txParams.maxFeePerGas||t.txParams.maxPriorityFeePerGas?(i&&o&&!t.txParams.maxFeePerGas&&!t.txParams.maxPriorityFeePerGas||t.origin===T.ORIGIN_METAMASK?t.userFeeLevel=v.GAS_RECOMMENDATIONS.MEDIUM:t.userFeeLevel=e?v.PRIORITY_LEVELS.DAPP_SUGGESTED:v.CUSTOM_GAS_ESTIMATE,i&&!t.txParams.maxFeePerGas&&(t.txParams.maxFeePerGas=i),o&&!t.txParams.maxPriorityFeePerGas&&(t.txParams.maxPriorityFeePerGas=o),n&&!t.txParams.maxFeePerGas&&(t.txParams.maxFeePerGas=n),t.txParams.maxFeePerGas&&!t.txParams.maxPriorityFeePerGas&&(t.txParams.maxPriorityFeePerGas=t.txParams.maxFeePerGas)):(t.txParams.maxFeePerGas=t.txParams.gasPrice,t.txParams.maxPriorityFeePerGas=t.txParams.gasPrice,e&&t.origin!==T.ORIGIN_METAMASK?t.userFeeLevel=v.PRIORITY_LEVELS.DAPP_SUGGESTED:t.userFeeLevel=v.CUSTOM_GAS_ESTIMATE),delete t.txParams.gasPrice}else delete t.txParams.maxPriorityFeePerGas,delete t.txParams.maxFeePerGas;return!n||t.txParams.gasPrice||t.txParams.maxPriorityFeePerGas||t.txParams.maxFeePerGas||(t.txParams.gasPrice=n),s&&!t.txParams.gas&&(t.txParams.gas=s,t.originalGasEstimate=s),t.defaultGasEstimates={estimateType:t.userFeeLevel,gas:t.txParams.gas,gasPrice:t.txParams.gasPrice,maxFeePerGas:t.txParams.maxFeePerGas,maxPriorityFeePerGas:t.txParams.maxPriorityFeePerGas},t}async _getDefaultGasFees(t,e){if(!e&&t.txParams.gasPrice||e&&t.txParams.maxFeePerGas&&t.txParams.maxPriorityFeePerGas)return{};try{const{gasFeeEstimates:t,gasEstimateType:r}=await this._getEIP1559GasFeeEstimates();if(e&&r===v.GAS_ESTIMATE_TYPES.FEE_MARKET){const{medium:{suggestedMaxPriorityFeePerGas:e,suggestedMaxFeePerGas:r}={}}=t;if(e&&r)return{maxFeePerGas:(0,w.decGWEIToHexWEI)(r),maxPriorityFeePerGas:(0,w.decGWEIToHexWEI)(e)}}else{if(r===v.GAS_ESTIMATE_TYPES.LEGACY)return{gasPrice:(0,w.decGWEIToHexWEI)(t.medium)};if(r===v.GAS_ESTIMATE_TYPES.ETH_GASPRICE)return{gasPrice:(0,w.decGWEIToHexWEI)(t.gasPrice)}}}catch(t){console.error(t)}const r=await this.query.gasPrice();return{gasPrice:r&&(0,m.addHexPrefix)(r.toString(16))}}async _getDefaultGasLimit(t){const e=this._getCurrentChainId(),r=E.CHAIN_ID_TO_GAS_LIMIT_BUFFER_MAP[e],n=(0,m.getChainType)(e);if(t.txParams.gas)return{};if(t.txParams.to&&t.type===g.TRANSACTION_TYPES.SIMPLE_SEND&&"custom"!==n&&!t.txParams.data)return{gasLimit:v.GAS_LIMITS.SIMPLE};const{blockGasLimit:i,estimatedGasHex:o,simulationFails:s}=await this.txGasUtil.analyzeGasUsage(t);return{gasLimit:this.txGasUtil.addGasBuffer((0,m.addHexPrefix)(o),i,r),simulationFails:s}}generateNewGasParams(t,e={},r=11){const{txParams:n}=t,i={},o={};var s;e.gasLimit&&(o.gas=null!==(s=null==e?void 0:e.gas)&&void 0!==s?s:v.GAS_LIMITS.SIMPLE);return e.estimateSuggested&&(o.estimateSuggested=e.estimateSuggested),e.estimateUsed&&(o.estimateUsed=e.estimateUsed),(0,x.isEIP1559Transaction)(t)?(i.maxFeePerGas=n.maxFeePerGas,i.maxPriorityFeePerGas=n.maxPriorityFeePerGas,o.maxFeePerGas=(null==e?void 0:e.maxFeePerGas)||(0,m.bnToHex)((0,m.BnMultiplyByFraction)((0,m.hexToBn)(n.maxFeePerGas),r,10)),o.maxPriorityFeePerGas=(null==e?void 0:e.maxPriorityFeePerGas)||(0,m.bnToHex)((0,m.BnMultiplyByFraction)((0,m.hexToBn)(n.maxPriorityFeePerGas),r,10))):(i.gasPrice=n.gasPrice,o.gasPrice=(null==e?void 0:e.gasPrice)||(0,m.bnToHex)((0,m.BnMultiplyByFraction)((0,m.hexToBn)(n.gasPrice),r,10))),{previousGasParams:i,newGasParams:o}}async createCancelTransaction(t,e,{estimatedBaseFee:r,actionId:n}={}){if(n){const t=this.txStateManager.getTransactionWithActionId(n);if(t)return t}const i=this.txStateManager.getTransaction(t),{txParams:o}=i,{from:s,nonce:a}=o,{previousGasParams:u,newGasParams:c}=this.generateNewGasParams(i,{...e,gasLimit:e.gasLimit||v.GAS_LIMITS.SIMPLE}),h=this.txStateManager.generateTxMeta({txParams:{from:s,to:s,nonce:a,value:"0x0",...c},previousGasParams:u,loadingDefaults:!1,status:g.TRANSACTION_STATUSES.APPROVED,type:g.TRANSACTION_TYPES.CANCEL,actionId:n});return r&&(h.estimatedBaseFee=r),this.addTransaction(h),await this.approveTransaction(h.id,n),h}async createSpeedUpTransaction(t,e,{estimatedBaseFee:r,actionId:n}={}){if(n){const t=this.txStateManager.getTransactionWithActionId(n);if(t)return t}const i=this.txStateManager.getTransaction(t),{txParams:o}=i,{previousGasParams:s,newGasParams:a}=this.generateNewGasParams(i,e),u=this.txStateManager.generateTxMeta({txParams:{...o,...a},previousGasParams:s,loadingDefaults:!1,status:g.TRANSACTION_STATUSES.APPROVED,type:g.TRANSACTION_TYPES.RETRY,originalType:i.type,actionId:n});return r&&(u.estimatedBaseFee=r),this.addTransaction(u),await this.approveTransaction(u.id,n),u}async updateTransaction(t){this.txStateManager.updateTransaction(t,"confTx: user updated transaction")}async updateAndApproveTransaction(t,e){this.txStateManager.updateTransaction(t,"confTx: user approved transaction"),await this.approveTransaction(t.id,e)}async approveTransaction(t,e){const r=this.txStateManager.getTransaction(t);if(this.inProcessOfSigning.has(t))return;let n;this.inProcessOfSigning.add(t);try{this.txStateManager.setTxStatusApproved(t);const i=r.txParams.from;let{customNonceValue:o}=r;o=Number(o),n=await this.nonceTracker.getNonceLock(i);const s=r.previousGasParams?r.txParams.nonce:n.nextNonce,a=0===o?o:o||s;r.txParams.nonce=(0,m.addHexPrefix)(a.toString(16)),r.nonceDetails=n.nonceDetails,o&&(r.nonceDetails.customNonceValue=o),this.txStateManager.updateTransaction(r,"transactions#approveTransaction");const u=await this.signTransaction(t);await this.publishTransaction(t,u,e),this._trackTransactionMetricsEvent(r,g.TRANSACTION_EVENTS.APPROVED,e),n.releaseLock()}catch(r){try{this._failTransaction(t,r,e)}catch(t){f.default.error(t)}throw n&&n.releaseLock(),r}finally{this.inProcessOfSigning.delete(t)}}async approveTransactionsWithSameNonce(t=[]){if(0===t.length)return"";const e=t[0],r=await this.getCommonConfiguration(e.from),n=c.TransactionFactory.fromTxData(e,{common:r}),i=(0,o.bufferToHex)(n.serialize());if(this.inProcessOfSigning.has(i))return"";let s,a;this.inProcessOfSigning.add(i);try{const r=e.from;a=await this.nonceTracker.getNonceLock(r);const n=a.nextNonce;s=await Promise.all(t.map((t=>(t.nonce=(0,m.addHexPrefix)(n.toString(16)),this.signExternalTransaction(t)))))}catch(t){throw f.default.error(t),t}finally{a&&a.releaseLock(),this.inProcessOfSigning.delete(i)}return s}async signExternalTransaction(t){const e=P.normalizeTxParams(t),r=this.getChainId(),n=(0,x.isEIP1559Transaction)({txParams:e})?g.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET:g.TRANSACTION_ENVELOPE_TYPES.LEGACY,i={...e,type:n,gasLimit:e.gas,chainId:(0,m.addHexPrefix)((0,k.decimalToHex)(r))},s=i.from,a=await this.getCommonConfiguration(s),u=c.TransactionFactory.fromTxData(i,{common:a}),h=await this.signEthTx(u,s);return(0,o.bufferToHex)(h.serialize())}async signTransaction(t){const e=this.txStateManager.getTransaction(t),r=this.getChainId(),n=(0,x.isEIP1559Transaction)(e)?g.TRANSACTION_ENVELOPE_TYPES.FEE_MARKET:g.TRANSACTION_ENVELOPE_TYPES.LEGACY,i={...e.txParams,type:n,chainId:r,gasLimit:e.txParams.gas},s=i.from,a=await this.getCommonConfiguration(i.from),u=c.TransactionFactory.fromTxData(i,{common:a}),h=await this.signEthTx(u,s);e.r=(0,o.bufferToHex)(h.r),e.s=(0,o.bufferToHex)(h.s),e.v=(0,o.bufferToHex)(h.v),this.txStateManager.updateTransaction(e,"transactions#signTransaction: add r, s, v values"),this.txStateManager.setTxStatusSigned(e.id);return(0,o.bufferToHex)(h.serialize())}async publishTransaction(t,e,r){const n=this.txStateManager.getTransaction(t);if(n.rawTx=e,n.type===g.TRANSACTION_TYPES.SWAP){const t=await this.query.getBalance(n.txParams.from);n.preTxBalance=t.toString(16)}let i;this.txStateManager.updateTransaction(n,"transactions#publishTransaction");try{i=await this.query.sendRawTransaction(e)}catch(t){if(!t.message.toLowerCase().includes("known transaction"))throw t;i=(0,o.keccak)((0,o.toBuffer)((0,m.addHexPrefix)(e),"hex")).toString("hex"),i=(0,m.addHexPrefix)(i)}this.setTxHash(t,i),this.txStateManager.setTxStatusSubmitted(t),this._trackTransactionMetricsEvent(n,g.TRANSACTION_EVENTS.SUBMITTED,r)}async updatePostTxBalance({txMeta:t,txId:e,numberOfAttempts:r=6}){const n=await this.query.getBalance(t.txParams.from),i=this.txStateManager.getTransaction(e),o=i.approvalTxId?this.txStateManager.getTransaction(i.approvalTxId):null;i.postTxBalance=n.toString(16);(0,b.isSwapsDefaultTokenAddress)(t.destinationTokenAddress,t.chainId)&&t.preTxBalance===i.postTxBalance&&r>0?setTimeout((()=>{this.updatePostTxBalance({txMeta:t,txId:e,numberOfAttempts:r-1})}),5e3):(this.txStateManager.updateTransaction(i,"transactions#confirmTransaction - add postTxBalance"),this._trackSwapsMetrics(i,o))}async confirmTransaction(t,e,r,n){const i=this.txStateManager.getTransaction(t);if(i)try{const o=P.normalizeTxReceiptGasUsed(e.gasUsed);i.txReceipt={...e,gasUsed:o},r&&(i.baseFeePerGas=r),n&&(i.blockTimestamp=n),this.txStateManager.setTxStatusConfirmed(t),this._markNonceDuplicatesDropped(t);const{submittedTime:s}=i,a={gas_used:o};s&&(a.completion_time=this._getTransactionCompletionTime(s)),"0x0"===e.status&&(a.status=R),this._trackTransactionMetricsEvent(i,g.TRANSACTION_EVENTS.FINALIZED,undefined,a),this.txStateManager.updateTransaction(i,"transactions#confirmTransaction - add txReceipt"),i.type===g.TRANSACTION_TYPES.SWAP&&await this.updatePostTxBalance({txMeta:i,txId:t})}catch(t){f.default.error(t)}}async confirmExternalTransaction(t,e,r){if(await this.txStateManager.addExternalTransaction(t),!t)return;const n=t.id;try{const i=P.normalizeTxReceiptGasUsed(e.gasUsed);t.txReceipt={...e,gasUsed:i},r&&(t.baseFeePerGas=r),this.txStateManager.setTxStatusConfirmed(n),this._markNonceDuplicatesDropped(n);const{submittedTime:o}=t,s={gas_used:i};o&&(s.completion_time=this._getTransactionCompletionTime(o)),"0x0"===e.status&&(s.status=R),this._trackTransactionMetricsEvent(t,g.TRANSACTION_EVENTS.FINALIZED,undefined,s),this.txStateManager.updateTransaction(t,"transactions#confirmTransaction - add txReceipt"),t.type===g.TRANSACTION_TYPES.SWAP&&await this.updatePostTxBalance({txMeta:t,txId:n})}catch(t){f.default.error(t)}}async cancelTransaction(t,e){const r=this.txStateManager.getTransaction(t);this.txStateManager.setTxStatusRejected(t),this._trackTransactionMetricsEvent(r,g.TRANSACTION_EVENTS.REJECTED,e)}setTxHash(t,e){const r=this.txStateManager.getTransaction(t);r.hash=e,this.txStateManager.updateTransaction(r,"transactions#setTxHash")}async createTransactionEventFragment(t,e,r){const n=this.txStateManager.getTransaction(t),{properties:i,sensitiveProperties:o}=await this._buildEventFragmentProperties(n);this._createTransactionEventFragment(n,e,i,o,r)}_mapMethods(){this.getState=()=>this.memStore.getState(),this.getNetwork=()=>this.networkStore.getState(),this.getSelectedAddress=()=>this.preferencesStore.getState().selectedAddress,this.getUnapprovedTxCount=()=>Object.keys(this.txStateManager.getUnapprovedTxList()).length,this.getPendingTxCount=t=>this.txStateManager.getPendingTransactions(t).length,this.getTransactions=t=>this.txStateManager.getTransactions(t),this.getAdvancedGasFee=()=>this.preferencesStore.getState().advancedGasFee}async _updatePendingTxsAfterFirstBlock(){await this.blockTracker.getLatestBlock(),await this.pendingTxTracker.updatePendingTxs()}_onBootCleanUp(){this.txStateManager.getTransactions({searchCriteria:{status:g.TRANSACTION_STATUSES.UNAPPROVED,loadingDefaults:!0}}).forEach((t=>{this.addTxGasDefaults(t).then((t=>{t.loadingDefaults=!1,this.txStateManager.updateTransaction(t,"transactions: gas estimation for tx on boot")})).catch((e=>{const r=this.txStateManager.getTransaction(t.id);r.loadingDefaults=!1,this.txStateManager.updateTransaction(r,"failed to estimate gas during boot cleanup."),this._failTransaction(r.id,e)}))})),this.txStateManager.getTransactions({searchCriteria:{status:g.TRANSACTION_STATUSES.APPROVED}}).forEach((t=>{this.approveTransaction(t)}))}_setupListeners(){this.txStateManager.on("tx:status-update",this.emit.bind(this,"tx:status-update")),this._setupBlockTrackerListener(),this.pendingTxTracker.on("tx:warning",(t=>{this.txStateManager.updateTransaction(t,"transactions/pending-tx-tracker#event: tx:warning")})),this.pendingTxTracker.on("tx:failed",((t,e)=>{this._failTransaction(t,e)})),this.pendingTxTracker.on("tx:confirmed",((t,e,r,n)=>this.confirmTransaction(t,e,r,n))),this.pendingTxTracker.on("tx:dropped",(t=>{this._dropTransaction(t)})),this.pendingTxTracker.on("tx:block-update",((t,e)=>{t.firstRetryBlockNumber||(t.firstRetryBlockNumber=e,this.txStateManager.updateTransaction(t,"transactions/pending-tx-tracker#event: tx:block-update"))})),this.pendingTxTracker.on("tx:retry",(t=>{"retryCount"in t||(t.retryCount=0),t.retryCount+=1,this.txStateManager.updateTransaction(t,"transactions/pending-tx-tracker#event: tx:retry")}))}_markNonceDuplicatesDropped(t){const e=this.txStateManager.getTransaction(t),{nonce:r,from:n}=e.txParams,i=this.txStateManager.getTransactions({searchCriteria:{nonce:r,from:n}});i.length&&i.forEach((r=>{r.id!==t&&(r.replacedBy=e.hash,r.replacedById=e.id,this.txStateManager.updateTransaction(e,"transactions/pending-tx-tracker#event: tx:confirmed reference to confirmed txHash with same nonce"),r.status!==g.TRANSACTION_STATUSES.FAILED&&this._dropTransaction(r.id))}))}_setupBlockTrackerListener(){let t=!1;const e=this._onLatestBlock.bind(this),{blockTracker:r,txStateManager:n}=this;function i(){const i=n.getPendingTransactions();!t&&i.length>0?(r.on("latest",e),t=!0):t&&!i.length&&(r.removeListener("latest",e),t=!1)}n.on("tx:status-update",i),i()}async _onLatestBlock(t){try{await this.pendingTxTracker.updatePendingTxs()}catch(t){f.default.error(t)}try{await this.pendingTxTracker.resubmitPendingTxs(t)}catch(t){f.default.error(t)}}_updateMemstore(){const t=this.txStateManager.getUnapprovedTxList(),e=this.txStateManager.getTransactions({limit:100});this.memStore.updateState({unapprovedTxs:t,currentNetworkTxList:e})}_calculateTransactionsCost(t,e){let r="0x0";null!=e&&e.txReceipt&&(r=(0,k.calcGasTotal)(e.txReceipt.gasUsed,e.txReceipt.effectiveGasPrice));const n=(0,k.calcGasTotal)(t.txReceipt.gasUsed,t.txReceipt.effectiveGasPrice),i=new l.default(n,16).plus(r,16).toString(16);return{approvalGasCostInEth:Number((0,k.hexWEIToDecETH)(r)),tradeGasCostInEth:Number((0,k.hexWEIToDecETH)(n)),tradeAndApprovalGasCostInEth:Number((0,k.hexWEIToDecETH)(i))}}_trackSwapsMetrics(t,e){if(this._getParticipateInMetrics()&&t.swapMetaData)if("0x0"===t.txReceipt.status)this._trackMetaMetricsEvent({event:"Swap Failed",sensitiveProperties:{...t.swapMetaData},category:_.EVENT.CATEGORIES.SWAPS});else{const r=(0,k.getSwapsTokensReceivedFromTxMeta)(t.destinationTokenSymbol,t,t.destinationTokenAddress,t.txParams.from,t.destinationTokenDecimals,e,t.chainId),n=r?`${new l.default(r,10).div(t.swapMetaData.token_to_amount,10).times(100).round(2)}%`:null,i=t.txReceipt.gasUsed&&t.swapMetaData.estimated_gas?`${new l.default(t.txReceipt.gasUsed,16).div(t.swapMetaData.estimated_gas,10).times(100).round(2)}%`:null,o=this._calculateTransactionsCost(t,e);this._trackMetaMetricsEvent({event:"Swap Completed",category:_.EVENT.CATEGORIES.SWAPS,sensitiveProperties:{...t.swapMetaData,token_to_amount_received:r,quote_vs_executionRatio:n,estimated_vs_used_gasRatio:i,approval_gas_cost_in_eth:o.approvalGasCostInEth,trade_gas_cost_in_eth:o.tradeGasCostInEth,trade_and_approval_gas_cost_in_eth:o.tradeAndApprovalGasCostInEth}})}}_allowanceAmountInRelationToDappProposedValue(t,e,r){return t===g.TRANSACTION_APPROVAL_AMOUNT_TYPE.CUSTOM&&e&&r?`${new l.default(e,10).div(r,10).times(100).round(2)}`:null}_allowanceAmountInRelationToTokenBalance(t,e,r){return(t===g.TRANSACTION_APPROVAL_AMOUNT_TYPE.CUSTOM||t===g.TRANSACTION_APPROVAL_AMOUNT_TYPE.DAPP_PROPOSED)&&e&&r?`${new l.default(e,16).div(r,10).times(100).round(2)}`:null}async _buildEventFragmentProperties(t,e){const{type:r,time:n,status:i,chainId:o,origin:s,txParams:{gasPrice:a,gas:u,maxFeePerGas:c,maxPriorityFeePerGas:h,estimateSuggested:f,estimateUsed:l},defaultGasEstimates:d,originalType:p,replacedById:m,metamaskNetworkId:y,customTokenAmount:w,dappProposedTokenAmount:b,currentTokenBalance:_,originalApprovalAmount:E,finalApprovalAmount:S,contractMethodName:A}=t,M=s===T.ORIGIN_METAMASK?"user":"dapp",{assetType:P,tokenStandard:I}=await(0,x.determineTransactionAssetType)(t,this.query,this.getTokenStandardAndDetails),B={};if((0,x.isEIP1559Transaction)(t)?(B.max_fee_per_gas=c,B.max_priority_fee_per_gas=h):B.gas_price=a,d){const{estimateType:e}=d;if(e){B.default_estimate=e;let r=t.defaultGasEstimates.maxFeePerGas,n=t.defaultGasEstimates.maxPriorityFeePerGas;if([v.GAS_RECOMMENDATIONS.LOW,v.GAS_RECOMMENDATIONS.MEDIUM,v.GAS_RECOMMENDATIONS.MEDIUM.HIGH].includes(e)){var C,O;const{gasFeeEstimates:t}=await this._getEIP1559GasFeeEstimates();var R,N;if(null!=t&&null!==(C=t[e])&&void 0!==C&&C.suggestedMaxFeePerGas)r=null===(R=t[e])||void 0===R?void 0:R.suggestedMaxFeePerGas,B.default_max_fee_per_gas=r;if(null!=t&&null!==(O=t[e])&&void 0!==O&&O.suggestedMaxPriorityFeePerGas)n=null===(N=t[e])||void 0===N?void 0:N.suggestedMaxPriorityFeePerGas,B.default_max_priority_fee_per_gas=n}}t.defaultGasEstimates.gas&&(B.default_gas=t.defaultGasEstimates.gas),t.defaultGasEstimates.gasPrice&&(B.default_gas_price=t.defaultGasEstimates.gasPrice)}f&&(B.estimate_suggested=f),l&&(B.estimate_used=l),null!=e&&e.gas_used&&(B.gas_used=e.gas_used);const L=this._getGasValuesInGWEI(B);let j="0";if(t.txParams.maxFeePerGas){const{eip1559V2Enabled:t}=this.preferencesStore.getState();j=t?"2":"1"}const F=[g.TRANSACTION_TYPES.CONTRACT_INTERACTION,g.TRANSACTION_TYPES.TOKEN_METHOD_APPROVE,g.TRANSACTION_TYPES.TOKEN_METHOD_SAFE_TRANSFER_FROM,g.TRANSACTION_TYPES.TOKEN_METHOD_SET_APPROVAL_FOR_ALL,g.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER,g.TRANSACTION_TYPES.TOKEN_METHOD_TRANSFER_FROM,g.TRANSACTION_TYPES.SMART,g.TRANSACTION_TYPES.SWAP,g.TRANSACTION_TYPES.SWAP_APPROVAL].includes(r),D="Approve";let U,K,H,G,q=g.TRANSACTION_TYPES.SIMPLE_SEND;r===g.TRANSACTION_TYPES.CANCEL?q=g.TRANSACTION_TYPES.CANCEL:r===g.TRANSACTION_TYPES.RETRY?q=p:r===g.TRANSACTION_TYPES.DEPLOY_CONTRACT?q=g.TRANSACTION_TYPES.DEPLOY_CONTRACT:F&&(q=g.TRANSACTION_TYPES.CONTRACT_INTERACTION,K=A,K===D&&I===g.TOKEN_STANDARDS.ERC20&&("0"===b||"0"===w?U=g.TRANSACTION_APPROVAL_AMOUNT_TYPE.REVOKE:w?U=g.TRANSACTION_APPROVAL_AMOUNT_TYPE.CUSTOM:b&&(U=g.TRANSACTION_APPROVAL_AMOUNT_TYPE.DAPP_PROPOSED),H=this._allowanceAmountInRelationToDappProposedValue(U,E,S),G=this._allowanceAmountInRelationToTokenBalance(U,b,_)));const V=this._getTransaction(m),z={RETRY:g.TRANSACTION_TYPES.RETRY,CANCEL:g.TRANSACTION_TYPES.CANCEL,SAME_NONCE:"other"};let W;null!=e&&e.dropped&&(W=z.SAME_NONCE,(null==V?void 0:V.type)===g.TRANSACTION_TYPES.CANCEL?W=z.CANCEL:(null==V?void 0:V.type)===g.TRANSACTION_TYPES.RETRY&&(W=z.RETRY));let $={chain_id:o,referrer:s,source:M,network:y,eip_1559_version:j,gas_edit_type:"none",gas_edit_attempted:"none",account_type:await this.getAccountType(this.getSelectedAddress()),device_model:await this.getDeviceModel(this.getSelectedAddress()),asset_type:P,token_standard:I,transaction_type:q,transaction_speed_up:r===g.TRANSACTION_TYPES.RETRY};K===D&&($={...$,transaction_approval_amount_type:U});let Y={status:i,transaction_envelope_type:(0,x.isEIP1559Transaction)(t)?k.TRANSACTION_ENVELOPE_TYPE_NAMES.FEE_MARKET:k.TRANSACTION_ENVELOPE_TYPE_NAMES.LEGACY,first_seen:n,gas_limit:u,transaction_contract_method:K,transaction_replaced:W,...e,...L};return K===D&&(Y={...Y,transaction_approval_amount_vs_balance_ratio:G,transaction_approval_amount_vs_proposed_ratio:H}),{properties:$,sensitiveProperties:Y}}_createTransactionEventFragment(t,e,r,n,i){const o=`transaction-${[g.TRANSACTION_EVENTS.FINALIZED,g.TRANSACTION_EVENTS.SUBMITTED].includes(e)?"submitted":"added"}-${t.id}`;if(void 0===this.getEventFragmentById(o))switch(e){case g.TRANSACTION_EVENTS.ADDED:this.createEventFragment({category:_.EVENT.CATEGORIES.TRANSACTIONS,initialEvent:g.TRANSACTION_EVENTS.ADDED,successEvent:g.TRANSACTION_EVENTS.APPROVED,failureEvent:g.TRANSACTION_EVENTS.REJECTED,properties:r,sensitiveProperties:n,persist:!0,uniqueIdentifier:o,actionId:i});break;case g.TRANSACTION_EVENTS.APPROVED:case g.TRANSACTION_EVENTS.REJECTED:this.createEventFragment({category:_.EVENT.CATEGORIES.TRANSACTIONS,successEvent:g.TRANSACTION_EVENTS.APPROVED,failureEvent:g.TRANSACTION_EVENTS.REJECTED,properties:r,sensitiveProperties:n,persist:!0,uniqueIdentifier:o,actionId:i});break;case g.TRANSACTION_EVENTS.SUBMITTED:this.createEventFragment({category:_.EVENT.CATEGORIES.TRANSACTIONS,initialEvent:g.TRANSACTION_EVENTS.SUBMITTED,successEvent:g.TRANSACTION_EVENTS.FINALIZED,properties:r,sensitiveProperties:n,persist:!0,uniqueIdentifier:o,actionId:i});break;case g.TRANSACTION_EVENTS.FINALIZED:this.createEventFragment({category:_.EVENT.CATEGORIES.TRANSACTIONS,successEvent:g.TRANSACTION_EVENTS.FINALIZED,properties:r,sensitiveProperties:n,persist:!0,uniqueIdentifier:o,actionId:i})}}async _trackTransactionMetricsEvent(t,e,r,n={}){if(!t)return;const{properties:i,sensitiveProperties:o}=await this._buildEventFragmentProperties(t,n);let s;switch(this._createTransactionEventFragment(t,e,i,o,r),e){case g.TRANSACTION_EVENTS.APPROVED:s=`transaction-added-${t.id}`,this.updateEventFragment(s,{properties:i,sensitiveProperties:o}),this.finalizeEventFragment(s);break;case g.TRANSACTION_EVENTS.REJECTED:s=`transaction-added-${t.id}`,this.updateEventFragment(s,{properties:i,sensitiveProperties:o}),this.finalizeEventFragment(s,{abandoned:!0});break;case g.TRANSACTION_EVENTS.FINALIZED:s=`transaction-submitted-${t.id}`,this.updateEventFragment(s,{properties:i,sensitiveProperties:o}),this.finalizeEventFragment(`transaction-submitted-${t.id}`)}}_getTransactionCompletionTime(t){return Math.round((Date.now()-t)/1e3).toString()}_getGasValuesInGWEI(t){const e={};for(const r in t)(0,o.isHexString)(t[r])?e[r]=(0,k.hexWEIToDecGWEI)(t[r]):e[r]=t[r];return e}_failTransaction(t,e,r){this.txStateManager.setTxStatusFailed(t,e);const n=this.txStateManager.getTransaction(t);this._trackTransactionMetricsEvent(n,g.TRANSACTION_EVENTS.FINALIZED,r,{error:e.message})}_dropTransaction(t){this.txStateManager.setTxStatusDropped(t);const e=this.txStateManager.getTransaction(t);this._trackTransactionMetricsEvent(e,g.TRANSACTION_EVENTS.FINALIZED,undefined,{dropped:!0})}}r.default=N}}},{package:"$root$"}]],[],{});